function filter(){this.AllText=[];this.Props={};this.EntIDs=[];this.Parents=[];this.Langs=[];this.Domains=[];this.Orders={};this.Perms=true;this.Full=true;this.FldsOr=false;this.Depth=null;this.CheckVirtual=true;this.Page=null;this.Limit=null;this.hTypes=[];this.oTypes=[];this.setAllTextSearch=function(b){if(b instanceof Array){if(this.AllText.length){this.AllText.splice(this.AllText.length,b.length,b)}else{this.AllText=b}}else{this.AllText.push(b)}};this.setHTypes=function(b){if(b instanceof Array){this.hTypes=b}else{this.hTypes.push(b)}};this.setPropertyEqual=function(c,b){if(this.Props[c]==undefined){this.Props[c]={}}this.Props[c]["eq"]=b};this.setPropertyNotEqual=function(c,b){if(this.Props[c]==undefined){this.Props[c]={}}this.Props[c]["ne"]=b};this.setPropertyLike=function(c,b){if(this.Props[c]==undefined){this.Props[c]={}}this.Props[c]["like"]=b};this.setPropertyLess=function(c,b){if(this.Props[c]==undefined){this.Props[c]={}}this.Props[c]["lt"]=b};this.setPropertyGreater=function(c,b){if(this.Props[c]==undefined){this.Props[c]={}}this.Props[c]["gt"]=b};this.setPropertyBetween=function(d,c,b){if(this.Props[d]==undefined){this.Props[d]={}}this.Props[d]["gt"]=c;this.Props[d]["lt"]=b};this.removeProperty=function(b){this.Props[b]=undefined};this.addOrder=function(d,c){var b=true;if(c!=undefined&&(c===false||c.toUpperCase()=="DESC"||c.toUpperCase()=="BACKWARD")){b=false}this.Orders[d]=b};this.setOrder=function(d,c){var b=true;if(c!=undefined&&(c===false||c.toUpperCase()=="DESC"||c.toUpperCase()=="BACKWARD")){b=false}this.Orders={};this.Orders[d]=b};this.setPermissions=function(b){if(b==undefined){this.Perms=true}else{this.Perms=b?true:false}};this.setParentElements=function(b){if(b instanceof Array){this.Parents=b}else{this.Parents.push(b)}};this.setDepth=function(b){if(typeof(b)!=="undefined"){this.Depth=parseInt(b)}};this.setEntityIDs=function(b){if(b instanceof Array){this.EntIDs=b}else{this.EntIDs.push(b)}};this.setDomain=function(b){if(b instanceof Array){this.Domains=b}else{this.Domains.push(b)}};this.setLang=function(b){if(b instanceof Array){this.Langs=b}else{this.Langs.push(b)}};this.setHtypes=function(b){if(b instanceof Array){this.hTypes=b}else{this.hTypes.push(b)}};this.setOtypes=function(b){if(b instanceof Array){this.oTypes=b}else{this.oTypes.push(b)}};this.setVirtualCopyChecking=function(b){if(typeof(b)=="undefined"){this.CheckVirtual=true}else{this.CheckVirtual=b?true:false}};this.setViewMode=function(b){if(typeof(b)=="undefined"){this.Full=true}else{this.Full=b?true:false}};this.setConditionModeOr=function(b){if(typeof(b)=="undefined"){this.FldsOr=true}else{this.FldsOr=b?true:false}};this.getParents=function(){return this.Parents};this.setPage=function(b){this.Page=parseInt(b)};this.getPage=function(){return this.Page};this.setLimit=function(b){this.Limit=parseInt(b)};this.getLimit=function(){return this.Limit};this.getQueryString=function(b){var f=[];var e=0;if(b instanceof Object){var g={};for(e in b.Props){g[e]=b.Props[e]}for(e in this.Props){g[e]=this.Props[e]}for(e in g){for(var d in g[e]){if(g[e][d] instanceof Array){for(var c=0;c<g[e][d].length;c++){f.push("fields_filter["+e+"]["+d+"][]="+encodeURIComponent(g[e][d][c]))}}else{f.push("fields_filter["+e+"]["+d+"]="+encodeURIComponent(g[e][d]))}}}for(e=0;e<this.AllText.length;e++){f.push("search-all-text[]="+encodeURIComponent(this.AllText[e]))}for(e=0;e<b.AllText.length;e++){f.push("search-all-text[]="+encodeURIComponent(b.AllText[e]))}if(f.length){jQuery("#search_result").addClass("active");jQuery("#search_result").html(getLabel("js-search-result"))}else{if(!this.Parents.length&&!b.Parents.length){jQuery("#search_result").html("");jQuery("#search_result").removeClass("active")}}for(e=0;e<this.EntIDs.length;e++){f.push("id[]="+this.EntIDs[e])}for(e=0;e<b.EntIDs.length;e++){f.push("id[]="+b.EntIDs[e])}for(e=0;e<this.Parents.length;e++){f.push("rel[]="+this.Parents[e])}for(e=0;e<b.Parents.length;e++){f.push("rel[]="+b.Parents[e])}for(e=0;e<this.hTypes.length;e++){f.push("hierarchy_types[]="+this.hTypes[e])}for(e=0;e<this.Domains.length;e++){f.push("domain_id[]="+this.Domains[e])}for(e=0;e<b.Domains.length;e++){f.push("domain_id[]="+b.Domains[e])}for(e=0;e<this.Langs.length;e++){f.push("lang_id[]="+this.Langs[e])}for(e=0;e<b.Langs.length;e++){f.push("lang_id[]="+b.Langs[e])}for(e=0;e<b.oTypes.length;e++){f.push("object_type[]="+b.oTypes[e])}g={};for(e in b.Orders){g[e]=b.Orders[e]}for(e in this.Orders){g[e]=this.Orders[e]}for(e in g){f.push("order_filter["+e+"]="+(g[e]?"asc":"desc"))}if(this.Perms!==null){if(this.Perms){f.push("permissions")}else{if(b.Perms){f.push("permissions")}}}if(this.CheckVirtual!==null){if(this.CheckVirtual){f.push("virtuals")}else{if(b.CheckVirtual){f.push("virtuals")}}}if(this.Depth!==null){f.push("depth="+this.Depth)}else{if(b.Depth!==null){f.push("depth="+b.Depth)}}if(this.Page!==null){f.push("p="+this.Page)}else{if(b.Page!==null){f.push("p="+b.Page)}}if(this.Limit!==null){f.push("per_page_limit="+this.Limit)}else{if(b.Limit!==null){f.push("per_page_limit="+b.Limit)}}if(this.FldsOr||b.FldsOd){f.push("or-mode")}if(this.Full||b.Full){f.push("viewMode=full")}}else{for(e in this.Props){for(var d in this.Props[e]){if(this.Props[e][d] instanceof Array){for(var c=0;c<this.Props[e][d].length;c++){f.push("fields_filter["+e+"]["+d+"][]="+encodeURIComponent(this.Props[e][d][c]))}}else{f.push("fields_filter["+e+"]["+d+"]="+encodeURIComponent(this.Props[e][d]))}}}for(e=0;e<this.AllText.length;e++){f.push("search-all-text[]="+encodeURIComponent(this.AllText[e]))}for(e=0;e<this.EntIDs.length;e++){f.push("id[]="+this.EntIDs[e])}for(e=0;e<this.Parents.length;e++){f.push("rel[]="+this.Parents[e])}for(e=0;e<this.Domains.length;e++){f.push("domain_id[]="+this.Domains[e])}for(e=0;e<this.Langs.length;e++){f.push("lang_id[]="+this.Langs[e])}for(e in this.Orders){f.push("order_filter["+e+"]="+(this.Orders[e]?"asc":"desc"))}if(this.Perms){f.push("permissions")}if(this.CheckVirtual){f.push("virtuals")}if(this.Depth!==null){f.push("depth="+this.Depth)}if(this.Page!==null){f.push("p="+this.Page)}if(this.Limit!==null){f.push("per_page_limit="+this.Limit)}if(this.FldsOr){f.push("or-mode")}if(this.Full){f.push("viewMode=full")}}f.push("childs");f.push("links");f.push("templates");return"?"+f.join("&")};this.clear=function(){this.AllText=[];this.Props={};this.EntIDs=[];this.Parents=[];this.Langs=[];this.Domains=[];this.Orders={};this.Perms=true;this.Depth=null;this.Page=null;this.Limit=null;this.Full=true;this.FldsOr=false;this.CheckVirtual=null};this.empty=function(){var b=0;var d=0;for(var c in this.Props){b++;if(b){break}}for(var c in this.Orders){d++;if(d){break}}return !this.AllText.length&&!this.EntIDs.length&&!this.Parents.length&&!this.Langs.length&&!this.Domains.length&&!b&&!d&&this.Perms&&this.Full&&!this.Depth&&!this.Page&&!this.FldsOr&&!this.CheckVirtual};var a=function(e){if(!e||"object"!==typeof e){return e}var f="function"===typeof e.pop?[]:{};var d,b;for(d in e){if(e.hasOwnProperty(d)){b=e[d];if(b&&"object"===typeof b){f[d]=a(b)}else{f[d]=b}}}return f};this.clone=function(){return a(this)}}var TableItem=function(G,x,y,S,P){var K=parseInt(y.id);var m=this;var V=y;var A=x;var q=S||null;var D=P||"after";var X=typeof(y["force-draw"])!=="undefined"?parseInt(y["force-draw"]):1;var h=typeof(y.childs)!=="undefined"?parseInt(y.childs):0;var Z=(y.basetype&&typeof(y.basetype["module"])==="string")?y.basetype["module"]:"content";var Q=(y.basetype&&typeof(y.basetype["method"])==="string")?y.basetype["method"]:"";var k=(y.basetype&&typeof(y.basetype["_value"])==="string")?y.basetype["_value"]:"";var w=G.iconsPath;var L=typeof(y.iconbase)!=="undefined"?y.iconbase:w+"ico_"+Z+"_"+Q+".png";var f=null;var s=null;var E=null;var u=null;var t=SettingsStore.getInstance();var R=true;var H=null;var b=false;var d=G.flatMode;var W=G.objectTypesMode;var N=null;var M=null;var I=null;var r=typeof G.hasCheckboxes=="boolean"?G.hasCheckboxes:true;this.checkBox=null;this.element=null;this.control=G;this.childsContainer=null;this.id=K;this.name=typeof(y.name)!=="undefined"?y.name:getLabel("js-smc-noname-page");this.isRoot=A?false:true;this.loaded=false;this.viewLink=typeof(y.link)!=="undefined"?y.link:false;this.editLink=typeof(y["edit-link"])!=="undefined"?y["edit-link"]:false;this.createLink=typeof(y["create-link"])!=="undefined"?y["create-link"]:false;this.permissions=typeof(y.permissions)!=="undefined"?parseInt(y.permissions):0;this.isActive=typeof(y["is-active"])!=="undefined"?parseInt(y["is-active"]):0;if(W){this.isActive=true}this.isVirtualCopy=typeof(y["has-virtual-copy"])!=="undefined";this.isOriginal=typeof(y["is-original"])!=="undefined";this.lockedBy=typeof(y["locked-by"])==="object"?y["locked-by"]:null;this.expiration=typeof(y.expiration)==="object"?y.expiration:null;this.templateId=typeof(y["template-id"])!=="undefined"?y["template-id"]:null;this.langId=typeof(y["lang-id"])!=="undefined"?y["lang-id"]:null;this.domainId=typeof(y["domain-id"])!=="undefined"?y["domain-id"]:null;this.allowCopy=typeof(y["allow-copy"])!=="undefined"?parseInt(y["allow-copy"]):true;this.allowActivity=typeof(y["allow-activity"])!=="undefined"?parseInt(y["allow-activity"]):true;this.allowDrag=typeof(y["allow-drag"])!=="undefined"?y["allow-drag"]:true;this.parent=A;this.childs=[];this.hasChilds=(h>0||K==0);this.labelControl=null;this.position=false;this.isExpanded=false;this.filter=new filter;this.filter.setParentElements(K);this.level=A?A.level+1:0;this.ignoreEmptyFilter=false;this.pageLimits=this.control.PerPageLimits;this.nextSibling=typeof y.nextSibling=="object"?y.nextSibling:null;this.row=null;this.editableFieldTypeList=["boolean","color","counter","date","domain_id","domain_id_list","file","float","img_file","int","link_to_object_type","name","price","optioned","relation","string","string","swf_file","tags","text","video_file"];this.pageing={total:0,limit:0,offset:0};this.baseModule=Z;this.baseMethod=Q;var c=function(){if(x){x.childs.push(K);if(X){U(A.childsContainer)}}else{if(X){Y()}}};var g=function(ac,ad){if(!d||m.control.contentType==="pages"){return ad}if(!m.control.enableObjectsActivity){return true}var aa=$(m.control.dataSet.getCommonFields());var ab=$('field[name = "disabled"]',aa);if(ab.length>0){return ac.getValue("disabled").length===0}return(ad||ac.getValue("is_activated")||ac.getValue("is_active")||ac.getValue("activated"))!==""};var F=function(aa,ab){var ac=document.createElement("col");ac.style.width=ab;$(aa).append(ac)};var l=function(af){var ae=$(af);var ac=z();var ag=j();ae.html("");var ad=parseInt(ac.name["params"][0]);F(ae,ad+"px");var ab;for(var aa in ac){if(!ag.hasOwnProperty(aa)){continue}ab=ac[aa]["params"][0];F(ae,ab)}F(ae,"100%")};var U=function(ay){m.isActive=g(m,m.isActive);var aa=z();var au=j();var am=document.createElement("tr");am.setAttribute("rel",K);am.className="table-row tollbar level-"+m.level;am.rel=K;m.row=am;s=am;m.labelControl=s;var aj=aa.name;var aK=document.createElement("td");aK.classList.add("table-cell");aK.id="c_"+m.control.id+"_"+K+"_name";aK.width=parseInt(aj.params[0]);aK.name="name";if(editableCell.enableEdit!==false){var at=document.createElement("i");at.className="small-ico i-change editable";at.title=getLabel("js-table-control-fast-edit");at.id="e_"+m.control.id+"_"+m.id+"_name";aK.appendChild(at)}var aE=document.createElement("div");aE.style.owerflow="hidden";aK.appendChild(aE);var ax=null;if(!W){ax=new editableCell(m,aK,aj,at)}if(ax instanceof editableCell&&!ax.isActive){$(at).detach()}f=document.createElement("span");f.className="catalog-toggle";var aG=document.createElement("span");aG.classList.add("catalog-toggle-wrapper");aG.onclick=function(){m.toggle(this);return false};if(m.hasChilds){aG.appendChild(f)}else{aG.className="catalog-toggle-off"}if(!m.control.flatMode){aE.appendChild(aG)}var az=document.createElement("div");az.classList.add("checkbox");var aD=document.createElement("input");aD.setAttribute("type","checkbox");aD.value=K;aD.classList.add("row_selector");az.appendChild(aD);var ad=jQuery(am);ad.bind("mousedown",function(aO){m.control.handleMouseDown(aO,K)});ad.bind("mouseup",function(aO){m.control.handleMouseUp(aO,m)});if(r){m.checkBox=az;aE.appendChild(az)}u=document.createElement("img");u.style.border="0px";u.setAttribute("alt",k);u.setAttribute("title",k);u.setAttribute("src",L);u.className="ti-icon";u.onmousedown=function(){return false};if(m.control.allowDrag&&m.allowDrag){u.style.cursor="move"}if(!m.control.flatMode&&!m.control.objectTypesMode){aE.appendChild(u)}else{u=null}if(m.expiration){var ar=m.expiration.status;if(ar){var ah=ar.id;var ai=ar._value;if(ah){var aL=document.createElement("img");var aq=w+"ico_"+ah+".png";aL.setAttribute("src",aq);aL.setAttribute("alt",ai);aL.setAttribute("title",ai);aL.className="page-status";aE.appendChild(aL)}}}E=document.createElement("a");var aN=m.getValue("name");var aw=String((typeof(aN)==="string"&&aN.length)?aN:"");if(!aw.length){aw=getLabel("js-smc-noname-page")}aE.title=(m.viewLink)?m.viewLink:aw.replace(/<[^>]+>/g,"");E.className="name_col";E.href=m.editLink;E.innerHTML=aw;if(!m.editLink){E.className="name_col unactive"}$(E).bind("mousedown click mouseup",function(aP){var aO=1;if(aP.button!==aO){aP.preventDefault()}return true});aE.appendChild(E);if(typeof m.editLink==="string"){var ac=document.createElement("a");ac.classList.add("small-ico");ac.classList.add("i-edit");ac.classList.add("stucktotext");ac.classList.add("editable");ac.setAttribute("href",m.editLink);ac.setAttribute("title",getLabel("js-goto-edit-page"));aE.appendChild(ac)}if(m.isVirtualCopy){var ag=document.createElement("span");ag.className="label-virtual";ag.innerHTML=(m.isOriginal)?getLabel("js-smc-original"):getLabel("js-smc-virtual-copy");aE.appendChild(ag)}if(!m.isActive&&!m.control.objectTypesMode){am.classList.add("disabled")}am.appendChild(aK);var ak=2;for(var al in aa){var aI=au[al];var ab=aa[al]["params"];if(ab[1]==="static"){aI=aa[al]}if(!aI){continue}ak++;var af=document.createElement("td");af.id="c_"+m.control.id+"_"+K+"_"+al;af.className="table-cell";af.style.width=ab[0];af.style.maxWidth=ab[0];af.name=al;aw=m.getValue(al);var ap=document.createElement("div");ap.style.cursor="text";ap.style.width="100%";ap.classList.add("cell-item");ap.innerHTML=aw;ax=null;if(m.editableFieldTypeList.indexOf(aI.dataType)!==-1&&editableCell.enableEdit!==false){var aH=document.createElement("i");aH.className="small-ico i-change editable";aH.title=getLabel("js-table-control-fast-edit");aH.id="e_"+m.control.id+"_"+m.id+"_"+al;af.appendChild(aH);ax=new editableCell(m,af,aI,aH)}af.appendChild(ap);if(ax instanceof editableCell&&!ax.isActive){$(aH).detach()}if(al==="is_activated"||al==="active"||al==="is_active"){I=af}am.appendChild(af)}var ao=document.createElement("td");ao.className="table-cell";ao.style.width="100%";am.appendChild(ao);if(q){var aF=null;if(D.toLowerCase()==="after"){aF=q.element.nextSibling}else{aF=q.element}if(aF){m.element=ay.insertBefore(am,aF)}else{m.element=ay.appendChild(am)}}else{m.element=ay.appendChild(am)}if(m.control.dragAllowed&&m.allowDrag){var an="child";var aM;var aA=false;jQuery(s).draggable({appendTo:"body",distance:Control.DragSensitivity,handle:".ti-icon, a",cursorAt:{right:-2},helper:function(){var aO=document.createElement("div");if(m.control.contentType==="objects"){aO.innerHTML="<div>"+m.name+"</div>";aO.className="ti-draggable";jQuery(aO).css({position:"absolute",background:"url("+L+") no-repeat 0 4px","padding-left":"20px"})}else{m.setSelected(true);m.control.selectedList[m.id]=m;for(key in m.control.selectedList){aO.innerHTML+="<div>"+m.control.selectedList[key].name+"</div>"}aO.className="ti-draggable";jQuery(aO).css({position:"absolute","padding-left":"20px"})}return aO},start:function(){Control.DraggableItem=m;Control.DragMode=true;if(m.control.toolbar){m.control.toolbar.hide()}},stop:function(){if(Control.HandleItem){Control.HandleItem.deInitDroppable();if(Control.DraggableItem){Control.DraggableItem.tryMoveTo(Control.HandleItem,an)}}Control.DraggableItem=null;Control.DragMode=false;jQuery(".pages-bar a").off("mouseover");aA=false;window.clearTimeout(aM)},drag:function(aO){var aS=jQuery(".pages-bar a");aS.on("mouseover",function(){if(!aA){aA=true;var aX=this;aM=window.setTimeout(function(){aX.click()},1000)}});aS.on("mouseout",function(){if(aA){aA=false;window.clearTimeout(aM)}});var aV=aO.pageX;var aU=aO.pageY;var aQ=Control.detectItemByMousePointer(aV,aU);var aR=Control.HandleItem;if(aR){aR.deInitDroppable()}Control.HandleItem=aQ;if(aQ){var aW=jQuery(aQ.control.initContainer).position();var aT=aQ.position.bottom-aQ.position.top;var aP=aU-aW.top-aQ.position.top-310;if(aP<aT/3){an="before"}if(aP>aT/3&&aP<2*aT/3){an="child"}if(aP>2*aT/3){an="after"}if(aQ.isRoot){an="child"}aQ.initDroppable(an)}}})}var ae=document.createElement("tr");var aC=document.createElement("td");if(!d){ak++}aC.colSpan=ak;ae.appendChild(aC);var aJ=document.createElement("table");aJ.classList.add("table");aJ.style.tableLayout="fixed";var aB=document.createElement("colgroup");l(aB);aJ.appendChild(aB);var av=document.createElement("tr");av.classList.add("table-row");av.classList.add("level-"+m.level);av.style.display="none";N=document.createElement("td");N.classList.add("pages-bar");N.classList.add("table-cell");N.id="pb_"+m.control.id+"_"+m.id;N.colSpan=ak;av.appendChild(N);aC.appendChild(aJ);aJ.appendChild(av);m.childsContainer=aJ;switch(true){case !am.nextSibling:ay.appendChild(ae);break;case P==="before":am.parentNode.insertBefore(ae,am.nextSibling);break;case P==="after":am.parentNode.insertBefore(ae,am);break}};this.tryMoveTo=function(ad,ae){if(ad){var ag=this.control.getRootNodeId();var ai=ad.id;var ah=1;var ac="";if(this.control.contentType=="pages"){ah=ae!=="child"?1:0}if(ae=="before"){if(this.control.contentType=="pages"){ag=ad.id;ai=ad.parent.id;ac=ai}else{ag=ad.id;ai=ad.id}}if(ae=="after"){if(this.control.contentType=="pages"){var aj=ad.getNextSibling();ai=ad.parent.id;ag=aj?aj.id:this.control.getRootNodeId();ac=ad.id}else{ai=ad.id;ac=ad.id}}if(this.control.contentType=="objects"){ac=ai}if(ad===this){return false}if(ad.checkIsChild(this)){return false}if(ag==this.id){return false}var ab=ad;if(ah==1&&this.control.contentType=="pages"){ab=ad.parent?ad.parent:ad.control.getRoot()}var af=[];var aa=0;for(i in this.control.selectedList){af[aa++]=i}this.control.dataSet.execute("move",{element:this.id,before:ag,after:ac,rel:ai,"as-sibling":ah,domain:ad.control.getRoot().name,childs:1,links:1,virtuals:1,permissions:1,templates:1,receiver_item:ab,handle_item:this,viewMode:"full",moveMode:ae,selected_list:af})}};this.initDroppable=function(ac){var ac=ac||"child";var aa=Control.DraggableItem;var ae=jQuery(this.control.initContainer).offset();if(aa){if(aa===this){return false}if(this.checkIsChild(aa)){return false}var ab=Control.dropIndicator;if(oTable){var ad=jQuery(oTable.container).width();if(ad<this.position.right){this.position.right=ad}}if(ac=="after"){ab.style.top=this.position.bottom+ae.top+"px";ab.style.left=this.position.left+ae.left+"px";ab.style.width=this.position.right-this.position.left}if(ac=="before"){ab.style.top=this.position.top+ae.top+ab.offsetHeight+"px";ab.style.left=this.position.left+ae.left+"px";ab.style.width=this.position.right-this.position.left+"px"}if(ac=="child"){ab.style.top=this.position.bottom+ae.top+"px";ab.style.left=this.position.left+ae.left+20+"px";ab.style.width=this.position.right+ae.left-20-this.position.left+"px"}ab.style.display="";setTimeout(J,3239)}};this.deInitDroppable=function(){if(!Control.dropIndicator){return}Control.dropIndicator.style.display="none"};var z=function(){if(m.control.usedColumns){return m.control.usedColumns}var aa={};var ah=t.get(m.control.id,"used-columns");if(ah===false){ah=m.control.visiblePropsMenu;if(ah.length==0){ah=m.control.dataSet.getDefaultFields()}if(!ah){ah=""}}if(ah.length){var ae=ah.split("|");for(var ad=0;ad<ae.length;ad++){var ab=ae[ad];var af=ae[ad];var ai=[];var ac=ab.indexOf("[");if(ac){af=ab.substring(0,ac);ai=ab.substring(ac+1,ab.length-1).split(",")}aa[af]={name:af,params:ai}}}if(!aa.name){aa.name={name:"name",params:["250px"]}}var ag=m.control.sequencePropsMenu;aa=B(aa,ag);m.control.usedColumns=aa;return aa};var B=function(ab,ad){var ae,aa={},ac=0;for(ae in ab){if(!ab.hasOwnProperty(ad[ac])){delete ad[ac];ad.splice(ac)}if(ab.hasOwnProperty(ae)){if(ad.indexOf(ae)===-1){ad.push(ae)}aa[ad[ac]]=ab[ad[ac]]||"";ac++}}return aa};var n=function(){var ab=z();var ac=[];for(name in ab){var aa=ab[name];if(!aa){continue}ac[ac.length]=name+"["+aa.params.join(",")+"]"}t.set(m.control.id,ac.join("|"),"used-columns")};var v=function(){var aa=p();return Object.keys(aa).length>0};var p=function(){if(m.control.columnsMenu){return m.control.columnsMenu}var aa={};$.each(j(),function(ab,ac){if($.inArray(ac.fieldName,m.control.requiredPropsMenu)===-1){aa[ab]=ac}});m.control.columnsMenu=aa;return aa};var a=function(aa){m.control.columnsMenu=aa};var j=function(){if(m.control.columnsTable){return m.control.columnsTable}var ah=m.control.dataSet.getCommonFields();var ac=z();var ag=1;var aq={};for(var af=0;af<ah.length;af++){ag++;var ad=ah[af].getElementsByTagName("field");var ak=false;for(var ae=0;ae<ad.length;ae++){var ao=ad[ae];var aa=ao.getAttribute("name");var al=ao.getElementsByTagName("type")[0];var an=al.getAttribute("data-type");if(ab(aa,an)){continue}var aj=(aa in ac);var am=ao.getAttribute("title");var ai=ao.getAttribute("id");var ap=ao.getAttribute("guide-id");aq[aa]={caption:am,icon:aj?"checked":"undefined",id:ai,title:am,fieldName:aa,dataType:an,guideId:ap,checked:aj,execute:function(ar){ar.checked?m.removeColumn(ar.fieldName):m.appendColumn(ar.fieldName);Control.recalcItemsPosition()}};ag++;if(af<ad.length-1){ak=true}}if(ak){aq[ag+"-sep"]="-"}}m.control.columnsTable=aq;return aq;function ab(au,ar){if($.inArray(ar,m.editableFieldTypeList)===-1){return true}var at=m.control.dataSet.getFieldsStoplist();for(var av=0;av<at.length;av++){if(at[av]==au){return true}}return false}};this.resizeColumn=function(ah,ad){var ab=z();var ag=ab[ah];if(!ag){return false}for(var aa=0;aa<m.childs.length;aa++){var af=m.control.items[m.childs[aa]];if(af){af.resizeColumn(ah,ad)}}if(m.isRoot){var ae=document.getElementById("h_"+m.control.id+"_"+ah);if(!ae){return false}ae.style.width=ad+"px";ae.style.maxWidth=ad+"px";ab[ah].params[0]=ad+"px";m.control.usedColumns=ab;n()}else{var ae=document.getElementById("c_"+m.control.id+"_"+m.id+"_"+ah);if(!ae){return false}ae.style.width=ad+"px";ae.style.maxWidth=ad+"px"}var ac=$("colgroup",m.control.initContainer);l(ac);return true};this.startResizeColumn=function(ah,af){var ab=$(document.createElement("div"));var ae=$(this.control.initContainer);var ac=ae.offset();ab.addClass("resizer");ab.css({top:ac.top,left:af.clientX,height:ae.outerHeight()+"px"});var aa=function(){try{document.body.style["-moz-user-select"]="none";document.body.style["-khtml-user-select"]="none";document.body.onselectstart=function(){return false};document.selection.empty()}catch(ai){}};var ad=function(ai){aa();ab.css("left",ai.clientX)};var ag=function(){$(document).unbind("mouseup");$(document).unbind("mousemove");var aj=$("#h_"+m.control.id+"_"+ah);var ak=ab.position().left-aj.offset().left;ak=Math.min(ak,TableItem.maxColumnWidth);ak=Math.max(ak,TableItem.minColumnWidth);var ai=aj.outerWidth();if(ak!==ai){m.resizeColumn(ah,ak);Control.recalcItemsPosition()}ab.detach()};$(document).bind("mouseup",ag);$(document).bind("mousemove",ad);$("body").append(ab)};this.appendColumn=function(ap){var ac=z();var am=p();var ah=am[ap];if(!ah||ac[ap]){return false}for(var ai=0;ai<m.childs.length;ai++){var ab=m.control.items[m.childs[ai]];if(ab){ab.appendColumn(ap)}}if(m.isRoot){var ae=document.createElement("th");ae.className="table-cell";ae.setAttribute("id","h_"+m.control.id+"_"+ap);ae.setAttribute("name",name);ae.name=ap;ae.style.width="200px";var ao=document.createElement("span");ao.onmousedown=function(aq){if(!aq){aq=window.event}m.startResizeColumn(ap,aq)};ae.appendChild(ao);var aj=document.createElement("div");aj.classList.add("table-title");aj.title=ah.title;aj.innerHTML=ah.title;ae.appendChild(aj);m.element.insertBefore(ae,m.element.lastChild);ac[ap]={name:ap,params:["200px"]};m.control.usedColumns=ac;am[ap].checked=true;am[ap].icon="checked";a(am);var ag=document.createElement("div");ag.setAttribute("id","f_"+m.control.id+"_"+ap);ag.style.width="100%";m.control.onDrawFieldFilter(am[ap],ag,ac[ap].params);ae.appendChild(ag);var aa=document.getElementById("pb_"+m.control.id+"_"+m.id);if(aa){aa.colSpan+=1}n();e()}else{var ae=document.createElement("td");ae.id="c_"+m.control.id+"_"+m.id+"_"+ap;ae.style.width="280px";ae.style.maxWidth="200px";ae.className="table-cell";ae.name=ap;if(document.getElementById(ae.id)){return true}var ad=m.getValue(ap);m.element.insertBefore(ae,m.element.lastChild);m.childsContainer.parentNode.colSpan+=1;var ak=document.createElement("i");ak.className="small-ico i-change editable";ak.title=getLabel("js-table-control-fast-edit");ak.id="e_"+m.control.id+"_"+m.id+"_"+ap;ae.appendChild(ak);var af=document.createElement("div");af.style.cursor="text";af.style.width="100%";af.classList.add("cell-item");af.innerHTML=ad;ae.appendChild(af);var an=new editableCell(m,ae,ah,ak);if(an instanceof editableCell&&!an.isActive){$(ak).detach()}}var al=$("colgroup",m.control.initContainer);l(al);return true};this.removeColumn=function(ak){var ae=z();var aj=p();var af=aj[ak];if(!af||!ae[ak]){return false}for(var ah=0;ah<m.childs.length;ah++){var ab=m.control.items[m.childs[ah]];if(ab){ab.removeColumn(ak)}}if(m.isRoot){var ad=document.getElementById("h_"+m.control.id+"_"+ak);if(!ad){return false}ad.parentNode.removeChild(ad);var ag=document.getElementById("f_"+m.control.id+"_"+ak);if(ag){ag.parentNode.removeChild(ag)}var ai={};for(var ac in ae){if(ac==ak){continue}ai[ac]=ae[ac]}m.control.usedColumns=ai;aj[ak].checked=false;aj[ak].icon="undefined";a(aj);m.control.onRemoveColumn(af);m.childsContainer.parentNode.parentNode.colSpan-=1;var aa=document.getElementById("pb_"+m.control.id+"_"+m.id);if(aa){aa.colSpan-=1}n();e()}else{var ad=document.getElementById("c_"+m.control.id+"_"+m.id+"_"+ak);if(!ad){return false}ad.parentNode.removeChild(ad);m.childsContainer.parentNode.parentNode.colSpan-=1}l($("colgroup",m.control.initContainer));return true};this.exportCallback=function(aa){aa=(typeof aa==="number")?aa:null;var ab=function(ad,af,ag){closeDialog(ag);var ae=m.getExportLink(ad,af);window.location=ae+"&download=1"};var ac=function(ad,af,ag,ah){var ae=m.getExportLink(ad,af);$.ajax({url:ae,dataType:"json",method:"get"}).done(function(ai){if(typeof ai.is_complete==="boolean"){if(ai.is_complete===true){return ah()}return ac(ad,af,ag,ah)}T(ag,"Unknown")}).fail(function(ai,aj){T(ag,aj)})};$.get("/styles/skins/modern/design/js/smc/html/quickExportDialog.html",function(ad){ad=ad.replace(/{{label:(.+)}}/gi,function(af,ae){return getLabel(ae)});openDialog("",getLabel("js-csv-export"),{confirmText:getLabel("js-csv-export-button"),html:ad,confirmCallback:function(ae){var af=$("#popupLayer_"+ae);o(aa,function(ag){$("#quick_csv_encoding",af).hide();$("div.eip_buttons",af).hide();$("div.exchange_container",af).show();ac(aa,ag,ae,function(){ab(aa,ag,ae)})})},openCallback:function(){initSelectizer()}})})};this.importCallback=function(ac){ac=(typeof ac==="number")?ac:null;var ab=function(ae,ag,ah,ak){var af=m.getImportLink(ae,ag);var aj=$("#popupLayer_"+ah);var ad=$("#import-csv-form",aj);var ai=new FormData;ai.append("csv-file",$('input[name = "csv-file"]',ad).prop("files")[0]);ai.append("csrf",csrfProtection.getToken());ai.append("upload",1);$.ajax({url:af,dataType:"json",method:"post",processData:false,contentType:false,data:ai}).done(function(al){if(typeof al.error==="string"){return T(ah,al.error)}if(typeof al.file==="string"){return ak(al.file,af,ah)}T(ah,"Unknown")}).fail(function(al,am){T(ah,am)})};var aa=function(ad,ae,af){var ag=new FormData;ag.append("file",ad);ag.append("csrf",csrfProtection.getToken());$.ajax({url:ae,dataType:"json",method:"post",processData:false,contentType:false,data:ag}).done(function(ah){if(typeof ah.error==="string"){return T(af,ah.error)}if(typeof ah.is_complete==="boolean"){if(ah.is_complete===true){return window.location.reload()}return aa(ad,ae,af)}T(af,"Unknown")}).fail(function(ah,ai){T(af,ai)})};$.get("/styles/skins/modern/design/js/smc/html/quickImportDialog.html",function(ad){ad=ad.replace(/{{label:(.+)}}/gi,function(af,ae){return getLabel(ae)});openDialog("",getLabel("js-csv-import"),{confirmText:getLabel("js-csv-import-button"),html:ad,confirmCallback:function(ae){var af=$("#popupLayer_"+ae);o(ac,function(ag){$("#import-csv-form",af).hide();$("div.eip_buttons",af).hide();$("div.exchange_container",af).show();ab(ac,ag,ae,aa)})},openCallback:function(){initSelectizer()}})})};var o=function(ab,ad){var aa=document.querySelector("select[name=encoding]");var ac=null;if(aa&&typeof aa.selectedIndex==="number"){ac=aa.item(aa.selectedIndex).text}ad(ac)};var T=function(ab,aa){closeDialog(ab);$.jGrowl(aa,{header:getLabel("js-error-header")})};var e=function(){var ab=z();var af=j();var ac=0;for(var aa in ab){var ad=af[aa];var ae=ab[aa]["params"];if(ae[1]=="static"){ad=ab[aa];ad.title=getLabel("js-smc-"+aa)}if(!ad){continue}ac++}if(M){M.style.display=(ac>0)?"":"none"}};var O=function(aa){return function(ab){if(!ab){ab=window.event}m.startResizeColumn(aa,ab);return true}};var Y=function(){aj();var ac=z();var ar=j();var ak=0;var aa=document.createElement("tr");aa.setAttribute("name",m.control.id);aa.className="table-row title";var ab=ac.name,ae=document.createElement("th");ae.className="table-cell";ae.id="h_"+m.control.id+"_name";ae.setAttribute("name","name");ae.name=av;ae.width=parseInt(ab.params[0]);var ap=document.createElement("div");ap.classList.add("table-title");ap.classList.add("disabled");var an=getLabel("js-smc-name-column");if(m.control.labelFirstColumn.length>0){an=m.control.labelFirstColumn}ap.innerHTML=an;ap.title=an;var am=document.createElement("span");am.onmousedown=O("name");ae.appendChild(am);ae.appendChild(ap);if(m.control.enableEdit){var ai=document.createElement("div");ai.className="input-search";ai.id="f_"+m.control.id+"_name";m.control.onDrawFieldFilter("name",ai,ab.params);ae.appendChild(ai)}aa.appendChild(ae);var ah=2;for(var av in ac){var ad=ar[av];var at=ac[av]["params"];if(at[1]=="static"){ad=ac[av];ad.title=getLabel("js-smc-"+av)}if(!ad){continue}ah++;var af=document.createElement("th");af.classList.add("table-cell");af.id="h_"+m.control.id+"_"+av;af.setAttribute("name",av);af.style.width=at[0];ap=document.createElement("div");ap.classList.add("table-title");ap.classList.add("disabled");ap.title=ad.title;ap.innerHTML=ad.title;af.appendChild(ap);var am=document.createElement("span");am.onmousedown=O(av);af.appendChild(am);var ag=document.createElement("div");ag.id="f_"+m.control.id+"_"+av;ag.style.width="100%";m.control.onDrawFieldFilter(ad,ag,at);af.appendChild(ag);aa.appendChild(af);++ak}var al=document.createElement("th");al.classList.add("table-cell");al.classList.add("plus");al.style.width="100%";al.style.textAlign="left";al.style.verticalAlign="middle";if(!m.control.objectTypesMode&&v()){var ao=document.createElement("i");ao.classList.add("small-ico");ao.classList.add("i-add");ao.classList.add("pointer");jQuery(ao).bind("click",function(aw){jQuery.cmenu.lockHiding=true;jQuery.cmenu.show(jQuery.cmenu.getMenu(p()),m.control.initContainer.offsetParent,aw)});jQuery(ao).bind("mouseout",function(){jQuery.cmenu.lockHiding=false});al.oncontextmenu=function(){return false};al.appendChild(ao)}aa.appendChild(al);jQuery(aa).bind("click",function(ax){var aw=ax.target;if(aw!==al){TableItem.orderByColumn(aw.parentNode.getAttribute("name"),m.control,aw)}});e();var au=document.createElement("tBody");au.classList.add("level-"+m.level);au.style.display="none";var aq=document.createElement("tr");aq.style.display="none";aq.classList.add("table-row");N=document.createElement("td");N.classList.add("pages-bar");N.classList.add("table-cell");N.id="pb_"+m.control.id+"_"+m.id;if(!d){ah++}N.colSpan=ah;aq.appendChild(N);au.appendChild(aq);m.element=m.control.container.appendChild(aa);m.childsContainer=m.control.container.appendChild(au);m.control.initContainer=m.control.container;m.control.container=m.childsContainer;if(d&&!W){m.showCsvButtons(m.exportCallback,m.importCallback)}m.expand();function aj(){if(!Control.dropIndicator){var aw=document.createElement("div");aw.className="ti-drop";Control.dropIndicator=document.body.appendChild(aw)}}};this.showCsvButtons=function(ah,ac){if(this.control.disableCSVButtons){return}m.hideCsvButtons();var af=document.createElement("div");af.id="csv-buttons";var ab=document.createElement("a");var ad=document.createElement("i");ad.className="small-ico i-csv-export";ab.appendChild(ad);ab.appendChild(document.createTextNode(getLabel("js-csv-export")));ab.href="#";ab.className="csvLink csvExport btn-action";ab.onclick=ah;af.appendChild(ab);if(!this.control.hideCsvImportButton){var aa=document.createElement("a");var ae=document.createElement("i");ae.className="small-ico i-csv-import";aa.appendChild(ae);aa.appendChild(document.createTextNode(getLabel("js-csv-import")));aa.href="#";aa.className="csvLink csvImport btn-action";aa.onclick=ac;af.appendChild(aa)}var ag=document.getElementById("csv-buttons-zone");ag.appendChild(af);m.csvButtons=af};this.hideCsvButtons=function(){if(m.csvButtons){jQuery(m.csvButtons).remove();m.csvButtons=false}jQuery("#csv-buttons-zone").html("")};this.getExportLink=function(ag,ab){var ac=z();var al=this.control.getCurrentFilter().getQueryString();var am=document.location.pathname;try{var aj=m.control.dataSet.getPathModuleMethod()}catch(ae){}if(am!==aj&&am.indexOf(aj)===0){var ah=am.substring(aj.length);var ak=new RegExp("/([/0-9]*)/");am=(ak.test(ah))?am:aj}else{am=aj}var ai=am+al+"&xmlMode=force&export=csv";for(var af in ac){var ad=ac[af]["name"];if(ad!=="name"){ai+="&used-fields[]="+ad}}if(ag){ai+="&rel[]="+ag}var aa=this.control.dataSet.getDefaultFilter();if(aa.Langs[0]){ai+="&lang_id[]="+aa.Langs[0]}if(aa.Domains[0]){ai+="&domain_id[]="+aa.Domains[0]}if(typeof ab==="string"&&ab.length>0){ai+="&encoding="+ab}return ai};this.getImportLink=function(aa,ad){var ab=this.control.getCurrentFilter().getQueryString();var ac=document.location.pathname;ac+=ab+"&xmlMode=force&import=csv";if(aa){ac+="&rel[]="+aa}if(typeof ad==="string"&&ad.length>0){ac+="&encoding="+ad}return ac};var J=function(){if(R&&m===Control.HandleItem){m.expand()}};this.draw=function(){if(x){if(!X){U(A.childsContainer)}}else{if(!X){Y()}}};this.appendChild=function(aa){return new TableItem(this.control,m,aa)};this.appendAfter=function(aa,ab){return new TableItem(this.control,m,aa,ab,"after")};this.appendBefore=function(aa,ab){return new TableItem(this.control,m,aa,ab,"before")};this.appendFirst=function(aa){if(this.childsContainer.childNodes.length==2){return this.appendChild(aa)}else{if(typeof(this.childsContainer.childNodes[2].rel)!="undefined"){return this.appendBefore(aa,this.control.getItem(this.childsContainer.childNodes[1].rel))}else{return false}}};this.getPreviousSibling=function(){var aa=this.element.previousSibling;if(aa&&aa.rel){return this.control.getItem(aa.rel)}return null};this.getNextSibling=function(){var aa=this.element.nextSibling;if(aa&&aa.rel){return this.control.getItem(aa.rel)}return null};this.clear=function(){if(this.isRoot){var aa=this.element.parentNode;while(aa.firstChild){aa.removeChild(aa.firstChild)}}else{if(this.element.parentNode){this.element.parentNode.removeChild(this.element.nextSibling);this.element.parentNode.removeChild(this.element)}}};this.checkIsChild=function(ab){var aa=this.parent;while(aa){if(ab===aa){return true}aa=aa.parent}return false};this.recalcPosition=function(){if(m.isRoot){return false}try{var ab=this.parent;while(ab){if(!ab.isExpanded){this.position=false;return false}ab=ab.parent}var aa=this.control.getRoot().childsContainer;var ad=jQuery(s).position();this.position={left:ad.left,top:ad.top,right:ad.left+aa.offsetWidth,bottom:ad.top+jQuery(s).height()};return this.position}catch(ac){this.position=false;return false}};this.setLoaded=function(aa){this.loaded=aa;if(f){f.setAttribute("src",w+"collapse.png")}};var C=function(af){if(!af||!af.type){return""}var ab=function(ak){return af.value._value||af.value||ak||""};switch(af.type){case"int":case"float":case"price":case"link_to_object_type":case"counter":return ab(0);case"tags":case"string":return ag();case"color":return ad();case"domain_id":return aj();case"domain_id_list":return ae();case"text":return ab();case"boolean":return ac();case"img_file":return ai();case"video_file":case"swf_file":case"file":return aa();case"relation":return ah();case"date":return af.value["formatted-date"];case"optioned":return getLabel("js-optioned-value-hidden");default:return""}function ag(){var ak=ab();if(af.restriction=="email"){return'<a href="mailto:'+ak+'" title="'+ak+'" class="link">'+ak+"</a>"}if(typeof ak==="object"&&Object.prototype.toString.call(ak)==="[object Array]"){ak=ak.join(", ")}if(/https?:\/\//.test(ak)){ak='<a href="'+ak+'" title="'+ak+'" class="link">'+ak+"</a>"}else{ak='<span title="'+ak+'">'+ak+"</span>"}return ak}function ad(){var ak=af.value?af.value:"";if(ak){ak='<div class="color table"><span class="value">'+ak+'</span><span class="color-box"><i style="background-color: '+ak+'"></i></span></div>'}return ak}function aj(){var ak=ab();if(typeof ak==="object"&&typeof ak.domain==="object"){ak=ak.domain.host||""}return ak}function ae(){var an=ab();if(typeof an!=="object"){return an}if(!an.domain[0]){return an.domain.host||""}var ak=[];for(var al=0;al<an.domain.length;al++){var am=an.domain[al].host||"";if(!am){continue}ak.push(am)}return ak.join(", ")}function ac(){if(ab()){return'<img alt="" style="width:13px;height:13px;" src="/images/cms/admin/mac/tree/checked.png" />'}return""}function ai(){var an=af.value;if(!an){return""}var ap=an._value;var ao=ap.substring(0,ap.lastIndexOf("."));var ak="";if(typeof ap=="string"){tmp=ap.split(/\//);ak=tmp[tmp.length-1]}if(an.is_broken=="1"){an='<span title="404" style="color:red;font-weight: bold;cursor: pointer;">?</span>';an+='&nbsp;&nbsp;<span style="text-decoration: line-through;" title="'+ap+'">'+ak+"</span>"}else{var am=an.ext;var al="/autothumbs.php?img="+ao+"_sl_180_120."+am;an='<img alt="" style="width:13px;height:13px;cursor: pointer;" src="/images/cms/image.png" onmouseover="TableItem.showPreviewImage(event, \''+al+"')\" />";an+='&nbsp;&nbsp;<span title="'+ap+'">'+ak+"</span>"}return an}function aa(){var ak=af.value;if(!ak){return""}src=ak._value;if(ak.is_broken=="1"){ak=src?('<span style="text-decoration: line-through;" title="'+src+'">'+src+"</span>"):""}else{ak=src?('<span title="'+src+'">'+src+"</span>"):""}return ak}function ah(){var am=ab();if(!am){return""}var an="";if(am.item[0]){for(var al=0;al<am.item.length;al++){an+=am.item[al].name;if(al<am.item.length-1){an+=", "}}an='<span title="'+an+'">'+an+"</span>"}else{an=am.item.name;var ak="relation-value";if(am.item.guid!=undefined){ak=am.item.guid}an='<span title="'+an+'" class="c-'+ak+'">'+an+"</span>"}return an}};this.getValue=function(ag){var ad=z();var ac=ad[ag];if(ag=="name"){return this.control.onGetValueCallback(this.name,ag,this)}if(ac){if(ac.params[1]=="static"){return this.control.onGetValueCallback(ac,ag,this)}}if(!V.properties){return"&nbsp;"}if(!V.properties["group"]){return"&nbsp;"}var af=typeof(V.properties["group"][0])!="undefined"?V.properties["group"]:[V.properties["group"]];for(var ae=0;ae<af.length;ae++){if(!af[ae]["property"]){continue}var aa=typeof(af[ae]["property"][0])!="undefined"?af[ae]["property"]:[af[ae]["property"]];for(var ab=0;ab<aa.length;ab++){if(aa[ab]["name"]==ag){aa[ab]=this.control.onGetValueCallback(aa[ab],ag,this);return C(aa[ab])}}}return this.control.onGetValueCallback("",ag,this)};this.getData=function(){return V};this.setPageing=function(ab){if(!ab||!N){return false}this.pageing=ab;N.parentNode.style.display="none";N.classList.add("panel-sorting");N.innerHTML="";N.style.textAlign="left";if(this.isRoot){this.setPageingLimits(ab)}if(ab.total<=ab.limit&&ab.offset<=0){return}N.parentNode.style.display="";var ad=function(al){return function(){m.filter.setPage(al);m.applyFilter(m.filter,true);return false}};var ah=Math.ceil(ab.total/ab.limit);var ag=Math.ceil(ab.offset/ab.limit);var aj;var af=true;var ak=0;var ac=(Math.ceil(ab.total/ab.limit)-1);var aa=1;var ae=function(al){return(al!=ak&&al!=ac&&(Math.abs(al-ag)>aa))};for(var ai=0;ai<ah;ai+=1){if(ae(ai)){if(af){aj=document.createElement("a");aj.href="#";aj.innerHTML="…";aj.className="pagination-ellipsis";aj.onclick=function(){return false};N.appendChild(aj)}af=false;continue}af=true;aj=document.createElement("a");aj.href="#";if(ag==ai){aj.className="current"}aj.innerHTML=ai+1;aj.onclick=ad(ai);N.appendChild(aj)}};this.expand=function(){if(!this.hasChilds){return false}this.isExpanded=true;if(!this.loaded){this.loaded=true;this.control.load(this.filter)}if(f){f.classList.add("switch")}this.childsContainer.style.display="";$(this.childsContainer).find(".checkbox input:checked").parent().addClass("checked");$(this.childsContainer).find(".checkbox").click(function(){$(this).toggleClass("checked")});if(this.loaded){Control.recalcItemsPosition()}this.control.saveItemState(this.id)};this.collapse=function(){if(!this.hasChilds){return false}this.isExpanded=false;if(f){f.classList.remove("switch")}this.childsContainer.style.display="none";Control.recalcItemsPosition();this.control.saveItemState(this.id)};this.toggle=function(aa){if(this.hasChilds){$(aa).toggleClass("switch");this.isExpanded?this.collapse():this.expand()}};this.update=function(aa){if(aa){if(this.id!=aa.id){return false}V=aa;if(typeof(aa["template-id"])!=="undefined"){this.templateId=aa["template-id"]}if(typeof(aa.link)!=="undefined"&&aa.link!=this.viewLink){this.viewLink=aa.link;s.setAttribute("href",this.viewLink)}if(typeof(aa.childs)!=="undefined"&&parseInt(aa.childs)!==h){h=parseInt(aa.childs);this.hasChilds=h>0||K==0;var ac=$("td.table-cell > div > span:first",s);if(m.hasChilds){ac.removeClass("catalog-toggle-off");ac.removeClass("switch");ac.addClass("catalog-toggle-wrapper");ac.empty();f=document.createElement("span");f.className="catalog-toggle switch";f.src="/images/cms/admin/mac/tree/collapse.png";ac.append(f)}else{ac.removeClass("catalog-toggle-wrapper");ac.removeClass("switch");ac.addClass("catalog-toggle-off");ac.empty()}}var ab=typeof(aa["is-active"])!=="undefined"?parseInt(aa["is-active"]):0;if(ab!==this.isActive){this.isActive=ab;this.isActive=g(this,this.isActive);if(!this.isActive&&!m.control.objectTypesMode){jQuery(m.row).addClass("disabled")}else{jQuery(m.row).removeClass("disabled")}if(I){jQuery("div",I).html(C({type:"boolean",value:this.isActive}))}}if(typeof(aa.name)!=="undefined"&&aa.name!=this.name){this.name=aa.name.length?aa.name:"";E.innerHTML=this.name.length?this.name:getLabel("js-smc-noname-page")}}};this.applyFilter=function(ab,aa){if(ab instanceof Object){this.filter=ab}else{this.filter.clear()}if(!aa){this.filter.setParentElements(K)}if(this.loaded){this.control.removeItem(K,true);this.loaded=false;if(this.isExpanded){this.expand()}}};this.check=function(){if(r){$(m.checkBox).toggleClass("checked")}};this.setSelected=function(aa){if(aa){if(!H){H=s.className;s.classList.add("selected")}if(r){$(this.checkBox).addClass("checked")}b=true}else{if(H){H=null}$(s).removeClass("selected");if(r){$(this.checkBox).removeClass("checked")}b=false}};this.getSelected=function(){return b};this.setPageingLimits=function(ab){var ad=function(af){return function(){m.filter.setLimit(af);m.applyFilter(m.filter,true);return false}};var aa=document.getElementById("per_page_limit");aa.innerHTML="<span>"+getLabel("js-label-elements-per-page")+"</span>";for(var ac in m.pageLimits){var ae=document.createElement("a");ae.className="per_page_limit";ae.rel="0";ae.innerHTML=m.pageLimits[ac];ae.onclick=ad(m.pageLimits[ac]);if(m.pageLimits[ac]==ab.limit){ae.className+=" current"}aa.appendChild(ae)}};c()};TableItem.minColumnWidth=150;TableItem.maxColumnWidth=800;TableItem.orderByColumn=function(f,a,b){if(!a||!f||!b){return false}var e,c="";if(a.orderColumn===b){c=b.classList.contains("switch")?"":"switch";if(c==""){b.classList.remove("switch")}if(c!==""){b.classList.add(c)}}else{if(a.orderColumn){a.orderColumn.classList.remove("switch");a.orderColumn.classList.add("disabled")}a.orderColumn=b;a.orderColumn.classList.remove("disabled")}e=(c==""?"asc":"desc");var d=a.dataSet.getDefaultFilter();d.setOrder(f,e);a.dataSet.setDefaultFilter(d);a.applyFilter()};TableItem.showPreviewImage=function(d,e){if(!d||!e){return}var c=d.target?d.target:d.toElement;var a=d.pageX?d.pageX:d.clientX;var f=d.pageY?d.pageY:d.clientY;var b=document.createElement("img");b.setAttribute("src",e);b.src=e;b.className="img-fieled-preview";b.style.position="absolute";b.style.width="180px";b.style.height="120px";b.style.top=f+10+"px";b.style.left=a+10+"px";b.style.border="1px solid #666";document.body.appendChild(b);c.onmouseout=function(){b.parentNode.removeChild(b)}};var TreeToolbar=function(a){var o=this;var t=a;var n=null;var g=parseInt(t.container.style.zIndex)||0;var f=t.dataSet;var e=0;this.highlight=null;this.element=null;this.buttons=[];var j=function(){var u=document.getElementById("tree_toolbar_"+t.uid);h(u,{name:"ico_add",className:"i-add",hint:getLabel("js-add-subpage"),init:function(z){var y=(n!==null&&n.createLink!==false);var x=false;if(y){x=(n.permissions&&n.permissions&4||!n.permissions)}if(y&&x&&p){z.element.setAttribute("href",n.createLink);z.element.classList.remove("disabled")}else{z.element.classList.add("disabled")}}});h(u,{name:"ico_edit",className:"i-edit",hint:getLabel("js-edit-page"),init:function(A){var z=(n!==null&&n.editLink!==false);var y=false;if(z){y=n.permissions&2}if(z&&y&&p){var B=getLabel("js-edit-page");var x=n.editLink;A.element.classList.remove("disabled");if(n.lockedBy){B=getLabel("js-page-is-locked");x="#";A.element.classList.add("disabled")}A.element.setAttribute("title",B);A.element.setAttribute("href",x)}else{A.element.classList.add("disabled")}},release:function(){if(n!==null){if(n.lockedBy){alert(getLabel("js-page-is-locked"));return false}}return true}});h(u,{name:"blocking",className:"i-vision",hint:getLabel("js-disable-page"),init:function(x){if(n!==null&&n.allowActivity){var y=n.isActive?"small-ico i-vision":"small-ico i-hidden";var z=n.isActive?getLabel("js-disable-page"):getLabel("js-enable-page");x.element.firstChild.className=y;x.element.setAttribute("href","#");x.element.setAttribute("title",z);x.element.classList.remove("disabled")}else{x.element.classList.add("disabled")}},release:function(A){if(n!==null){var C="";var y="";if(p()){C=n.isActive?"small-ico i-vision":"small-ico i-hidden";y=n.isActive?getLabel("js-enable-page"):getLabel("js-disable-page");A.element.setAttribute("title",y);A.element.firstChild.className=C;f.execute("tree_set_activity",{element:n.id,active:n.isActive?0:1,handle_item:n})}else{var z=q();var F=false,x=false;for(var B in z){if(!z.hasOwnProperty(B)){continue}var E=z[B];if(E.isActive){F=true}else{x=true}}var D=(F&&!x);C=D?"small-ico i-vision":"small-ico i-hidden";y=D?getLabel("js-enable-page"):getLabel("js-disable-page");A.element.setAttribute("title",y);A.element.firstChild.className=C;f.execute("tree_set_activity",{element:s(),selected_items:z,active:(D?0:1)})}}return false}});h(u,{name:"copy",className:"i-copy-virtual",hint:getLabel("js-vcopy-str"),init:function(x){if(n!==null&&n.allowCopy&&p()){x.element.classList.remove("disabled")}else{x.element.classList.add("disabled")}},release:function(){if(n!==null){n.className="ti virtual";if(n.isDefault){n.labelControl.className+=" main-page"}n.isVirtualCopy=true;f.execute("tree_copy_element",{element:n.id,childs:1,links:1,virtuals:1,permissions:1,handle_item:n,copy_all:0})}return false}});h(u,{name:"clone",className:"i-copy",hint:getLabel("js-copy-str"),init:function(x){if(n!==null&&n.allowCopy&&p()){x.element.classList.remove("disabled")}else{x.element.classList.add("disabled")}},release:function(){if(n!==null){f.execute("tree_copy_element",{element:n.id,childs:1,links:1,permissions:1,handle_item:n,copy_all:0,clone_mode:1})}return false}});h(u,{name:"view",className:"i-see",hint:getLabel("js-view-page"),init:function(x){if(n!==null&&n.viewLink!==false&&p()){x.element.setAttribute("href",n.viewLink);x.element.setAttribute("target","_blank");x.element.classList.remove("disabled")}else{x.element.classList.add("disabled")}}});h(u,{name:"ico_del",className:"i-remove",hint:getLabel("js-del-str"),init:function(z){var A=getLabel("js-delete");var y=(n!==null&&n.id>0);var x=false;if(y){x=(n.permissions&&n.permissions&8||!n.permissions)}if(y&&x){z.element.setAttribute("title",A);z.element.setAttribute("href","#");z.element.classList.remove("disabled")}else{z.element.classList.add("disabled")}},release:function(){if(n!==null){if(n.lockedBy){alert(getLabel("js-page-is-locked"))}else{if(p()){f.execute("tree_delete_element",{childs:1,element:n.id,handle_item:n})}else{var z=q();for(var y=0,x=z.length;y<x;y++){var A=z[y];if(A.lockedBy){alert(getLabel("js-page-is-locked")+"\n"+getLabel("js-steal-lock-question"));ContextMenu.getInstance().terminate();return false}}f.execute("tree_delete_element",{element:s(),selected_items:z})}}}return false}});var w=document.createElement("ul");c(w,{name:"amend",className:"i-amend",hint:getLabel("js-change-template"),chEl:true,init:function(z){var A=d();z.chEl.innerHTML="";for(var y=0,x=A.length;y<x;y++){c(z.chEl,A[y])}if(n!==null){z.element.classList.remove("disabled")}else{z.element.classList.add("disabled")}}});u.appendChild(w);var v=document.createElement("ul");c(w,{name:"copy-other",className:"i-copy-other",hint:getLabel("js-crossdomain-copy"),chEl:true,init:function(z){var A=b();z.chEl.innerHTML="";for(var y=0,x=A.length;y<x;y++){c(z.chEl,A[y])}if(n!==null){z.element.classList.remove("disabled")}else{z.element.classList.add("disabled")}}});u.appendChild(v);u.onclick=function(x){x.stopPropagation()};h(u,{name:"selectAll",className:"i-select",hint:getLabel("js-select-all"),alwaysActive:true,init:function(x){x.element.classList.remove("disabled")},release:function(){t.select(t.items)}});h(u,{name:"unSelectAll",className:"i-unselect",hint:getLabel("js-un-select-all"),alwaysActive:true,init:function(x){x.element.classList.remove("disabled")},release:function(){t.unSelect(t.items);o.hide()}});h(u,{name:"invertAll",className:"i-invertselect",hint:getLabel("js-invert-all"),init:function(x){if(n!==null){x.element.classList.remove("disabled")}else{x.element.classList.add("disabled")}},release:function(){t.forEachItem(t.items,function(x){t.toggleItemSelection(x)})}});o.element=u;l()};var m=function(){e=r();for(var u=0;u<o.buttons.length;u++){o.buttons[u].init(o.buttons[u])}};var l=function(){e=r();for(var u=0;u<o.buttons.length;u++){if(!o.buttons[u].isAllwaisActive){o.buttons[u].element.classList.add("disabled")}}};var d=function(){var C=q();var z,B=false,u=false,w=false,A=false;for(z in C){var I=C[z];if(!B||!u){B=I.langId;u=I.domainId}if(w&&A){if(w!=I.templateId){w=false}}if(!w&&!A){w=I.templateId;A=true}}var y=TemplatesDataSet.getInstance();var E=[],G=y.getTemplatesList(u,B);var x=function(K){if(!n){return false}var M=n.control,J,L=[];for(J in C){L.push(J)}f.execute("change_template",{element:L,"template-id":K.data,templates:1,childs:1,permissions:1,virtuals:1,links:1});return false};for(z in G){var H=G[z];var v=H.id,D=H.title,F=false;if(!v){continue}if(w&&w==v){F=true}E.push({className:F?"checked":"undefined",caption:D,name:D,release:x,data:v})}return E};var b=function(){var B=n.control;var H=q();var D,A,K,u=false,G=false;for(D in H){K=H[D];u=K.domainId;G=K.langId}var C=TemplatesDataSet.getInstance();var E=C.getLangsList();var I=C.getDomainsList();var z=function(M){var L,N=[];for(L in H){N.push(L)}f.addEventHandler("onBeforeExecute",createConfirm(B.dataSet));f.execute("copyElementToSite",{element:N,"lang-id":M.data.langId,"domain-id":M.data.domainId,templates:1,childs:1,permissions:1,virtuals:1,links:1});return false};var w=[];for(D=0;D<I.length;D++){var F=I[D];var J=(u==F.id);var y=[];for(A=0;A<E.length;A++){var x=E[A];var v=J&&(G==x.id);y.push({className:v?"checked":"undefined",caption:x.nodeValue,data:{domainId:F.id,langId:x.id},release:z})}w.push({className:J?"checked":"undefined",caption:F.host,chEl:true,submenu:y})}return w};var c=function(u,v){var w=document.createElement("li");u.appendChild(w);if(v.chEl){v.chEl=document.createElement("ul")}h(w,v)};var p=function(){return(r()==1)};var q=function(){return t.selectedList};var s=function(){return Object.keys(q())};var r=function(){var u=s();return u.length};var h=function(x,J){var F=document.createElement("a");F.className="icon-action";var v=J.name||"toolbtn";var I=J.caption||"";var w=J.href||null;var E="small-ico "+(J.className||"");var H=J.init||function(){};var G=J.hint||"";var C=J.data||null;var u=J.chEl||null;var A=J.alwaysActive||false;var B=document.createElement("i");B.className=E;F.appendChild(B);var y=x.appendChild(F);if(u!==null){x.appendChild(u)}var D={name:v,href:w,className:E,init:H,element:y,data:C,caption:I,chEl:u,isAllwaisActive:A};o.buttons.push(D);if(w!==null){y.setAttribute("href",w)}y.setAttribute("title",G);$(y).data("info",C);if(I!==""){y.innerHTML=I;y.className=(J.className&&J.className!="undefined"?J.className:"")}if(typeof(J.release)==="function"){y.onclick=function(K){if(!f.isAvailable()){return false}K.stopPropagation();if(n!==null&&!$(this).hasClass("disabled")||A){return J.release(D)}};y.onmouseup=function(K){K.stopPropagation()}}else{y.onclick=function(K){K.stopPropagation();if(!f.isAvailable()){return false}if(n!==null&&n.focus||A){n.focus()}return true};y.onmouseup=function(K){K.stopPropagation()}}y.name=v;if(u!==null&&J.submenu!=undefined&&J.submenu.length>0){for(var B=0,z=J.submenu.length;B<z;B++){c(u,J.submenu[B])}}};var k=function(){var u=document.createElement("div");u.className="tree-highlight";u.style.display="none";u.style.position="absolute";u.style.zIndex=g-1;o.highlight=t.container.appendChild(u);j()};this.show=function(v,u){u=u||false;if(typeof(v)==="undefined"||(n===v&&!u)){return false}n=v;if(n.isDefault){n.labelControl.className+=" main-page"}m();this.element.style.display=""};this.hide=function(){if(n){if(n.getSelected()){n.labelControl.classList.add("selected")}else{if(n.isVirtualCopy){n.labelControl.classList.add("virtual")}else{n.labelControl.classList.remove("virtual");n.labelControl.classList.remove("selected")}}if(n.isDefault){n.labelControl.className+=" main-page"}n=null}l()};if(typeof(t)==="object"){k()}else{alert("Can't create toolbar without control object")}this.getButton=function(u){return _.findWhere(this.buttons,{name:u})}};var TableToolbar=function(b){var t=this;var u=b;var s=null;var f=parseInt(u.container.style.zIndex)||0;var d=u.iconsPath;var e=u.dataSet;this.TableTollbarFunctions={delButton:{name:"ico_del",className:"i-remove",hint:getLabel("js-delete"),init:function(v){var x=v.element;var y=getLabel("js-delete");if(s!==undefined&&(s.permissions&&s.permissions&8||!s.permissions)){var w=d+"ico_del.png";x.setAttribute("title",y);x.setAttribute("href","#");x.style.display="inline-block"}else{x.style.display="none"}},release:function(w){var x=[];var y=u.selectedList;var v=Object.keys(y).length;if(v>0){for(var z in y){if(!y.hasOwnProperty(z)){continue}x.push(z)}}if(s!==undefined){e.execute("tree_delete_element",{element:x,selected_items:y})}return false}},editButton:{name:"ico_edit",className:"i-edit",hint:getLabel("js-edit-item"),init:function(w){var x=w.element;if(s!==undefined&&s.editLink!==false&&(s.permissions&&s.permissions&2||!s.permissions)){var v=s.editLink;x.setAttribute("href",v);x.style.display="inline-block"}else{x.style.display="none"}},release:function(v){return true}},addButton:{name:"ico_add",className:"i-add",hint:getLabel("js-add-page"),init:function(v){if(s!==undefined&&s.createLink!==false){v.element.setAttribute("href",s.createLink);v.element.style.display="inline-block"}else{v.element.style.display="none"}}},blockingButton:{name:"blocking",hint:getLabel("js-disable-page"),className:"",init:function(v){if(s==undefined){v.element.style.display="none";return false}var x=s.allowActivity&&(b.contentType=="pages"||(b.contentType=="objects"&&b.enableObjectsActivity));if(s!==undefined&&x){var w=s.isActive?"small-ico i-hidden":"small-ico i-vision";var y=s.isActive?getLabel("js-disable-page"):getLabel("js-enable-page");if(b.contentType=="objects"){y=s.isActive?getLabel("js-disable"):getLabel("js-enable")}$("i",$(v.element)).attr("class",w);v.element.setAttribute("href","#");v.element.setAttribute("title",y);v.element.style.display="inline-block"}else{v.element.style.display="none"}},release:function(w){if(s!==undefined){var x=s.isActive?"small-ico i-vision":"small-ico i-hidden";var A=s.isActive?getLabel("js-enable"):getLabel("js-disable");w.element.setAttribute("title",A);$("i",$(w.element)).attr("class",x);var y=[];var z=u.selectedList;var v=Object.keys(z).length;if(v>0){for(var B in z){if(!z.hasOwnProperty(B)){continue}y.push(B)}}e.execute("tree_set_activity",{element:y,object:y,active:s.isActive?0:1,selected_items:s.control.selectedList,viewMode:"full"})}return false}},viewButton:{name:"view",hint:getLabel("js-view-page"),className:"i-see",init:function(v){if(s!==undefined&&s.getData&&s.getData().guide=="guide"){v.element.setAttribute("href",window.pre_lang+"/admin/data/guide_items/"+s.id+"/");v.element.style.display="inline-block"}else{if(s!==undefined&&s.viewLink!==false){v.element.setAttribute("href",s.viewLink);v.element.style.display="inline-block"}else{v.element.style.display="none"}}}},csvExportButton:{name:"csvExport",hint:getLabel("js-csv-export"),className:"i-csv-export",init:function(v){$(v.element).show();if(u.contentType!=="pages"||(s&&s.baseMethod!="category")){$(v.element).hide()}},release:function(){n("exportCallback");return false}},csvImportButton:{name:"csvImport",hint:getLabel("js-csv-import"),className:"i-csv-import",init:function(v){$(v.element).show();if(u.contentType!=="pages"||(s&&s.baseMethod!="category")){$(v.element).hide()}},release:function(){n("importCallback");return false}},restoreButton:{name:"i-restore",hint:getLabel("js-trash-restore"),className:"i-restore",init:function(v){if(s!==undefined&&(s.permissions&&s.permissions&8||!s.permissions)){v.element.style.display="inline-block"}else{v.element.style.display="none"}},release:function(x){if(s!==undefined){var v=u.selectedList,y=[];for(var w in v){y.push(w)}u.dataSet.execute("restore_element",{element:y,selected_items:v});return false}return false}},moveButton:{name:"moveElement",hint:getLabel("js-change-parent"),className:"i-move-other",init:function(v){if(u.flatMode||u.contentType!=="pages"||(uAdmin.data&&uAdmin.data.module!="catalog")){$(v.element).hide()}},release:function(){CatalogModule.openCategoriesWindow(s)}},delIndex:{name:"deleteIndex",hint:getLabel("js-indexing-deleting-confirmation"),className:"i-remove",init:function(v){if(_.keys(u.selectedList).length===0){r(v)}else{q(v)}},release:function(){var v=_.keys(u.selectedList);if(v.length>0){AdminIndexing.Controller._deleteIndexes(v)}}},selectAllButton:{name:"selectAll",hint:getLabel("js-select-all"),className:"i-select",alwaysActive:true,init:function(v){},release:function(){u.select(u.items);return false}},unSelectAllButton:{name:"unSelectAll",hint:getLabel("js-un-select-all"),className:"i-unselect",alwaysActive:true,init:function(v){},release:function(){u.unSelect(u.items);t.hide();return false}},invertAllButton:{name:"invertAll",hint:getLabel("js-invert-all"),className:"i-invertselect",init:function(v){if(s!==undefined){q(v)}else{r(v)}},release:function(){u.forEachItem(u.items,function(v){u.toggleItemSelection(v)});if(_.size(u.selectedList)===0){t.hide()}return false}}};this.highlight=null;this.element=null;this.buttons=[];this.menu=[this.TableTollbarFunctions.viewButton,this.TableTollbarFunctions.blockingButton,this.TableTollbarFunctions.addButton,this.TableTollbarFunctions.editButton,this.TableTollbarFunctions.delButton,this.TableTollbarFunctions.csvExportButton,this.TableTollbarFunctions.csvImportButton,this.TableTollbarFunctions.moveButton];this.__selectButtons=[this.TableTollbarFunctions.selectAllButton,this.TableTollbarFunctions.unSelectAllButton,this.TableTollbarFunctions.invertAllButton];this.__singleActionButtons=[this.TableTollbarFunctions.editButton,this.TableTollbarFunctions.addButton,this.TableTollbarFunctions.viewButton,this.TableTollbarFunctions.csvExportButton,this.TableTollbarFunctions.csvImportButton];this.__exchangeButtons=[this.TableTollbarFunctions.csvExportButton,this.TableTollbarFunctions.csvImportButton];var j=function(){if(u.toolbarFunctions!==null){var v=Object.keys(u.toolbarFunctions);for(var z=0,w=v.length;z<w;z++){t.TableTollbarFunctions[v[z]]=u.toolbarFunctions[v[z]]}}if(u.toolbarMenu!==null){t.menu=[];for(var x=0,B=u.toolbarMenu.length;x<B;x++){t.menu.push(t.TableTollbarFunctions[u.toolbarMenu[x]])}}if(TTCustomizer.menu.length>0&&_.keys(TTCustomizer.buttons).length>0){_.extend(t.TableTollbarFunctions,TTCustomizer.buttons);if(!TTCustomizer.extendDefault){t.menu=[]}for(var D=0,C=TTCustomizer.menu.length;D<C;D++){t.menu.push(t.TableTollbarFunctions[TTCustomizer.menu[D]])}}var y=document.getElementById("tollbar_wrapper");for(var A=0,w=t.menu.length;A<w;A++){if(t.menu[A].name=="ico_add"){if(!TableToolbar.disableAddButton){h(y,t.menu[A])}}else{h(y,t.menu[A])}}for(var A=0,w=t.__selectButtons.length;A<w;A++){h(y,t.__selectButtons[A])}t.element=y;u.dataSet.addEventHandler("onAfterLoad",g);m(t.menu);r(t.__selectButtons[2])};var g=function(){var v=Object.keys(u.items),w=v.length>1?2:1;s=u.items[v[w]];p();m(t.menu);r(t.__selectButtons[2])};var k=function(w,z){if(!w||!w.id){return false}var y=w.control;if(!y||y.objectTypesMode||y.flatMode){return false}var A=y.selectedList;var v=Object.keys(A).length;var x=A[Object.keys(A)[0]];if(z==="exportCallback"&&!x.hasChilds){return false}return(x.id&&v===1&&x[z])};var n=function(z){var w=s;var v=["importCallback","exportCallback"];if(!k(w,z)||v.indexOf(z)===-1){return}var y=w.control;var A=y.selectedList;var x=A[Object.keys(A)[0]];x[z](x.id)};var p=function(){for(var v=0;v<t.buttons.length;v++){t.buttons[v].init(t.buttons[v])}};var h=function(x,G){var D=document.createElement("a");D.className="icon-action";var v=G.name||"toolbtn";var w=G.href||"#";var C="small-ico "+(G.className||"");var F=G.init||function(){};var E=G.hint||"";var z=G.alwaysActive||false;var A=document.createElement("i");A.className=C;D.appendChild(A);var y=x.appendChild(D);var B={name:v,href:w,className:C,init:F,element:y};G.element=y;t.buttons.push(B);y.setAttribute("href",w);y.setAttribute("title",E);if(typeof(G.release)==="function"){y.onclick=function(){if(!e.isAvailable()){return false}if(s&&!$(this).hasClass("disabled")||z){return G.release(B)}else{return false}}}else{y.onclick=function(){if(!e.isAvailable()){return false}if($(this).hasClass("disabled")||z){return false}if(s&&s.focus){s.focus()}return true}}y.name=v};var o=function(w){var v=t.element;var x=jQuery(w.element,v);return(x.length>0?x.eq(0):null)};var r=function(w){var v=o(w);if(v){v.addClass("disabled")}};var q=function(w){var v=o(w);if(v){v.removeClass("disabled")}};var a=function(w,v){var v=(typeof v=="function"?v:function(){});(function(){for(var y=0;y<w.length;y++){var x=w[y];v(x)}})()};var m=function(v){a(v,r)};var c=function(v){a(v,q)};var l=function(){var v=document.createElement("div");v.className="tree-highlight";v.style.display="none";v.style.position="absolute";v.style.zIndex=f-1;t.highlight=u.container.appendChild(v);j()};this.show=function(y,w){w=w||false;if(typeof(y)==="undefined"||(s===y&&!w)){return false}s=y;var v=Object.keys(s.control.selectedList).length;c(this.menu);q(this.__selectButtons[2]);if(v>1){m(this.__singleActionButtons)}p();var x=s.control;if(x.flatMode||x.objectTypesMode){m(t.__exchangeButtons)}this.element.style.display=""};this.hide=function(){if(s){if(s.getSelected()){s.labelControl.classList.add("selected")}else{if(s.isVirtualCopy){s.labelControl.classList.add("virtual")}else{s.labelControl.classList.remove("virtual");s.labelControl.classList.remove("selected")}}m(this.menu);r(this.__selectButtons[2]);s=null}};if(typeof(u)==="object"){l()}else{alert("Can't create toolbar without control object")}};TableToolbar.disableAddButton=false;var Control=function(o,a,f){var t=this;var k=o;var g=a;var f=typeof(f)=="object"?f:{};var m=typeof(f.draw)=="boolean"?f.draw:false;var y=typeof(f.expandAll)=="boolean"?f.expandAll:false;var b=typeof(f.toolbar)==="function"?f.toolbar:false;var s=null;var j=null;var n=typeof(f.ignoreHierarchy)==="boolean"?f.ignoreHierarchy:false;var l=typeof(f.onRenderComplete)==="function"?f.onRenderComplete:function(){};var u=new filter();var w=SettingsStore.getInstance();var e=typeof(f.onItemClick)==="function"?f.onItemClick:function(){return true};var c=typeof(f.onItemSelect)==="function"?f.onItemSelect:function(){return true};var q=typeof(f.onTargetSelect)==="function"?f.onTargetSelect:function(){return true};Control.instances[Control.instances.length]=this;this.container=typeof(f.container)=="object"?f.container:document.body;this.dataSet=k;this.toolbar=null;this.items={};this.id=f.id||Math.random();this.uid=f.uid||Math.round(Math.random()*100000);this.iconsPath=f.iconsPath||"/images/cms/admin/mac/tree/";this.flatMode=f.flatMode||false;this.defaultRootMode=f.defaultRootMode||false;this.objectTypesMode=f.objectTypesMode||false;this.contentType=f.contentType||"pages";this.enableObjectsActivity=f.enableObjectsActivity||false;this.lastClicked=null;this.selectedList={};this.targetsList={};this.dragAllowed=typeof(f.allowDrag)=="boolean"?f.allowDrag:true;this.onGetValueCallback=typeof(f.onGetValueCallback)==="function"?f.onGetValueCallback:function(C,A,B){return C};this.onDrawFieldFilter=typeof(f.onDrawFieldFilter)==="function"?f.onDrawFieldFilter:function(B,A){return false};this.onRemoveColumn=typeof(f.onRemoveColumn)==="function"?f.onRemoveColumn:function(A){return false};this.initContainer=this.container;this.disableCSVButtons=f.disableCSVButtons||false;this.hideCsvImportButton=f.hideCsvImportButton||false;this.disableTooManyChildsNotification=f.disableTooManyChildsNotification||false;this.labelFirstColumn=(typeof(f.label_first_column)==="string")?f.label_first_column:"";this.PerPageLimits=typeof(f.perPageLimits)=="array"?f.perPageLimits:[10,20,50,100];this.enableEdit=f.enableEdit;this.visiblePropsMenu=f.visiblePropsMenu;this.requiredPropsMenu=f.requiredPropsMenu;this.sequencePropsMenu=f.sequencePropsMenu;this.toolbarFunctions=f.toolbarFunctions||null;this.toolbarMenu=f.toolbarMenu||null;this.disableNameFilter=f.disableNameFilter||false;this.hasCheckboxes=typeof f.hasCheckboxes=="boolean"?f.hasCheckboxes:true;this.isCanSelect=typeof f.isCanSelect=="boolean"?f.isCanSelect:true;this.onElementMouseOver=typeof f.onElementMouseOver=="function"?f.onElementMouseOver:function(){};this.onElementMouseOut=typeof f.onElementMouseOut=="function"?f.onElementMouseOut:function(){};this.onElementClick=typeof f.onElementClick=="function"?f.onElementClick:function(){};this.noCheckboxes=!!(parseInt(f.noCheckboxes));var p=function(){if(m){t.init()}};var d=function(){if(typeof(t.items[s])==="undefined"){t.items[s]=new g(t,null,{id:(s?s:0),iconbase:"/images/cms/admin/mac/tree/ico_domain.png"})}t.items[s].draw();if(b){t.toolbar=new b(t)}if(t.getItemState(s)||s!==0){t.items[s].expand()}};var x=function(B,A){for(var C=0;C<B.length;C++){if(B[C]===A){return B[C]}}return null};var r=function(E,A,C){if(typeof(A)!="object"||typeof(E)=="undefined"){return false}if(!C){C=false}var D=A.id;for(var B=0;B<E.length;B++){var G=(typeof(E[B]["parentId"])!="undefined")?parseInt(E[B]["parentId"]):0;if(n){G=0}if(G==D||C){var F=parseInt(E[B]["id"]);if(t.items[F]){t.items[F].update(E[B])}else{t.items[F]=A.appendChild(E[B]);if(y||t.getItemState(F)){t.items[F].expand()}}r(E,t.items[F])}}(function(){var H=null;var J=null;var K=null;for(var I=0;I<E.length;I++){H=typeof E[I]=="object"?E[I]:{};K=typeof E[I+1]=="object"?E[I+1]:{};J=t.getItem(H.id);J.nextSibling=t.getItem(K.id)}}())};var h=function(I){var G=I.objects;var C=I.filter;var B=I.paging;var A=C.getParents();if(C.Parents!=null){B.parent=C.Parents[0]}if(C.AllText.length>0&&B.total==0){openDialog(getLabel("js-smc-empty-result"),getLabel("js-smc-empty-title"))}var D=false;if(!A.length){A=[(s?s:0)];D=true}for(var E=0;E<A.length;E++){var F=parseInt(A[E]);var H=(typeof(t.items[F])!="undefined")?t.items[F]:t.items[s];r(G,H,D);if(H){H.setLoaded(true);H.setPageing(B)}}l();Control.recalcItemsPosition();if(Control.HandleItem&&t.toolbar){t.toolbar.show(Control.HandleItem,true)}};var v=function(){t.removeItem(s);if(j){if(t.initContainer){t.container=t.initContainer}var A=t.setRootNode(j,true);A.draw()}Control.recalcItemsPosition()};var z=function(K){var V=K.objects;var X=K.error;var P=K.params;var R=P.paging;var J=P.handle_item;var ah=P.selected_items;var T={};if(ah){T=ah}else{if(J){T[J.id]=J}}var C=K.method;if(!X){switch(C.toLowerCase()){case"restore_element":case"del":case"tree_delete_element":for(var U in T){var I=T[U];t.removeItem(U);delete t.selectedList[U];if(I.parent&&I.parent.parent){r(V,I.parent.parent)}}Control.HandleItem=null;if(t.toolbar){t.toolbar.hide()}break;case"export":var ab,ai="";if(K.objects[0].file){window.location=K.objects[0].file}break;case"move":case"tree_move_element":var W=P.receiver_item;var Q=P.before?W.control.getItem(P.before):null;var D=P.after?W.control.getItem(P.after):null;if(!W){break}if(W.control.contentType==="objects"){W=W.control.getRoot();if(V.length&&J){var M=V[0]||[];var L=V[1]||[];var E=V[2]||[];if(J.parent){J.parent.update(E)}W.update(L);J.control.removeItem(J.id);var I=null;if(P["as-sibling"]){if(Q){I=W.appendBefore(M,Q)}else{if(D){I=W.appendAfter(M,D)}else{I=W.appendChild(M)}}}else{if(W.loaded){I=W.appendFirst(M)}}if(I){W.control.items[I.id]=I}}break}if(V.length===0){break}var ac=[];ac.id=W.id;ac["is-active"]=W.isActive;ac.childs=0;var Y=[];for(var ag in V){var aa=V[ag];var N=aa.id;var ad=t.selectedList[N];if(ad){if(!Y[ad.parent.id]){Y[ad.parent.id]=1}else{Y[ad.parent.id]++}}t.removeItem(N);delete t.selectedList[N];if(P["as-sibling"]){if(Q){I=W.appendBefore(aa,Q)}else{if(D){I=W.appendAfter(aa,D)}else{I=W.appendChild(aa)}}}else{I=W.appendFirst(aa)}if(I){W.control.items[I.id]=I;ac.childs++;I.control.getSelectionCallback()(I)}}for(U in Y){var G=t.getItem(U);if(!G){continue}var B=[];var A=$("tr[rel="+G.id+"] + tr > td > table.table > tr[rel]").length;B.id=G.id;B["is-active"]=G.isActive;B.childs=A-Y[U];G.update(B)}W.update(ac);break;case"change_template":(function(){if(!K.HandleItem||!K.HandleItem.control||!K.HandleItem.control.toolbar){return}var ao=K.HandleItem.control.toolbar;var aj="amend";if(typeof ao.getButton!="function"){return}var an=ao.getButton(aj);var ap=an.element;var am=$(ap).next("ul");var ak=am.find("li a");var al=parseInt(K.params["template-id"]);ak.removeClass("checked");ak.each(function(){var aq=$(this).data("info");if(aq==al){$(this).addClass("checked")}})})();break;case"copyElementToSite":(function(){for(var ak in V){var aq=V[ak];var aj="tree-content-sitetree-"+aq["domain-id"];var an=false;for(var al in Control.instances){var ao=Control.instances[al];if(ao.id==aj){an=ao}}if(typeof an!="object"){continue}var am=an.getRoot();var ap=aq.id;if(an.items[ap]){an.items[ap].update(aq)}else{an.items[ap]=am.appendChild(aq)}}})();break;default:for(var U in T){var Z=t.items[U].parent;ignoreHierarchy=(!t.items[Z]);r(V,Z,ignoreHierarchy)}}if(t.toolbar&&J===Control.HandleItem){t.toolbar.show(Control.HandleItem,true)}Control.recalcItemsPosition();Control.PrepareDrag=false;Control.startDragItem=null;Control.PrepareDrag=false;Control.DragMode=false}else{var F=jQuery(X).find("type").text();if(F=="__alias__"){var S={};var ae=P;var af=jQuery(X).find("item");af.each(function(){var aj=jQuery(this).attr("path")+""+jQuery(this).attr("alias");var al="<form method='post' id='' enctype='multipart/form-data' ";al+=" action=''>"+getLabel("js-smc-control-page-already-exist",aj);al+="<br/><label for='new_alias'>"+getLabel("js-content-alias-copy")+"</label> <br/> ";al+=jQuery(this).attr("path")+"<input type='text' class='default alt-name' name='new_alias"+jQuery(this).attr("id")+"'  value='"+jQuery(this).attr("alt_name_normal")+"'  id='new_alias"+jQuery(this).attr("id")+"' size='15' />";al+="</form>";var ak=this;openDialog("",getLabel("js-move-title"),{html:al,width:400,confirmText:getLabel("js-content-alias-new"),cancelButton:true,cancelText:getLabel("js-content-alias-change"),cancelCallback:function(am){ae["move["+jQuery(ak).attr("id")+"]"]=1;H(function(){closeDialog(am)},jQuery(ak).attr("id"))},confirmCallback:function(an,am){ae["alias["+jQuery(ak).attr("id")+"]"]=jQuery("#new_alias"+jQuery(ak).attr("id"),am).val();H(function(){closeDialog(an)},jQuery(ak).attr("id"))}})});var H=function(ak,al){var aj=typeof ak=="function"?ak:function(){};var am=K.HandleItem;if(!am){aj();return}if(al){ae.element=[];ae.element.push(al)}am.control.dataSet.execute(""+C.toLowerCase()+"",ae);aj()}}else{if(F=="__template_not_exists__"){var O=jQuery(X).find("text").text();openDialog("","Ошибка",{html:O})}else{alert(X.firstChild.nodeValue)}}}};k.addEventHandler("onAfterLoad",h);k.addEventHandler("onAfterPieceLoad",h);k.addEventHandler("onInitComplete",d);k.addEventHandler("onBeforeRefresh",v);k.addEventHandler("onAfterExecute",z);this.initContainer.style.position="relative";this.init=function(){k.init()};this.load=function(A,B){k.load(A)};this.getItemByPosition=function(C,B){var A=null;for(var E in this.items){if(!this.items[E]){continue}var D=this.items[E].position;if(B>D.top){if(B<=D.bottom){if(C>D.left){if(C<=D.right){A=this.items[E];break}}}}}return A};this.getItem=function(A){if(typeof(this.items[parseInt(A)])=="object"){return this.items[parseInt(A)]}else{return false}};this.setRootNode=function(A,B){j=A;s=A.id;this.items[s]=new g(t,null,A);if(B){this.items[s].loaded=true}return this.items[s]};this.getRootNodeId=function(){return s};this.getRoot=function(){return this.items[s]};this.applyBehaviour=function(A){if(e){return e(A)}return true};this.saveItemState=function(B){var D=parseInt(B);if(this.items[D]){var E=this.items[D];var A=w.get(t.id,"expanded");var C="{"+E.id+"}";if(typeof(A)!="string"){A=""}if(A.indexOf(C)!==-1&&!E.isExpanded){A=A.replace(C,"");w.set(t.id,A,"expanded");return true}else{if(A.indexOf(C)===-1&&E.isExpanded){A+=C;w.set(t.id,A,"expanded");return true}else{return false}}}};this.applyFilter=function(B){this.selectItems([]);if(B!=undefined&&(B instanceof Object)){u=B}if(!u){return}var C=false;for(var A in this.targetsList){this.targetsList[A].applyFilter(u.clone());C=true}if(!C){t.items[s].applyFilter(u.clone(),true)}};this.getCurrentFilter=function(){return u};this.toggleItemSelection=function(A){if(A){if(A.getSelected()){A.setSelected();delete this.selectedList[A.id];c(A,false)}else{A.setSelected(true);this.selectedList[A.id]=A;c(A,true)}}};this.toggleRangeSelection=function(H){if(!this.lastClicked){return}var A=H.parent.childs;var I=A.indexOf(H.id);var F=A.indexOf(this.lastClicked.id);var D=Math.min(I,F);var E=Math.max(I,F);var G=A.slice(D,E+1);var K=[];for(var C=0;C<A.length;C++){K.push(this.getItem(A[C]))}this.unSelect(K);var J=null;var B=[];for(C=0;C<G.length;C++){J=this.getItem(G[C]);B.push(J)}this.select(B)};this.forEachItem=function(B,A){var C=typeof A=="function"?A:function(){};var D=(!$.isArray(B));$.each(B,function(E,F){if(D&&E==0){return}if(!F){return}C(F,E)})};this.unSelect=function(B){var A=this;this.forEachItem(B,function(C){C.setSelected(false);delete A.selectedList[C.id]});this.HandleItem=null;this.toolbar.hide()};this.select=function(B){var A=this;this.forEachItem(B,function(C){C.setSelected(true);A.selectedList[C.id]=C;t.HandleItem=C});this.toolbar.show(this.HandleItem)};this.setSelectionCallback=function(A,C){if(typeof(A)==="function"){if(C){c=A}else{var B=c;c=function(E,D){B(E,D);A(E,D)}}}};this.getSelectionCallback=function(){return c};this.selectItems=function(B){if(!(B instanceof Array)){B=[B]}for(var A in this.selectedList){this.toggleItemSelection(this.selectedList[A])}this.selectedList={};for(var A=0;A<B.length;A++){this.toggleItemSelection(B[A])}};this.setTargetItems=function(B){this.targetsList={};for(var A in B){this.targetsList[A]=B[A]}q(this.targetsList)};this.isTarget=function(A){for(var B in this.targetsList){if(this.targetsList[B]==A){return true}}return false};this.setTargetSelectCallback=function(A){if(typeof(A)==="function"){q=A}};this.getItemState=function(B){var D=parseInt(B);if(this.items[D]){var E=this.items[D];if(!E.hasChilds){return false}var A=w.get(t.id,"expanded");var C="{"+E.id+"}";if(typeof(A)!="string"){A=""}return(A.indexOf(C)!==-1)}return false};this.removeItem=function(D,A){var E=parseInt(D);if(this.items[E]){var F=this.items[E];var C=F.parent;for(var B=0;B<F.childs.length;B++){this.removeItem(F.childs[B])}F.childs=[];if(!A){this.items[E]=false;F.clear()}}};this.expandAll=function(){y=true;for(id in this.items){this.items[id].expand()}};this.collapseAll=function(){y=false;for(id in this.items){this.items[id].collapse()}};this.recalcItemsPosition=function(){for(var A in this.items){if(!this.items.hasOwnProperty(A)){continue}if(this.items[A]&&this.items[A].recalcPosition){this.items[A].recalcPosition()}}};this.handleMouseDown=function(A,E){var D=A.target,H=t.getItem(E),C=H.checkBox,G=A.button,F=H.element;var J=(F==D||D.parentNode==F);var I=(D==C||D.parentNode==C);if($(D).hasClass("name_col")){var J=(F==D||D.parentNode.parentNode.parentNode==F)}if(G==2&&H.getSelected()&&Object.keys(H.control.selectedList).length==1){return true}if(H instanceof TreeItem&&!$(D).hasClass("catalog-toggle")&&!$(D).hasClass("catalog-toggle-wrapper")){t.toggleSelection(H,A)}if((J||I)&&H instanceof TableItem){t.toggleSelection(H,A)}if(A.shiftKey){t.toggleRangeSelection(H)}this.saveSelectedItem(E);var B=A.target;if(B.className.toLowerCase()!="ti-toggle"){Control.PrepareDrag=true;Control.startDragItem=Control.HandleItem;Control.startDragX=A.pageX;Control.startDragY=A.pageY}};this.handleMouseUp=function(G,F){var A=this;var D=0;var H=(G.button==D);if(!Control.enabled||!H||!F){return}var C=Control.HandleItem;var E=A.toolbar;var B=Object.keys(A.selectedList).length;if(!Control.DragMode&&C){if((C.getSelected()||B>0)&&E){E.show(C,true)}A.lastClicked=C}if(B===0&&E){E.hide()}Control.PrepareDrag=false;Control.startDragItem=null;Control.DragMode=false};this.saveSelectedItem=function(F){if(!Control.instances.length||Control.DragMode||!Control.enabled){return}var B=this.getItem(F);var E=this.selectedList;var D=Object.keys(E);var C=parseInt(D[D.length-1]);var A=E[C];Control.HandleItem=D.length>0?A:null;if(B.getSelected()){Control.HandleItem=B}return B};this.toggleSelection=function(A){t.toggleItemSelection(A)};p()};Control.DragMode=false;Control.PrepareDrag=false;Control.startDragX=0;Control.startDragY=0;Control.startDragItem=null;Control.DragSensitivity=7;Control.HandleItem=null;Control.DraggableItem=null;Control.instances=[];Control.enabled=true;Control.getInstanceById=function(a){for(var b=0;b<Control.instances.length;b++){if(Control.instances[b].id===a){return Control.instances[b]}}return null};Control.recalcItemsPosition=function(){for(var a=0;a<Control.instances.length;a++){Control.instances[a].recalcItemsPosition()}};Control.detectItemByMousePointer=function(b,h){var g=Control.HandleItem;if(g){var f=jQuery(g.control.initContainer).position();var e=g.position;if(h>e.top+f.top&&h<=e.bottom+f.top&&b>e.left+f.left&&b<=e.right+f.left){return g}}var a=null;for(var d=0;d<Control.instances.length;d++){var c=Control.instances[d];var f=jQuery(c.initContainer).offset();a=c.getItemByPosition(b-f.left,h-f.top);if(a){break}}return a};Control.handleMouseUp=function(c){if(!Control.enabled){return}if(!Control.DragMode&&Control.HandleItem){if(c.altKey){}else{if((c.ctrlKey||c.metaKey)&&(c.button!=2)){}else{if((c.shiftKey)&&(c.button!=2)){}else{var a=c.target;if(c.button===0&&!a.classList.contains("editable")&&!a.classList.contains("cmenuItem")&&!a.classList.contains("catalog-toggle")&&!a.classList.contains("catalog-toggle-wrapper")&&(a.type===undefined||a.type.toLocaleLowerCase()==="checkbox")){if(a.type===undefined){Control.HandleItem.check()}Control.HandleItem.control.toggleItemSelection(Control.HandleItem);if(!Control.HandleItem.getSelected()){var b=Object.keys(Control.HandleItem.control.selectedList);if(b.length>0){Control.HandleItem.control.toggleItemSelection(Control.HandleItem.control.selectedList[b.length-1]);if(Control.HandleItem.control.toolbar){Control.HandleItem.control.toolbar.show(Control.HandleItem)}}else{if(Control.HandleItem.control.toolbar){Control.HandleItem.control.toolbar.hide()}}}else{if(Control.HandleItem.control.toolbar){Control.HandleItem.control.toolbar.show(Control.HandleItem)}}}else{}}}}Control.HandleItem.control.lastClicked=Control.HandleItem}Control.PrepareDrag=false;Control.startDragItem=null;Control.DragMode=false};jQuery(window).bind("resize",function(a){Control.recalcItemsPosition()});function createAddButton(d,f,c,b){d.ControlInstance=f;var a=function(){var h=0;var o=null;var g=false;var k;for(k in f.selectedList){h++;o=k}for(k=0;k<b.length;k++){if((o==null&&b[k]===true)||(o!=null&&(b[k]===f.selectedList[o].baseMethod||b[k]==="*"))){g=true;break}}var n=c.replace(/\{id\}/,(o||"0"));n=n.replace(/\{\$param0\}/,(o||"0"));n=n.replace(/\{\$pre_lang\}/,window.pre_lang);var m=document.getElementById("domainSelect"+f.id);if(m){var l=m.options[m.selectedIndex].text;if(n.indexOf("?")!=-1){n=n+"&domain="+l}else{n=n+"?domain="+l}}d.addLink=n;for(var k=0;k<d.linkCache.length;k++){d.linkCache[k].href=d.addLink;d.linkCache[k]["param0"]=(o||"0")}if(d.tagName.toLowerCase()=="a"){d.href=d.addLink;d.param0=(o||"0")}var j=false;if(h>1||!g){if(d.style.display!="none"){d.style.display="none";j=true}}else{if(d.style.display=="none"){d.style.display="";j=true}}if(j){Control.recalcItemsPosition()}};f.setSelectionCallback(function(h,g){setTimeout(a,100)});var e=c.replace(/\{id\}/,"0");e=e.replace(/\{\$param0\}/,"0");e=e.replace(/\{\$pre_lang\}/,window.pre_lang);d.addLink=e;d.linkCache=d.getElementsByTagName("a");a()}function filterController(k,x,h,L,ac){var s=this;var ae=null;var G=null;var ab=null;var I=null;var aa=null;var aj=null;var T=null;var U=null;var ag=null;var af=null;var j=null;var z=null;var R=x;var Z=null;var l=0;var w=5000;var v={};var W={};var J=k.id+"_fc";var X=null;var ah={};var H=null;var D=true;var n=L;var ad=(ac&&ac.nativeAdvancedMode);var P=-2;var f=function(ao,an,al){if(ao=="name"&&k.disableNameFilter){return false}if(ao=="name"&&!k.disableNameFilter){ao={dataType:"string",fieldName:"name",guideId:1}}if(al&&al[1]==="static"){return}var ap=J+"_id_"+ao.fieldName;if(!ao.dataType){ao.dataType="string"}var am=m(ao.dataType,ap,ao.fieldName,ao.guideId,false);if(am){v[ao.fieldName]=ao;if(am.classList.contains("sel")){W[ao.fieldName]=$(am).find("select")[0]}else{W[ao.fieldName]=am}if(al&&al[0]){am.style.width="100%"}an.appendChild(am);if("boolean,file,img_file,swf_file".indexOf(ao.dataType)>=0){setTimeout(function(){new ControlComboBox({el:$(am.lastChild)})},50)}}};var c=function(al){if(al!="name"){delete v[al.fieldName];delete W[al.fieldName]}};this.control=null;this.getId=function(){return J};this.changeMode=function(){if(D){D=false;ab.style.display="block";G.style.display="none";af.childNodes[0].nodeValue=getLabel("js-filter-normal-mode")}else{D=true;ab.style.display="none";G.style.display="";af.childNodes[0].nodeValue=getLabel("js-filter-extended-mode")}Control.recalcItemsPosition()};var a=function(am){var al=(window.event)?event.keyCode:am.keyCode;if(al==13){s.applyFilter()}};var ai=function(am){var al=(window.event)?event.keyCode:am.keyCode;if(al==13){if(ad){_self.applyFilter()}else{s.applyFilterAdvanced()}}};var t=function(al){if(!ad){s.applyFilterAdvanced()}};this.applyFilterAdvanced=function(){if(l>0){return}var an=new filter();for(var al in W){if(!W.hasOwnProperty(al)){continue}if(W[al].tagName.toLowerCase()=="select"){var at=W[al].options[W[al].selectedIndex].value;if(at!=P){an.setPropertyEqual(al,at)}}else{switch(W[al].type){case"button":break;case"checkbox":an.setPropertyEqual(al,W[al].checked?1:0);break;case"text":var aq=v[al].dataType;switch(aq){case"tags":var au=W[al].value;if(au==""){break}au=au.split(",");for(var ao=0;ao<au.length;ao++){au[ao]=au[ao].replace(/^\s+|\s+$/,"")}if(au.length){an.setPropertyLike(al,au)}break;case"float":case"price":case"counter":case"int":var at=W[al].value.replace(/^\s+|\s+$/,"");if(!at.length){break}if(at[0]=="<"){an.setPropertyLess(al,at.replace(/[^\d.]*/,""))}else{if(at[0]==">"){an.setPropertyGreater(al,at.replace(/[^\d.]*/,""))}else{at=at.split("-");if(at.length>1){an.setPropertyBetween(al,at[0].replace(/[^\d.]*/,""),at[1].replace(/[^\d.]*/,""))}else{an.setPropertyEqual(al,at[0].replace(/[^\d.]*/,""))}}}break;case"date":var am=[];var at=W[al].value;if(W[al].isEmpty!=undefined&&W[al].isEmpty==true){break}if(at.length>0){var ap=-1;var ar=at.indexOf("-");if((ap=at.indexOf("<"))!=-1){an.setPropertyLess(al,(ar!=-1)?at.substring(ap+1,ar-1):at.substring(ap+1))}else{if((ap=at.indexOf(">"))!=-1){an.setPropertyGreater(al,(ar!=-1)?at.substring(ap+1,ar-1):at.substring(ap+1))}else{if(ar!=-1){am=at.split(/\s-\s/)}if(am.length==2){an.setPropertyBetween(al,am[0],am[1])}else{an.setPropertyEqual(al,at)}}}}break;case"relation":if(W[al].value!=undefined&&W[al].value.length){an.setPropertyEqual(al,W[al].value)}break;default:if(W[al].value!=undefined&&W[al].value.length){an.setPropertyLike(al,W[al].value)}}break;default:if(W[al].value!=undefined&&W[al].value.length){an.setPropertyEqual(al,W[al].value)}}}}an.setConditionModeOr(false);Z.applyFilter(an)};this.applyFilter=function(){var am=new filter();if(D){var au=ae.value.replace(/^\s*|\s*$/,"");if(au.length==0){if(!(Z.flatMode||Z.objectTypesMode||Z.defaultRootMode)){am.setParentElements(0)}}else{if(/^".*"$|^'.*'$/.test(au)){au=au.substr(1,au.length-2)}else{au=au.split(" ")}am.setAllTextSearch(au)}am.setConditionModeOr(true)}else{var ap=ab.getElementsByTagName("input");for(var ao=0;ao<ap.length;ao++){if(ap[ao].id!=undefined&&v["row_"+ap[ao].id]==undefined){continue}switch(ap[ao].type){case"button":break;case"checkbox":am.setPropertyEqual(ap[ao].name,ap[ao].checked?1:0);break;case"text":var ar=v["row_"+ap[ao].id].field.getElementsByTagName("type")[0].getAttribute("data-type");switch(ar){case"tags":var av=ap[ao].value.split(",");for(var an=0;an<av.length;an++){av[an]=av[an].replace(/^\s+|\s+$/,"")}am.setPropertyEqual(ap[ao].name,av);break;case"float":case"price":case"int":var au=ap[ao].value.replace(/^\s+|\s+$/,"");if(au[0]=="<"){am.setPropertyLess(ap[ao].name,au.replace(/[^\d.]*/,""))}else{if(au[0]==">"){am.setPropertyGreater(ap[ao].name,au.replace(/[^\d.]*/,""))}else{au=au.split("-");if(au.length>1){am.setPropertyBetween(ap[ao].name,au[0].replace(/[^\d.]*/,""),au[1].replace(/[^\d.]*/,""))}else{am.setPropertyEqual(ap[ao].name,au[0].replace(/[^\d.]*/,""))}}}break;case"date":var al=[];var au=ap[ao].value;if(ap[ao].isEmpty!=undefined&&ap[ao].isEmpty==true){break}if(au.length>0){var aq=-1;var at=au.indexOf("-");if((aq=au.indexOf("<"))!=-1){am.setPropertyLess(ap[ao].name,(at!=-1)?au.substring(aq+1,at-1):au.substring(aq+1))}else{if((aq=au.indexOf(">"))!=-1){am.setPropertyGreater(ap[ao].name,(at!=-1)?au.substring(aq+1,at-1):au.substring(aq+1))}else{if(at!=-1){al=au.split(/\s-\s/)}if(al.length==2){am.setPropertyBetween(ap[ao].name,al[0],al[1])}else{am.setPropertyEqual(ap[ao].name,au)}}}}break;case"relation":am.setPropertyLike(ap[ao].name,ap[ao].value);break;default:am.setPropertyLike(ap[ao].name,ap[ao].value)}break;default:am.setPropertyEqual(ap[ao].name,ap[ao].value)}}ap=ab.getElementsByTagName("select");var av=null;for(var ao=0;ao<ap.length;ao++){if(ap[ao].id=="select_"+J){continue}av=[];for(var an=0;an<ap[ao].options.length;an++){if(ap[ao].options[an].selected){av.push(ap[ao].options[an].value)}}am.setPropertyEqual(ap[ao].name,av)}if(ad){am.setConditionModeOr(!aa.checked)}else{am.setConditionModeOr(true)}}Z.applyFilter(am)};var d=function(al){return function(){var an=document.getElementById(al);if(an){an.parentNode.removeChild(an);v[al].used=false;ag.clearOptions();var ap=[];var ao=0;for(var am in v){if(v[am].used){ap.push(v[am].field.getAttribute("id"));ao++}else{ag.addOption({text:v[am].field.getAttribute("title"),value:am})}}SettingsStore.getInstance().set(J,ap.join(","),H?""+H:"default");if(ao>1){I.style.display=""}else{I.style.display="none"}}Control.recalcItemsPosition()}};var A=function(){if(!U.options.length){return}var ao=ag.getValue();if(ao===""){return}var an=M(v[ao].field);if(an){v[ao].used=true;ab.getElementsByTagName("table")[0].tBodies[1].appendChild(an);ag.clear();ag.removeOption(ao);var am=[];for(var al in v){if(v[al].used){am.push(v[al].field.getAttribute("id"))}}SettingsStore.getInstance().set(J,am.join(","),H?""+H:"default");if(am.length>1){I.style.display=""}else{I.style.display="none"}Control.recalcItemsPosition()}};var o=function(al,an){var am=al;var ap={x:am.offsetLeft||0,y:am.offsetTop||0};while(am=am.offsetParent){ap.x+=am.offsetLeft;ap.y+=am.offsetTop}ap.x+=al.offsetWidth;ap.y+=al.offsetHeight;var aq="tip_"+J+Math.random();var ao=document.createElement("div");ao.id=aq;ao.className="fcTip";ao.style.zIndex=50;ao.style.position="absolute";ao.style.left=ap.x+"px";ao.style.top=ap.y+"px";ao.appendChild(document.createTextNode(an));document.body.appendChild(ao);setTimeout(function(){ao.parentNode.removeChild(ao)},w)};var S=function(al,am){var an=null;var ao="";switch(am){case"int":an=new RegExp("^[<>]?[ ]?\\d*( ?- ?\\d*)?$");ao=getLabel("js-filter-enter-natural-number");break;case"float":an=new RegExp("^[<>]?[ ]?\\d*[\\.]*\\d*( ?- ?\\d*[\\.]*\\d*)?$");ao=getLabel("js-filter-enter-float-number");break;case"date":an=/(^[<>]{1}.*)|(^(((\d\d?[.]\d\d?([.]\d\d(\d\d)?)?)?((\s+|^\s*)\d\d?:\d\d)?)|позавчера|вчера|сегодня|завтра|послезавтра)?(\s*-\s*(((\d\d?[.]\d\d?([.]\d\d(\d\d)?)?)?(\s+\d\d?:\d\d)?)|позавчера|вчера|сегодня|завтра|послезавтра))?)$/i;break}var ap=function(){if(al){var aq=al.classList.contains("_error");if(!an.test(al.value)){if(!aq){al.classList.add("_error");l++}}else{if(aq){al.classList.remove("_error");l--}}}};return ap};var ak=function(al){V("/udata://core/getDomainsList/",function(am){var ao=am.responseXML.getElementsByTagName("domain");F(al,P,getLabel("js-smc-no-filter"));for(var an=0;an<ao.length;an++){F(al,ao[an].getAttribute("id"),ao[an].getAttribute("host"))}new ControlComboBox({el:$(al)})})};var F=function(al,ao,am){var an=document.createElement("option");an.value=ao;an.appendChild(document.createTextNode(am));al.appendChild(an)};var u=function(aq,ap){if(ah[ap]==undefined){var au=function(aw){if(!aw.responseXML.getElementsByTagName("empty").length){var ay=aw.responseXML.getElementsByTagName("object");var av=[];if(!ad){av.push({id:P,value:getLabel("js-smc-no-filter")})}for(var ax=0;ax<ay.length;ax++){av.push({id:ay[ax].getAttribute("id"),value:ay[ax].getAttribute("name")})}ah[ap]=av}else{ah[ap]="empty"}u(aq,ap)};var al="/admin/data/guide_items_all/"+ap+".xml?allow-empty";V(al,au);return}if(ah[ap]!=="empty"){for(var ao in ah[ap]){F(aq,ah[ap][ao].id,ah[ap][ao].value)}new ControlComboBox({el:$(aq)})}else{var am=aq.name;var an=aq.id;var ar=m("string",an,am,ap,false);var at=aq.parentNode;at.removeChild(aq);at.appendChild(ar);if(W[am]){W[am]=ar}}};var q=function(am,an,ao){if(typeof(am[an])=="function"){var al=am[an];am[an]=function(ap){al(ap);ao(ap)}}else{am[an]=ao}};var g=function(an){var al=document.createElement("input");if(an instanceof Object){for(var am in an){if(!an.hasOwnProperty(am)){continue}al.setAttribute(am,an[am])}}if(an["class"]!="fcLogicInput"){al.classList.add("default")}return al};var e=function(am,ao){var aq=document.createElement("div");aq.className="filter sel";var al=document.createElement("select");if(typeof ao==="object"&&Object.prototype.toString.call(ao)==="[object Array]"){for(var ap in ao){F(al,ao[ap][1],ao[ap][0])}}if(typeof am==="object"){for(var an in am){if(!am.hasOwnProperty(an)){continue}if(an!="multiple"||(an="multiple"&&!am[an])){al.setAttribute(an,am[an])}}}aq.appendChild(al);return aq};var m=function(aq,aw,an,ap,ar){var au=null;switch(aq){case"string":case"wysiwyg":case"text":case"password":case"tags":case"color":case"link_to_object_type":au=g({type:"text","class":"fcStringInput",name:an,id:aw});break;case"date":au=g({type:"text","class":"fcStringInput",name:an,id:aw});au.setAttribute("placeholder",getLabel("js-filter-date-format"));au.onkeyup=S(au,"date");break;case"boolean":var al="0";case"file":case"img_file":case"swf_file":var ao=al||"-1";if(!ad){var av=(aq=="boolean")?getLabel("js-value-yes"):getLabel("js-value-file-yes");var am=getLabel("js-value-no");au=e({name:an,id:aw,multiple:false},[[getLabel("js-smc-no-filter"),P],[av,"1"],[am,"0"]])}else{au=document.createElement("div");au.className="checkbox";au.appendChild(g({type:"checkbox","class":"fcBooleanInput",name:an,id:aw}));au.onclick=function(){$(this).toggleClass("checked")}}break;case"int":case"counter":au=g({type:"text","class":"fcStringInput",name:an,id:aw});au.onkeyup=S(au,"int");break;case"float":case"price":au=g({type:"text","class":"fcStringInput",name:an,id:aw});au.onkeyup=S(au,"float");break;case"relation":au=e({name:an,id:aw,multiple:(ar!=undefined&&ar==false)});u(au.lastChild,ap);break;case"domain_id":au=e({name:an,id:aw,multiple:false});ak(au.lastChild);case"domain_id_list":au=e({name:an,id:aw,multiple:true});ak(au.lastChild)}if(au){if(au.classList.contains("checkbox")){q(au.firstChild,"onkeyup",ai)}else{if(au.classList.contains("sel")){var at=au.lastChild;if(at){at.onchange=t}}else{q(au,"onkeyup",ai)}}}return au};var M=function(ar){var aq=ar.getElementsByTagName("type")[0];var au=null;var al=ar.getAttribute("name");var an=J+"_id_"+al;var ao="row_"+an;au=m(aq.getAttribute("data-type"),an,al,ar.getAttribute("guide-id"));if(au==null){return null}var ax=document.createElement("tr");var av=document.createElement("td");var ap=document.createElement("td");var am=document.createElement("td");var at=document.createElement("label");at.setAttribute("for",an);at.appendChild(document.createTextNode(ar.getAttribute("title")));av.className="fcTitleCell";av.appendChild(at);ap.className="fcValueCell";ap.appendChild(au);var aw=document.createElement("i");aw.className="small-ico i-remove";aw.alt=getLabel("js-filter-remove-field");aw.title=getLabel("js-filter-remove-field");aw.onclick=d(ao);am.className="fcDeleteCell";am.appendChild(aw);ax.id=ao;ax.appendChild(av);ax.appendChild(ap);ax.appendChild(am);return ax};var b=function(){if(!ad){return}while(T.tBodies[1].childNodes.length){T.tBodies[1].removeChild(T.tBodies[1].firstChild)}ag.clear(true);ag.clearOptions();var an=0;ag.lock();for(var al in v){if(v[al].used){var am=M(v[al].field);if(am){T.tBodies[1].appendChild(am);an++}}else{ag.addOption({text:v[al].field.getAttribute("title"),value:al})}}U.disabled=false;ag.unlock();if(I){if(an>1){I.style.display=""}else{I.style.display="none"}}Control.recalcItemsPosition()};var p=function(au){if(ad){var aC=document.createElement("div");af=document.createElement("a");af.href="javascript:filterController.getInstanceById('"+J+"').changeMode();";aC.className="fcModeContainer";aC.appendChild(af);af.appendChild(document.createTextNode(getLabel("js-filter-extended-mode")))}G=document.createElement("div");G.className="input-search";ae=g({type:"text","class":"default",name:"quicksearch",id:J+"_id_quicksearch"});var aF=g({type:"button"});ae.className="default";aF.className="fcApplyButton";aF.onclick=s.applyFilter;$(window).keydown(function(aJ){if(aJ.keyCode==13&&$(ae).is(":focus")){aJ.preventDefault();s.applyFilter()}});G.appendChild(ae);G.appendChild(aF);if(ad){ab=document.createElement("div");T=document.createElement("table");T.className="fcTable";T.appendChild(document.createElement("tbody"));T.appendChild(document.createElement("tbody"));T.appendChild(document.createElement("tbody"));var an=document.createElement("tr");var aD=document.createElement("td");var aH=document.createElement("td");var aB=document.createElement("td");var az=document.createElement("i");U=document.createElement("select");U.className="fcAddSelect default newselect";U.id="select_"+J;U.style.width="100%";az.className="small-ico i-add";az.alt=getLabel("js-filter-add-field");az.title=getLabel("js-filter-add-field");az.onclick=A;aH.className="fcFreeFieldsCell";aB.className="fcAddCell";aD.appendChild(document.createTextNode(getLabel("js-filter-fields-list")));aH.colSpan=1;aH.width="250px";aH.appendChild(U);aB.appendChild(az);an.appendChild(aD);an.appendChild(aH);an.appendChild(aB);T.tBodies[0].appendChild(an);var at=document.createElement("tr");var aI=document.createElement("td");aI.colSpan=3;aI.innerHTML="&nbsp;";at.appendChild(aI);T.tBodies[0].appendChild(at);an.className="fcAddRow";var am=document.createElement("tr");var av=document.createElement("td");av.colSpan=3;av.className="fcLogicCell";I=document.createElement("div");aa=g({type:"radio","class":"fcLogicInput",value:"and",name:J+"_logic",id:J+"_logic_and",checked:true,selected:true});aj=g({type:"radio","class":"fcLogicInput",value:"or",name:J+"_logic",id:J+"_logic_or"});var ay=document.createElement("span");var aE=document.createElement("label");var ax=document.createElement("label");var aw=document.createElement("span");var aq=document.createElement("span");ay.className="fcLogicTitle";ay.appendChild(document.createTextNode(getLabel("js-filter-search-matches")));I.appendChild(ay);aa.style.border="0";aj.style.border="0";aE.className="fcLogicLabel";aE.htmlFor=J+"_logic_and";aw.className="fcLogicLine";aE.appendChild(document.createTextNode(getLabel("js-filter-with-all-fields")));aw.appendChild(aE);aw.appendChild(aa);I.appendChild(aw);aq.className="fcLogicLine";ax.className="fcLogicLabel";ax.htmlFor=J+"_logic_or";ax.appendChild(document.createTextNode(getLabel("js-filter-one-at-least")));aq.appendChild(ax);aq.appendChild(aj);I.appendChild(aq);av.appendChild(I);am.appendChild(av);T.tBodies[2].appendChild(am);var ar=document.createElement("tr");var al=document.createElement("td");applyButton=g({type:"button",value:getLabel("js-filter-do")});applyButton.onclick=s.applyFilter;applyButton.className="fcApplyButton btn color-blue pull-right";al.colSpan=3;al.className="fcApplyCell";al.appendChild(applyButton);ar.appendChild(al);T.tBodies[2].appendChild(ar);ab.className="fcContainer";ab.style.display="none";ab.appendChild(T)}var aG=document.createElement("div");var aA=document.createElement("span");z=document.createElement("span");aA.appendChild(document.createTextNode(getLabel("js-filter-current-rubrics")));aG.appendChild(aA);aG.appendChild(z);aG.className="fcTargetContainer";K();var ap=document.createElement("div");ap.style.clear="both";ap.innerHTML="&nbsp;";if(n){n.appendChild(G);if(ad){n.appendChild(aC);n.appendChild(ab)}n.appendChild(aG)}else{n=document.createElement("div");n.className="filter-container";n.appendChild(G);if(ad){n.appendChild(aC);n.appendChild(ab)}n.appendChild(aG);var ao=document.getElementById("filterWrapper_"+k.uid);if(ao==null){Z.container.parentNode.insertBefore(n,Z.container)}else{ao.appendChild(n)}}ag=$(U).selectize({allowEmptyOption:true,create:false,hideSelected:true,onDropdownOpen:function(aJ){B(aJ)},onDropdownClose:function(aJ){r(aJ)}});if(ag[0]!=undefined){ag=ag[0].selectize}if(ad){aa.checked=true;b()}};var B=function(am){var al=$(am).closest(".overflow-block");al.css("overflow","visible");$(am).closest(".table-cell > div").css("overflow","visible")};var r=function(am){var al=$(am).closest(".overflow-block");al.css("overflow","auto");$(am).closest(".table-cell > div").css("overflow","hidden")};var O=function(){if(window.XMLHttpRequest){try{return new XMLHttpRequest()}catch(al){}}else{if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(al){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(al){}}}return null};var V=function(an,al){var am=O();am.onreadystatechange=function(){if(am.readyState!=4){return}if(am.status==200){al(am)}else{N("Request failed")}};am.open("GET",an,true);am.send(null)};this.init=function(){if(ad){var al=function(ao){var an=ao.responseXML.getElementsByTagName("field");y(an);p(ao.responseXML)};var am=Z.dataSet.getCommonTypeId();if(am>0){R=am}if(R){sUrl="/utype/"+R+"/"}else{sUrl="/utype/dominant/"+R+"/"}V(sUrl,al)}else{p(null)}};var y=function(ao){var av=ao;var aA=["symlink"];var ax=null;var aq=false;var aw=SettingsStore.getInstance().get(J,(H)?""+H:"default");var ay=(aw===false)?[]:aw.split(",");var az=false;var an=Z.dataSet.getFieldsStoplist();for(var au=0;au<av.length;au++){var al=av[au].getAttribute("name");aq=false;ax=av[au].getElementsByTagName("type")[0].getAttribute("data-type");for(var at=0;at<an.length;at++){if(al==an[at]){aq=true;break}}for(var at=0;at<aA.length&&!aq;at++){if(ax==aA[at]){aq=true;break}}if(!aq){var am="row_"+J+"_id_"+av[au].getAttribute("name");var ap=av[au].getAttribute("id");az=false;for(var ar=0;ar<ay.length;ar++){if(ap==ay[ar]){az=true;break}}v[am]={used:az,field:av[au]}}}};var N=function(al){};var E=false;var C=function(){var al=this.id.substr((J+"_link_").length);delete Z.targetsList[al];Y({});return false};var Q=function(am,an){var al=document.createElement("a");al.className="fcTarget";al.id=J+"_link_"+am;al.href="#";al.title=getLabel("js-filter-delete-category");al.onclick=C;al.appendChild(document.createTextNode(an));if(z.childNodes.length){z.appendChild(document.createTextNode(", "))}z.appendChild(al)};var K=function(){z.parentNode.style.display="none"};var Y=function(am){var ao=false;var ap=null;var al=0;while(z.firstChild){z.removeChild(z.firstChild)}for(var an in Z.targetsList){al++;ap=Z.targetsList[an].id;Q(Z.targetsList[an].id,Z.targetsList[an].name)}if(!al){K()}else{z.parentNode.style.display=""}if(ad){if(al==1){sUrl="/utype/dominant/"+ap+"/";ao=true;H=ap}else{sUrl="/utype/"+R+"/";ao=false;H=null}if(E!=ao){v={};U.disabled=true;V(sUrl,function(ar){if(ar.responseXML){var aq=ar.responseXML.getElementsByTagName("field");if(aq.length){y(aq)}b()}});E=ao}}};if(!(k==undefined||x==undefined)){filterController.instances[filterController.instances.length]=this;Z=k;this.control=Z;R=!x?0:x;X=Z.iconsPath;if(!ad){Z.onDrawFieldFilter=f;Z.onRemoveColumn=c}Z.setTargetSelectCallback(Y);if(h==undefined||h==false){this.init()}else{Z.dataSet.addEventHandler("onInitComplete",this.init)}}}filterController.instances=[];filterController.getInstanceById=function(a){for(var b=0;b<filterController.instances.length;b++){if(filterController.instances[b].getId()===a){return filterController.instances[b]}}return null};function TemplatesDataSet(){var c=null,a=null,f=null;var b=function(){if(window.XMLHttpRequest){try{return new XMLHttpRequest()}catch(j){}}else{if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(j){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(j){}}}return null};var e=function(){var j="/admin/content/domainTemplates.xml";var l=b();var k=function(){if(l.readyState!=4){return}if(l.status==200){d(l)}else{return false}};l.onreadystatechange=k;l.open("GET",j,true);l.send(null)};var d=function(j){var k=j.responseXML;c=h(k.getElementsByTagName("template"));a=h(k.getElementsByTagName("domain"));f=h(k.getElementsByTagName("lang"))};var g=function(m){var k=[];k.nodeValue=(m.textContent||m.text);for(var l=0;l<m.attributes.length;l++){var j=m.attributes.item(l);k[j.nodeName]=j.nodeValue}return k};var h=function(n){var j=[];for(var k=0;k<n.length;k++){var l=n[k];var m=g(l);j.push(m)}return j};this.getLangsList=function(){return f};this.getDomainsList=function(){return a};this.getTemplatesList=function(m,n){if(!m&&!n){return c}var j=[];for(var k=0;k<c.length;k++){var l=c[k];if(l["domain-id"]==m&&l["lang-id"]==n){j.push(l)}}return j};e()}TemplatesDataSet.instance=null;TemplatesDataSet.getInstance=function(){if(!TemplatesDataSet.instance){TemplatesDataSet.instance=new TemplatesDataSet}return TemplatesDataSet.instance};function dataSet(a,c,d,n){var u=a;var z=(d!=undefined)?d:"";var k="";var m=null;var L=[];var J=false;var g=false;var s=[];var b=[];var j=0;var D=[];var F="";var I=[];var H=0;var o=[];var v=[];var E=[];var p=[];var l=[];var y=[];var r=[];var A=[];var e=[];var n=(typeof(n)==="object")?n:{};var C=Array.isArray(n.onInitEndRequests)?n.onInitEndRequests:[];this.init=function(){if(g){return true}g=true;var N=function(Q){if(Q.responseXML){b=Q.responseXML.getElementsByTagName("group")}J=true;if(!h("onInitComplete")){return false}};var M=function(aa){var ac=aa.responseXML.getElementsByTagName("method");for(var Y=0;Y<ac.length;Y++){var T=ac[Y];if(T.getAttribute("forload")=="true"){k=T.childNodes[0].nodeValue;continue}var S={};for(var X=0;X<T.attributes.length;X++){var Q=T.attributes[X];if(Q.nodeName=="aliases"){continue}S[Q.nodeName]=Q.nodeValue}S.name=T.childNodes[0].nodeValue;var Z=T.getAttribute("aliases");if(Z){S.aliases=Z.split(",");for(var W=0;W<S.aliases.length;W++){S.aliases[W]=S.aliases[W].replace(/^\s+|\s+$/,"")}}else{S.aliases=[]}s.push(S)}var U=aa.responseXML.getElementsByTagName("exclude");if(U.length){for(var Y=0;Y<U.length;Y++){if(U[Y].childNodes.length){D.push(U[Y].childNodes[0].nodeValue)}}}var ad=aa.responseXML.getElementsByTagName("default");if(ad.length&&ad[0].childNodes.length){F=ad[0].childNodes[0].nodeValue}var V=aa.responseXML.getElementsByTagName("type");if(V.length){for(var Y=0;Y<V.length;Y++){if(!V[Y].getAttribute("common")){continue}var ab=V[Y].getAttribute("common").toLowerCase();if(ab=="1"||ab=="true"){j=V[Y].getAttribute("id");var R="/utype/"+j+"/";x(R,N);break}else{if(ab=="custom"){j=V[Y].getAttribute("id");var R=j;x(R,N)}}}}else{J=true;if(!h("onInitComplete")){return false}}};var P=function(S){var R=null;for(var Q=0;Q<S.length;Q++){R=S[Q];if(typeof(R.url)==="string"&&typeof(R.callback)==="function"){x(R.url,R.callback)}}};var O="/admin/"+u+"/dataset_config.xml"+(z.length?("?param="+z):"");x(O,M);P(C);return g};this.load=function(O){if(!J){return false}if(!h("onBeforeLoad")){return false}var M=function(Q){var P={};var R=G(Q.responseXML,false,P);if(R.length==0){$(".overflow #nodata").show()}else{$(".overflow #nodata").hide()}var S={objects:R,filter:O,paging:P};if((typeof(R)=="string")||(R===null)){S.error=R}J=true;if(!h("onAfterLoad",S)){return false}};var N="/admin/"+u+"/"+k+".xml"+K(O,true);x(N,M)};this.getPathModuleMethod=function(){return"/admin/"+u+"/"+k};this.refresh=function(S){if(!J){return false}if(!h("onBeforeRefresh")){return false}if(L.length){var R="/admin/"+u+"/"+k+".xml";var N=0;var M=function(V,Y){var U={};var W=G(V.responseXML,false,U);var X={objects:W,filter:Y,paging:U};if((typeof(W)=="string")||(W===null)){X.error=W}h("onAfterPieceLoad",X);N++;if(N>=L.length){J=true;if(!h("onAfterRefresh",{objects:I})){return false}}else{x(R+K(L[N]),M,L[N])}};J=false;x(R+K(L[N]),M,L[N])}else{var P=function(V,Y){var U={};var W=G(V.responseXML,false,U);var X={objects:W,filter:new filter(),paging:U};if((typeof(W)=="string")||(W===null)){X.error=W}J=true;h("onAfterPieceLoad",X);h("onAfterRefresh",{objects:I})};var T=[];var O="";if(S==undefined||S==false){O="id"}else{O="rel"}for(var Q=0;Q<I.length;Q++){T.push(I[Q][O])}J=false;var R="/admin/"+u+"/"+k+".xml?"+O+"="+T.join(",");I=[];x(R,P)}};this.isMethodSupported=function(P,R){var N=P.toUpperCase();var M=(R!=undefined&&R==true)?true:false;for(var Q in s){if(typeof(s[Q])==="function"){continue}if(s[Q].name.toUpperCase()==N){return M?s[Q].name:true}for(var O=0;O<s[Q].aliases.length;O++){if(s[Q].aliases[O].toUpperCase()==N){return M?s[Q].name:true}}}return false};this.getMethodsList=function(){return s};this.getCommonFields=function(){return b};this.getDefaultFields=function(){return F};this.getFieldsStoplist=function(){return D};this.getCommonTypeId=function(){return j};this.execute=function(U,O){if(!J){return false}var V=this.isMethodSupported(U,true);if(!V){return false}var S={method:U,params:O,objects:[]};if(!h("onBeforeExecute",S)){return false}var T=function(X){Control.enabled=true;var W={};var Y=G(X.responseXML,true,W);q(Y);S.objects=Y;S.paging=W;if((typeof(Y)=="string")||(Y===null)){S.error=Y}if(Y.error){S.error=Y.error}S.HandleItem=jQuery.extend(true,{},Control.HandleItem);J=true;if(!h("onAfterExecute",S)){return false}};var R=w(V);var M=window.pre_lang+"/admin/"+R+"/"+V+".xml";var P=new Array("csrf="+csrfProtection.getToken());for(var N in O){if(O[N] instanceof Array){for(var Q=0;Q<O[N].length;Q++){P.push(N+"[]="+O[N][Q])}}else{P.push(N+"="+O[N])}}J=false;M=M+"?"+P.join("&");x(M,T)};this.getLoadedTree=function(){return I};this.isAvailable=function(){return J};this.clearFiltersCache=function(){L=[]};this.setDefaultFilter=function(M){m=M};this.getDefaultFilter=function(){return m};this.addEventHandler=function(O,M){var N=B(O);if(N===null){return false}N[N.length]={active:true,handler:M};return N.length-1};this.removeEventHandler=function(O,M){var N=B(O);if(N===null){return false}N[M].active=false};var w=function(N){var M=N.toUpperCase();for(var O=0;O<s.length;O++){if(s[O].name.toUpperCase()==M&&s[O].module){return s[O].module}}return u};var h=function(P,Q){if(!g){return false}var N=true;var M=B(P);if(M===null){return false}for(var O in M){if(M[O].active){N=N&&(M[O].handler(Q)!==false)}}return N};var B=function(N){var M=null;switch(N.toUpperCase()){case"ONINITCOMPLETE":return o;case"ONBEFORELOAD":return v;case"ONAFTERLOAD":return E;case"ONBEFOREEXECUTE":return p;case"ONAFTEREXECUTE":return l;case"ONBEFOREREFRESH":return y;case"ONAFTERREFRESH":return r;case"ONAFTERPIECELOAD":return A;case"ONREQUESTFAILED":return e;default:return null}};var t=function(){if(window.XMLHttpRequest){try{return new XMLHttpRequest()}catch(M){}}else{if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(M){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(M){}}}return null};var x=function(O,M,P){var N=t();N.onreadystatechange=function(){if(N.readyState!=4){return}H++;if(N.status==200){M(N,P)}else{h("onRequestFailed")}};N.open("GET",O,true);N.send(null)};var K=function(P,M){var Q="";if(P instanceof Object){if(!m.Full){P.setViewMode(false)}Q=P.getQueryString(m);if(M!=undefined&&M===true){L.push(P)}}else{if(P instanceof Object){var O=[];if(P.id!=undefined){var N;if(P.id instanceof Array){N=P.id}else{N=[];N.push(P.id)}O.push("id="+N.join(","))}if(P.rel!=undefined){var N;if(P.rel instanceof Array){N=P.rel}else{N=[];N.push(P.rel)}O.push("rel="+N.join(","))}if(O.length){Q="?"+O.join("&");if(M!=undefined&&M===true){L.push(P)}}}}return Q+"&r="+Math.random()};var G=function(W,P,N){var U=[];var O=W.getElementsByTagName("data");if(!O.length){return U}else{O=O[0]}var V=O.childNodes;for(var S=0;S<V.length;S++){var T=V[S];if(T.nodeName=="error"){return{error:T}}if(T.nodeName!="page"&&T.nodeName!="object"&&T.nodeName!="type"&&T.nodeName!="response"){continue}var Q={};for(var R=0;R<T.attributes.length;R++){var M=T.attributes[R];Q[M.nodeName]=M.nodeValue}f(Q,T.childNodes);U.push(Q);if(P==undefined||P===false){I.push(Q)}}if(N!=undefined&&(N instanceof Object)){N.total=parseInt(O.getAttribute("total"))||U.length;N.offset=parseInt(O.getAttribute("offset"))||0;N.limit=parseInt(O.getAttribute("limit"))||U.length}return U};var f=function(S,R){if(R.length==1&&R[0].nodeType==3){S._value=R[0].nodeValue;return}for(var Q=0;Q<R.length;Q++){var O=R[Q];var T={};if(O.nodeType!=1){T=O.nodeValue}else{if(!O.attributes.length&&O.childNodes.length==1&&O.childNodes[0].nodeType==3){T=O.childNodes[0].nodeValue}else{for(var N=0;N<O.attributes.length;N++){var P=O.attributes[N];T[P.nodeName]=P.nodeValue}f(T,O.childNodes)}}if(S[O.nodeName]==undefined){S[O.nodeName]=T}else{if(S[O.nodeName] instanceof Array){S[O.nodeName].push(T)}else{var M=[];M.push(S[O.nodeName]);M.push(T);S[O.nodeName]=M}}}};var q=function(N){if(!(N instanceof Array)){return}for(var O=0;O<N.length;O++){for(var M=0;M<I.length;M++){if(N[O].id==I[M].id){for(var P in N[O]){I[M][P]=N[O][P]}break}}}};if((typeof(c)=="undefined")||(c==false)){this.init()}}SettingsStore.instance=null;SettingsStore.getInstance=function(){if(!SettingsStore.instance){SettingsStore.instance=new SettingsStore()}return SettingsStore.instance};function SettingsStore(){var j=window.settingsStoreData||{};var h=this;var a=[];this.loaded=window.settingsStoreData?true:false;this.get=function(k,l){l=d(l);if(j[k]){return(j[k][l])?j[k][l]:false}else{return false}};this.set=function(n,p,q){if(!n){return false}q=d(q);var o="/admin/users/saveUserSettings/?key="+n+"&value="+p;if(q){for(var m=0;m<q.length;m++){o+="&tags[]="+q[m]}}else{q={}}var l=function(r){};g(o,l);for(var m=0;m<q.length;m++){var k=q[m];if(!j[n]){j[n]={}}if(p){j[n][k]=p}else{j[n][k]=undefined}}};this.list=function(p){p=d(p);var l=[];for(key in j){var n=j[key];var q=false;for(var o in p){var k=p[o];for(var m in n){if(m==k){q=n[m]}}}if(q){l[key]=q}}return l};this.callback=function(k){if(typeof k=="function"){callback=k}return this};this.load=function(){if(this.loaded){return true}setTimeout(function(){var l="/udata/users/loadUserSettings/?r="+Math.random();var k=function(m){h.loaded=true;f(m.responseXML);e("onLoadComplete")};g(l,k)},50)};this.addEventHandler=function(m,k){var l=c(m);if(l===null){return false}l[l.length]={active:true,handler:k};if(this.loaded&&m.toUpperCase()=="ONLOADCOMPLETE"){k()}return l.length-1};var e=function(m,n){var k=c(m);if(k===null){return false}for(var l in k){if(k[l].active){k[l].handler(n)}}};var c=function(l){var k=null;switch(l.toUpperCase()){case"ONLOADCOMPLETE":return a;default:return null}};var d=function(k){var l=typeof k;if(l=="object"){if(k.length>0){return k}else{k.push("common");return k}}else{if(l=="string"){return new Array(k)}else{if(l=="undefined"){return new Array("common")}else{return false}}}};var b=function(){if(window.XMLHttpRequest){try{return new XMLHttpRequest()}catch(k){}}else{if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(k){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(k){}}}return null};var g=function(m,k){var l=b();l.onreadystatechange=function(){if(l.readyState!=4){return}if(l.status==200){k(l)}else{e("onRequestFailed")}};l.open("GET",m,false);l.send(null)};var f=function(o){var m=o.getElementsByTagName("item");for(var n=0;n<m.length;n++){var r=m[n];var s=r.getAttribute("key");j[s]={};var p=r.childNodes;var q="",t="";for(var l=0;l<p.length;l++){var k=p[l];if(k.nodeName=="value"){q=k.firstChild.nodeValue;t=k.getAttribute("tag");j[s][t]=q;continue}}}};if(this.loaded){e("onLoadComplete")}}jQuery(document).ready(function(){SettingsStore.getInstance().load()});var editableCell=function(H,B,u,K){var J=27;var n=13;var h=this;var L=u;var o=u.fieldName||u.name;var A=H;var y=(A.control.contentType!=="pages");var d;var C="";var z="";this.isActive=false;this.element=B;(function e(){if(!O()){return}$(K).on("click",N);h.isActive=true;function O(){if(!editableCell.enableEdit){return false}if(_.contains(editableCell.ignoreDataTypes,u.dataType)){return false}if(_.contains(editableCell.ignorePropNames,o)){return false}return true}function N(){if(editableCell.activeCell){return}h.makeEditable()}})();this.prepareSaveData=function(N){if(d){h.save(d.val(),false,N)}};this.makeEditable=function(){editableCell.activeCell=h;t()};var t=function(){$.ajax({url:j("get"),type:"GET",dataType:"xml",success:l,error:function(P,N,O){q(O,"get")}})};var q=function(N,O){D(getLabel("js-edcell-"+O+"-error")+N)};var D=function(N){editableCell.activeCell=false;$.jGrowl(N,{header:getLabel("js-error-header")})};var j=function(O){var N=window.pre_lang+"/admin/content/"+O+"_editable_region/"+A.id+"/"+o+".xml";if(y){N+="?is_object=1"}return N};var l=function(N){var O=N.getElementsByTagName("error");if(O.length>0){D(O[0].firstChild.nodeValue);return}G(N)};var G=function(T){var Q=T.getElementsByTagName("property");var P=w(Q);var O=T.getElementsByTagName("value");var S=x(O);var R=false;var N=false;switch(P){case"wysiwyg":case"text":case"string":case"int":case"price":case"float":case"tags":case"link_to_object_type":case"counter":b(S,P);break;case"date":S=g(O);r(S);break;case"boolean":F(S);break;case"relation":O=T.getElementsByTagName("item");R=(Q[0].getAttribute("multiple")==="multiple");N=(Q[0].getAttribute("public-guide")==="1");M(O,R,N);break;case"name":O=T.getElementsByTagName("name");S=x(O);b(S,P);break;case"color":f(S);break;case"img_file":case"swf_file":case"video_file":case"file":I(S,P);break;case"domain_id_list":case"domain_id":var U=T.getElementsByTagName("domain");$.each(U,function(V,W){var X=$(W);X.attr("name",X.attr("host"))});R=(P==="domain_id_list");M(U,R,N,{type:"",sourceUri:"/admin/data/getDomainList/"});break;case"optioned":a(T);break;default:D(getLabel("js-edcell-unsupported-type"));break}};var w=function(O){if(o==="name"){return"name"}var N="";if(typeof(O[0])!=="undefined"){N=O[0].getAttribute("type")||""}return N};var x=function(N){var O;if(N.length>0){O=N[0].firstChild?N[0].firstChild.nodeValue:""}return O||""};var g=function(N){var O;if(N.length>0){O=N[0].firstChild?N[0].getAttribute("formatted-date"):""}return O||""};this.registerOutsideClick=function(){$(window).on("click",h.outSideClick)};this.unregisterOutsideClick=function(){$(window).off("click",h.outSideClick)};this.outSideClick=function(O){var N=$(h.element).prop("id")!=$(O.target).closest("td").prop("id");if(N){h.prepareSaveData()}};var b=function(O,N){d=document.createElement("input");d.setAttribute("type","text");d.value=O;d.className="editableCtrl default";d=$(d);d.on("keyup",k);d.on("blur",function(){if(editableCell.activeCell){h.prepareSaveData(N)}});var P=E();z=P.html();C=O;P.html("");d.appendTo(P);d.focus()};var k=function(O){var N=Number(window.event?window.event.keyCode:O.which);if(N===J){h.restore()}if(N===n&&editableCell.activeCell){h.prepareSaveData()}};var E=function(){return $("div",h.element)};var r=function(N){d=document.createElement("input");d.setAttribute("type","text");d.value=N;d.className="default";d=$(d);d.on("keyup",k);d.on("blur",function(R){var P=R.relatedTarget||R.toElement;if(!P){return}var Q=$(R.relatedTarget).closest("table").hasClass("ui-datepicker-calendar");if(editableCell.activeCell&&!Q){h.prepareSaveData()}});var O=E();z=O.html();C=N;O.html("");d.appendTo(O);d.focus();d.datepicker({dateFormat:"yy-mm-dd",onClose:function(P){if(!/\d{1,2}:\d{1,2}(:\d{1,2})?$/.exec(P)){P+=" 00:00:00"}d.val(P);if(editableCell.activeCell){h.prepareSaveData()}}});d.datepicker("show")};var I=function(Q,P){var R=E();z=R.html();C=Q;var O=_.template($("#fast-edit-file-control").html());var N=O({id:h.element.id+"_input_id",value:Q});R.html("");R=$(N).appendTo(R);d=$("input",R);d.on("keyup",k);d.on("change",function(){d.focus();return true});h.registerOutsideClick();$("a.icon-action",R).on("click",function(){var S;switch(P){case"img_file":S="image=1";break;case"swf_file":case"video_file":S="video=1";break;default:S=""}s(d,S)});d.focus()};var s=function(R,U){var S=R.attr("id");var Q=R.val();var P=Q.match(/(.*\/)/);var O=(P)?P[0]:"";var N=[];N.push("id="+S);N.push("file="+Q);N.push("folder="+O);N.push("lang="+window.lang_id);if(U){N.push(U)}$.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:660,height:530,url:"/styles/common/other/elfinder/umifilebrowser.html?"+N.join("&")});var W=$("div#popupLayer_Filemanager div.popupBody");var T=_.template($("#file-browser-options").html());var V=T({watermarkMessage:getLabel("js-water-mark"),rememberMessage:getLabel("js-remember-last-dir"),remember:getCookie("remember_last_folder",true)});W.append(V)};var f=function(N){C=N;var P=E();z=P.html();P.html("");var O='<div class="color table"><input type="text" class="default"></div>';P=$(O).appendTo(P);d=$("input",P);if(N){d.val(N)}d.on("keyup",k);d.bind("blur",function(){if(editableCell.activeCell){h.prepareSaveData()}});new colorControl(P,{});$(P).bind("hidePicker",function(){if(editableCell.activeCell){h.prepareSaveData()}})};var M=function(Q,S,V,Y){Y=Y||{};var O=$(Q);$(h.element).addClass("hide-editable");var N=E();N.css("overflow","visible");z=N.html();var W=(S?"multiple":"");var U='<div class="layout-col-control quick selectize-container"><select id="" class="default" '+W+' autocomplete="off"></select></div>';N.html("");var P=$(U).appendTo(N);d=$("select",P);$.each(O,function(ab,ac){var aa=$(ac);d.append($("<option>",{value:aa.attr("id"),text:aa.attr("name"),selected:true}))});if(V){var T='<div class="layout-col-icon"><a id="" title="'+getLabel("js-new_guide_item_title")+'" class="icon-action relation-add"><i class="small-ico i-add"></i></a></div>';N.append(T)}Y=$.extend({container:N,type:L.guideId,preload:false},Y);var R=new ControlRelation(Y);R.loadItemsAll(Z,true);var X;function Z(ac){X=R.selectize;var ab=ac.responseXML.getElementsByTagName("object");if(ab.length>0){R.updateElements(ac)}else{ab=ac.responseXML.getElementsByTagName("empty");var aa=String(ab[0].getAttribute("result")).toLowerCase().replace(/[\s]/g,"");if(aa==="toomuchitems"){X=R.makeSearch()}}X.on("change",function(){h.prepareSaveData()});X.lock();$.each(O,function(ae,af){var ad=$(af);X.addItem(ad.attr("id"),true)});X.unlock();X.editableCell=h}h.registerOutsideClick();N.on("keyup",k);h.prepareSaveData=function(){$(h.element).removeClass("hide-editable");if(!X){return}var aa=[];for(var ab=0;ab<X.items.length;ab++){var ac=X.items[ab];aa.push(ac)}h.save(aa)}};var F=function(P){var Q=E();z=Q.html();Q.html("");var O=(P?"checked":"");var R='<div class="checkbox '+O+'"><input type="checkbox editableCtrl"></div>';d=$(R).appendTo(Q);d.on("click",function(){var T=$(this);T.toggleClass("checked");var S=T.hasClass("checked")?1:0;h.save(S,true);if(_.contains(["is_activated","is_active","active"],h.element.name)){A.update({"is-active":S,id:A.id})}return true});h.registerOutsideClick();var N=d.children("input").eq(0);N.focus();N.bind("keydown",k);d.focus()};var a=function(N){$.ajax({url:"/styles/skins/modern/design/js/common/optioned_template.html",dataType:"html",success:function(R){var W=$($.parseHTML(R));var ad=W.find("#field_template").html();var U=W.find("#option_template").html();var ab=N.getElementsByTagName("property")[0];var Z=N.getElementsByTagName("title")[0].innerHTML;var ac=ab.getAttribute("guide-id");var Y=ab.getAttribute("object-id");var T="data["+Y+"]["+o+"]";var aa=(ab.getAttribute("public-guide")==="1");var O=uAdmin.data["pre-lang"];var Q=(o==="stores_state");var V=Q?"int":"float";var X=[];$(N).find("option").each(function(af,ag){var ah=$(ag).find("object");X.push({label:ah.attr("name"),labelRemoveOption:getLabel("js-remove-option"),inputName:T,position:af,relationId:ah.attr("id"),value:$(ag).attr(V),isStores:Q})});var ae="";$.each(X,function(af,ag){ae+=$.tmpl(U,ag)[0].outerHTML});var S={title:Z,guideId:ac,inputName:T,isPublic:aa,langPrefix:O,type:V,labelEditGuideItems:getLabel("js-edit-guide-items"),labelAddRelationItem:getLabel("js-add-relation-item"),labelAddOption:getLabel("js-add-option"),optionsHtml:ae};var P=$.tmpl(ad,S);openDialog("",getLabel("js-editable-optioned-field"),{width:800,html:P,cancelButton:true,confirmText:getLabel("js-save"),cancelText:getLabel("js-new_guide_item_cancel"),openCallback:function(){initOptionedFields()},confirmCallback:function(ag){var af=$("#optionedFieldForm").serialize();af+="&csrf="+csrfProtection.getToken();$.ajax({type:"POST",url:j("save"),dataType:"xml",data:af,success:function(){$.jGrowl(getLabel("js-property-saved-success"))},error:function(aj,ah,ai){q(ai,"save")},complete:function(){closeDialog(ag)}})},cancelCallback:function(af){closeDialog(af)}})}})};var v=function(N){$.ajax({type:"POST",url:j("save"),dataType:"xml",data:({"data[]":N,csrf:csrfProtection.getToken()}),success:m,error:function(Q,O,P){q(P,"save")},complete:function(){if(editableCell.activeCell===h){editableCell.activeCell=false}}})};var m=function(R){var U=R.getElementsByTagName("error");if(U.length>0){D(U[0].firstChild.nodeValue);h.restore();return}var T=E();var P=R.getElementsByTagName("property");var O=R.getElementsByTagName("value");var Q=x(O);S(w(P));N();function S(Y){switch(Y){case"wysiwyg":case"text":case"int":case"price":case"float":case"tags":case"counter":case"link_to_object_type":aa(Q);return;case"date":aa(g(O));return;case"string":X();return;case"boolean":ac();return;case"relation":Z();return;case"domain_id":case"domain_id_list":V();return;case"name":W();return;case"color":ad();return;case"video_file":case"swf_file":case"file":case"img_file":ab();return;default:D(getLabel("js-edcell-unsupported-type"));return}function aa(ae){T.html(ae);C=ae}function X(){var ae=P[0].getAttribute("restriction");if(Q&&ae==="email"){Q="<a href='mailto:"+Q+"' title='"+Q+"' class='link'>"+Q+"</a>"}aa(Q)}function ac(){Q=Number(Q);T.html(Q?'<img alt="" style="width:13px;height:13px;" src="/images/cms/admin/mac/tree/checked.png" />':"");C=Q}function Z(){O=R.getElementsByTagName("item");if(O.length===1){var af=O[0].getAttribute("name")||"";var ae=O[0].getAttribute("guid")||"relation-value";Q='<span title="'+af+'" class="c-'+ae+'">'+af+"</span>"}else{if(O.length>1){for(var ag=0;ag<O.length;ag++){Q+=O[ag].getAttribute("name")||"";if(ag<O.length-1){Q+=", "}}}}T.css("overflow","hidden");aa(Q)}function V(){O=R.getElementsByTagName("domain");Q="";if(O.length===1){Q=O[0].getAttribute("host")||""}else{if(O.length>1){for(var ae=0;ae<O.length;ae++){var af=O[ae].getAttribute("host")||"";Q+=af;if(ae<O.length-1&&af.length>0){Q+=", "}}}}aa(Q)}function W(){O=R.getElementsByTagName("name");Q=x(O);T.html(z);T.find(".name_col").text(Q);A.checkBox=$("div.checkbox",T).get(0);C=Q}function ad(){var af='<div class="color table"><span class="value">'+Q+'</span><span class="color-box"><i style="background-color: '+Q+'"></i></span></div>';if(C.length===0){T.html(af)}else{T.html(z)}var ag=$(".value",T);var ae=$(".color-box i",T);ag.html(Q);ae.css("background-color",Q);C=Q}function ab(){if(O.length>0){var aj=$(O[0]);var ak=aj.attr("path");var ai=ak.substring(0,ak.lastIndexOf("."));var ae=ak.substring(1);var af=aj.attr("ext");var al=aj.attr("name")+"."+af;var ah=aj.attr("is_broken");var ag=(Y==="img_file")?"fast-edit-image-preview":"fast-edit-file-preview";var am=_.template($("#"+ag).html());Q=am({filePath:ae,filePathWithoutExt:ai,fileName:al,ext:af,isBroken:ah})}aa(Q)}}function N(){if(window.onAfterSetProperty){onAfterSetProperty(A.id,o,Q)}$.jGrowl(getLabel("js-property-saved-success"));z=E().html();Control.recalcItemsPosition()}};var c=function(P,N){var O=["int","price","float","counter"];if(O.indexOf(N)!==-1){return p(P)}return true};var p=function(O){if(O==""){return true}var N=!isNaN(parseFloat(O))&&O.match(/^[0-9eE.,]+$/);if(!N){$.jGrowl(getLabel("js-error-validate-number"),{header:getLabel("js-error-header")});return false}return true};this.save=function(P,O,N){h.unregisterOutsideClick();if(!_.isArray(P)&&!O&&(C==P||!c(P,N))){this.restore();return false}v(P);return true};this.restore=function(){h.unregisterOutsideClick();$(h.element).removeClass("hide-editable");editableCell.activeCell=false;var N=E();N.html(z);Control.recalcItemsPosition()};this.getEditControl=function(){return d}};editableCell.activeCell=false;editableCell.ignoreDataTypes=["wysiwyg"];editableCell.ignorePropNames=[];var TreeItem=function(c,x,h,I,t){var y=parseInt(h.id);var E=this;var f=h;var o=x;var b=I||null;var u=t||"after";var n=typeof(h["force-draw"])!=="undefined"?parseInt(h["force-draw"]):1;var v=typeof(h.childs)!=="undefined"?parseInt(h.childs):0;var s=(typeof(h.basetype)!=="undefined"&&typeof(h.basetype["_value"])==="string")?h.basetype["_value"]:"";var d=c.iconsPath;var C=(typeof(h.basetype)!=="undefined"&&typeof(h.basetype["module"])==="string")?h.basetype["module"]:"content";var D=(typeof(h.basetype)!=="undefined"&&typeof(h.basetype["method"])==="string")?h.basetype["method"]:"";var m=typeof(h.iconbase)!=="undefined"?h.iconbase:d+"ico_"+C+"_"+D+".png";var F=null;var e=null;var l=null;var B=null;var G=SettingsStore.getInstance();var g=true;var r=null;var A=false;var H=49;var k=null;var a=typeof c.hasCheckboxes=="boolean"?c.hasCheckboxes:true;var q=typeof c.isCanSelect=="boolean"?c.isCanSelect:true;this.element=null;this.checkBox=null;this.control=c;this.childsContainer=null;this.id=y;this.name=typeof(h.name)!=="undefined"?h.name:"noname";this.isRoot=(y===0);this.loaded=false;this.viewLink=typeof(h.link)!=="undefined"?h.link:false;this.editLink=typeof(h["edit-link"])!=="undefined"?h["edit-link"]:false;this.createLink=typeof(h["create-link"])!=="undefined"?h["create-link"]:false;this.permissions=typeof(h.permissions)!=="undefined"?parseInt(h.permissions):0;this.isActive=typeof(h["is-active"])!=="undefined"?parseInt(h["is-active"]):0;this.isVirtualCopy=typeof(h["has-virtual-copy"])!=="undefined";this.isOriginal=typeof(h["is-original"])!=="undefined";this.lockedBy=typeof(h["locked-by"])==="object"?h["locked-by"]:null;this.expiration=typeof(h.expiration)==="object"?h.expiration:null;this.isDefault=typeof(h["is-default"])!=="undefined"?true:false;this.templateId=typeof(h["template-id"])!=="undefined"?h["template-id"]:null;this.langId=typeof(h["lang-id"])!=="undefined"?h["lang-id"]:null;this.domainId=typeof(h["domain-id"])!=="undefined"?h["domain-id"]:null;this.allowCopy=typeof(h["allow-copy"])!=="undefined"?parseInt(h["allow-copy"]):true;this.allowActivity=typeof(h["allow-activity"])!=="undefined"?parseInt(h["allow-activity"]):true;this.allowDrag=typeof(h["allow-drag"])!=="undefined"?h["allow-drag"]:true;this.parent=o;this.childs=[];this.hasChilds=(v>0||y==0);this.labelControl=null;this.position=false;this.isExpanded=false;this.filter=new filter;this.filter.setParentElements(y);this.pageing={total:0,limit:0,offset:0};this.baseModule=(typeof(h.basetype)!=="undefined"&&typeof(h.basetype["module"])==="string")?h.basetype["module"]:"content";this.baseMethod=(typeof(h.basetype)!=="undefined"&&typeof(h.basetype["method"])==="string")?h.basetype["method"]:"";var w=function(){if(x){x.childs[x.childs.length]=y;z(o.childsContainer)}else{p()}};var z=function(V){var K=document.createElement("li");K.setAttribute("rel",y);K.classList.add("ti");K.classList.add("tollbar");K.rel=y;K.onmousedown=function(){return false};e=document.createElement("div");e.classList.add("ti");e.classList.add("tree_line");if(E.isVirtualCopy){e.className+=" virtual"}if(E.isDefault){e.className+=" main-page"}jQuery(e).bind("mouseover",function(){E.control.onElementMouseOver(E,this)});jQuery(e).bind("mouseout",function(){E.control.onElementMouseOut(E,this)});jQuery(e).bind("click",function(ab){E.control.onElementClick(E,this,ab)});F=document.createElement("span");F.className="catalog-toggle";var N=document.createElement("span");N.classList.add("catalog-toggle-wrapper");N.onclick=function(ab){E.toggle(this);return false};if(E.hasChilds){N.appendChild(F)}else{N.className="catalog-toggle-off"}e.appendChild(N);if(a){var M=document.createElement("div");M.classList.add("checkbox");var R=document.createElement("input");R.setAttribute("type","checkbox");R.value=y;R.classList.add("row_selector");M.appendChild(R);E.checkBox=M;e.appendChild(M)}if(q){var Z=jQuery(e);Z.bind("mousedown",function(ab){E.control.handleMouseDown(ab,y)});Z.bind("mouseup",function(ab){E.control.handleMouseUp(ab,E)})}B=document.createElement("img");B.style.border="0px";B.setAttribute("alt",s);B.setAttribute("title",s);B.setAttribute("src",m);B.className="ti-icon";B.onmousedown=function(){return false};if(E.control.allowDrag&&E.allowDrag){B.style.cursor="move"}e.appendChild(B);if(E.expiration){var T=E.expiration.status;if(T){var O=T.id;var P=T._value;if(O){var X=document.createElement("img");var S=d+"ico_"+O+".png";X.setAttribute("src",S);X.setAttribute("alt",P);X.setAttribute("title",P);X.className="page-status";e.appendChild(X)}}}l=document.createElement("a");var aa=E.name;if(typeof aa!="string"){aa=getLabel("js-smc-noname-page")}l.innerHTML=aa;if(E.viewLink){l.title=E.viewLink}l.setAttribute("href","#");if(E.editLink){l.setAttribute("href",E.editLink);l.onclick=function(){return E.control.applyBehaviour(E)}}$(l).bind("mousedown click mouseup",function(ac){var ab=1;if(ac.button!==ab){ac.preventDefault()}return true});e.appendChild(l);if(E.isVirtualCopy){var Q=document.createElement("span");Q.className="label-virtual";Q.innerHTML=(E.isOriginal)?getLabel("js-smc-original"):getLabel("js-smc-virtual-copy");e.appendChild(Q)}if(E.editLink){var Y=document.createElement("a");Y.classList.add("small-ico");Y.classList.add("i-edit");Y.setAttribute("href",E.editLink);e.appendChild(Y)}E.labelControl=K.appendChild(e);if(!E.isActive){e.classList.add("disabled")}k=document.createElement("div");k.className="pages-bar";k.style.display="none";E.pagesBar=K.appendChild(k);childsContainer=document.createElement("ul");childsContainer.className="ti-childs-container";childsContainer.style.display="none";E.childsContainer=K.appendChild(childsContainer);if(b){var U=null;if(u.toLowerCase()=="after"){U=b.element.nextSibling}else{U=b.element}if(U){E.element=V.insertBefore(K,U)}else{E.element=V.appendChild(K)}}else{E.element=V.appendChild(K)}if(E.control.dragAllowed&&E.allowDrag){var J="child";var W;var L=false;jQuery(e).draggable({appendTo:"body",distance:Control.DragSensitivity,handle:".ti-icon, a",cursorAt:{right:-2},helper:function(){E.setSelected(true);E.control.selectedList[E.id]=E;var ab=document.createElement("div");for(key in E.control.selectedList){ab.innerHTML+="<div>"+E.control.selectedList[key].name+"</div>"}ab.className="ti-draggable";jQuery(ab).css({position:"absolute","padding-left":"20px"});return ab},start:function(){Control.DraggableItem=E;Control.DragMode=true;if(E.control.toolbar){E.control.toolbar.hide()}},stop:function(){if(Control.HandleItem){Control.HandleItem.deInitDroppable();if(Control.DraggableItem){Control.DraggableItem.tryMoveTo(Control.HandleItem,J)}}Control.DraggableItem=null;Control.DragMode=false;jQuery(".pages-bar a").off("mouseover");L=false;window.clearTimeout(W)},drag:function(ab,ah){jQuery(".pages-bar a").on("mouseover",function(){if(!L){L=true;var ak=this;W=window.setTimeout(function(){ak.click()},1000)}});jQuery(".pages-bar a").on("mouseout",function(){if(L){L=false;window.clearTimeout(W)}});var ai=ab.pageX;var ag=ab.pageY;var ad=Control.detectItemByMousePointer(ai,ag);var ae=Control.HandleItem;if(ae){ae.deInitDroppable()}Control.HandleItem=ad;if(ad){var aj=jQuery(ad.control.initContainer).position();var af=ad.position.bottom-ad.position.top;var ac=ag-aj.top-ad.position.top;if(ac<af/3){J="before"}if(ac>af/3&&ac<2*af/3){J="child"}if(ac>2*af/3){J="after"}if(ad.isRoot){J="child"}ad.initDroppable(J)}}})}};var p=function(){if(!Control.dropIndicator){var J=document.createElement("div");J.className="ti-drop";Control.dropIndicator=document.body.appendChild(J)}z(E.control.container)};var j=function(){if(g&&E===Control.HandleItem&&!E.isExpanded){E.expand()}};this.draw=function(){if(x){if(!n){z(o.childsContainer)}}else{if(!n){p()}}};this.appendChild=function(J){return new TreeItem(this.control,E,J)};this.appendAfter=function(J,K){return new TreeItem(this.control,E,J,K,"after")};this.appendBefore=function(J,K){return new TreeItem(this.control,E,J,K,"before")};this.appendFirst=function(J){if(!this.childsContainer.childNodes.length){return this.appendChild(J)}else{if(typeof(this.childsContainer.childNodes[0].rel)!="undefined"){return this.appendBefore(J,this.control.getItem(this.childsContainer.childNodes[0].rel))}}};this.getPreviousSibling=function(){var J=this.element.previousSibling;if(J&&J.rel){return this.control.getItem(J.rel)}return null};this.getNextSibling=function(){var J=this.element.nextSibling;if(J&&J.rel){return this.control.getItem(J.rel)}return null};this.clear=function(){if(this.element.parentNode){this.element.parentNode.removeChild(this.element)}};this.checkIsChild=function(K){var J=this.parent;while(J){if(K===J){return true}J=J.parent}return false};this.recalcPosition=function(){try{var K=jQuery(e).position();this.position={left:K.left,top:K.top,right:this.control.initContainer.offsetWidth,bottom:K.top+e.offsetHeight};return this.position}catch(J){return false}};this.getValue=function(N){if(!f.properties){return false}if(!f.properties["group"]){return false}var M=typeof(f.properties["group"][0])!="undefined"?f.properties["group"]:[f.properties["group"]];for(var L=0;L<M.length;L++){if(!M[L]["property"]){continue}var J=typeof(M[L]["property"][0])!="undefined"?M[L]["property"]:[M[L]["property"]];for(var K=0;K<J.length;K++){if(J[K]["name"]==N){return J[K]["value"]}}}return false};this.check=function(){$(checkbox).toggleClass("checked")};this.getData=function(){return f};this.setLoaded=function(J){this.loaded=J};this.setPageing=function(M){if(!M){return false}this.pageing=M;k.style.display="none";k.innerHTML="";k.style.textAlign="left";if(M.total<2){k.parentNode.style.display="";var R=document.createElement("span");R.className="empty-result";if(this.isRoot){k.style.textAlign="center"}k.appendChild(R)}if(M.total>M.limit||M.offset>0){var L=document.createElement("span");L.appendChild(document.createTextNode(getLabel("js-pages-label")));L.className="pagesLabel";k.appendChild(L);k.style.display="";var K=Math.ceil(M.total/M.limit);var J=Math.ceil(M.offset/M.limit);var N=function(S){return function(){E.filter.setPage(S);E.applyFilter(E.filter,true);return false}};var P=false;var Q=false;for(var O=0;O<K;O++){if(O!=0&&O!=(Math.ceil(M.total/M.limit)-1)){if(Math.abs(O-J)>15){if(!P){Q=document.createElement("a");Q.href="#";if(J==O){Q.className="current"}Q.innerHTML="&#8230;";Q.className="current";Q.onclick=function(){return false};k.appendChild(Q)}P=true;continue}}P=false;Q=document.createElement("a");Q.href="#";if(J==O){Q.className="current"}Q.innerHTML=O+1;Q.onclick=N(O);k.appendChild(Q)}}};this.expand=function(){if(!this.hasChilds){return false}$(F).addClass("switch");this.isExpanded=true;if(!this.loaded){this.control.load(this.filter)}this.childsContainer.style.display="";var J=this.pageing;if(J.total>J.limit){E.pagesBar.style.display=""}Control.recalcItemsPosition();this.control.saveItemState(this.id)};this.collapse=function(){if(!this.hasChilds){return false}this.isExpanded=false;F.setAttribute("src",d+"expand.png");$(F).removeClass("switch");this.childsContainer.style.display="none";E.pagesBar.style.display="none";Control.recalcItemsPosition();this.control.saveItemState(this.id)};this.toggle=function(J){if(this.hasChilds){$(J).toggleClass("switch");this.isExpanded?this.collapse():this.expand()}};this.update=function(J){if(J){if(this.id!=J.id){return false}if(typeof(J["template-id"])!=="undefined"){this.templateId=J["template-id"]}if(typeof(J.link)!=="undefined"&&J.link!=this.viewLink){this.viewLink=J.link;e.setAttribute("href",this.viewLink)}if(typeof(J.childs)!=="undefined"&&parseInt(J.childs)!==v){v=parseInt(J.childs);this.hasChilds=v>0||y==0;var L=$("span",e);if(E.hasChilds){L.removeClass("catalog-toggle-off");L.removeClass("switch");L.addClass("catalog-toggle-wrapper");L.empty();F=document.createElement("span");F.className="catalog-toggle switch";L.append(F)}else{L.removeClass("catalog-toggle-wrapper");L.removeClass("switch");L.addClass("catalog-toggle-off");L.empty()}}var K=typeof(J["is-active"])!=="undefined"?parseInt(J["is-active"]):0;if(K!==this.isActive){this.isActive=K;if(!this.isActive){$(e).addClass("disabled")}else{$(e).removeClass("disabled")}}if(typeof(J.name)!=="undefined"&&J.name!=this.name){this.name=J.name.length?J.name:"";l.innerHTML=this.name.length?this.name:getLabel("js-smc-noname-page")}}};this.tryMoveTo=function(L,M){if(L){var O=this.control.getRootNodeId();var Q=L.id;var P=M!=="child"?1:0;if(M=="before"){O=L.id;Q=L.parent.id}if(M=="after"){var R=L.getNextSibling();Q=L.parent.id;O=R?R.id:this.control.getRootNodeId()}if(L===this){return false}if(L.checkIsChild(this)){return false}if(O==this.id){return false}var K=L;if(P){K=L.parent?L.parent:L.control.getRoot()}var N=[];var J=0;for(i in this.control.selectedList){N[J++]=i}this.control.dataSet.execute("move",{element:this.id,before:O,rel:Q,"as-sibling":P,domain:L.control.getRoot().name,childs:1,links:1,virtuals:1,permissions:1,templates:1,receiver_item:K,handle_item:this,selected_list:N})}};this.initDroppable=function(L){var L=L||"child";var J=Control.DraggableItem;var M=jQuery(this.control.initContainer).position();if(J){if(J===this){return false}if(this.checkIsChild(J)){return false}var K=Control.dropIndicator;if(L=="after"){K.style.top=this.position.bottom+M.top+"px";K.style.left=this.position.left+M.left+"px";K.style.width=this.position.right-this.position.left+"px"}if(L=="before"){K.style.top=this.position.top+M.top+K.offsetHeight+"px";K.style.left=this.position.left+M.left+"px";K.style.width=this.position.right-this.position.left+"px"}if(L=="child"){K.style.top=this.position.bottom+M.top+"px";K.style.left=this.position.left+M.left+20+"px";K.style.width=this.position.right+M.left-40-this.position.left+"px"}K.style.display="";setTimeout(j,3239)}};this.deInitDroppable=function(){if(!Control.dropIndicator){return}Control.dropIndicator.style.display="none"};this.applyFilter=function(K,J){if(K instanceof Object){this.filter=K}else{this.filter.clear()}if(!J){this.filter.setParentElements(y)}if(this.loaded){this.control.removeItem(y,true);this.loaded=false;if(this.isExpanded){this.expand()}}};this.setSelected=function(J){if(J){if(!r){r=e.className;e.classList.add("selected");if(E.isDefault){e.className+=" main-page"}}if(a){$(this.checkBox).addClass("checked")}A=true}else{if(r){if(E.isDefault){e.className+=" main-page"}r=null}$(e).removeClass("selected");if(a){$(this.checkBox).removeClass("checked")}A=false}};this.getSelected=function(){return A};w()};ContextMenu={};ContextMenu.itemHandlers={};ContextMenu.itemHandlers.viewElement=function(g){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var b=Control.HandleItem.control.selectedList;var d,f,c=0;for(d in b){f=b[d];c++}if(!f){return false}var a=f.getData()["link"];if(!a){return false}var e=(c!=1);return{caption:getLabel("js-"+g[0]),icon:"i-see",visible:true,disabled:e,execute:function(){window.location=a;return false}}};ContextMenu.itemHandlers.copyUrl=function(g){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var b=Control.HandleItem.control.selectedList;var d,f,c=0;for(d in b){f=b[d];c++}if(!f){return false}var a=f.getData()["link"];if(!a){return false}var e=(c!=1);return{caption:getLabel("js-"+g[0]),icon:"i-copy-url",visible:true,disabled:e,onRender:function(j){var k=$(j);k.attr("data-clipboard-text","http://"+location.hostname+a);var h=new ZeroClipboard(j)},execute:function(h){}}};ContextMenu.itemHandlers.changeParent=function(b){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var a=this;this.moveItem=function(c){if(window.page_id==c){return false}jQuery.ajax({url:"/admin/content/tree_move_element.json",type:"get",dataType:"json",data:{element:window.page_id,rel:c,return_copies:1},success:function(d){oFilterController.applyFilterAdvanced()}})};return{caption:getLabel("js-"+b[0]),icon:b[1],visible:true,execute:function(d){var c='&callback=changeParentControlsList["'+Control.HandleItem.id+'"].moveItem';window.page_id=Control.HandleItem.id;if(!window.changeParentControlsList){window.changeParentControlsList={}}window.changeParentControlsList[Control.HandleItem.id]=a;jQuery.openPopupLayer({name:"Sitetree",title:getLabel("js-choice-page"),width:620,height:335,url:"/styles/common/js/parents.html?id="+Control.HandleItem.id+(Control.HandleItem.baseModule?"&module="+Control.HandleItem.baseModule:"")+(window.lang_id?"&lang_id="+window.lang_id:"")+c})}}};ContextMenu.itemHandlers.editItem=function(g){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var a=Control.HandleItem.control.selectedList;var d,f,c=0;for(d in a){f=a[d];c++}if(!f){return false}var b=f.editLink;if(!b){return false}var e=(c!=1||!b);return{caption:getLabel("js-"+g[0]),icon:"i-edit",visible:true,disabled:e,execute:function(){window.location=b;return false}}};ContextMenu.itemHandlers.addItem=function(f){if(!Control.HandleItem){return false}var a=Control.HandleItem.control.selectedList;var c,e,b=0;for(c in a){e=a[c];b++}if(!e){return false}var g=e.createLink;if(!g){return false}var d=(b!=1||!g);return{caption:getLabel("js-"+f[0]),icon:"i-add",visible:true,disabled:d,execute:function(){window.location=g;return false}}};ContextMenu.itemHandlers.filterItem=function(c){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}if(Control.HandleItem.control.flatMode||Control.HandleItem.control.objectTypesMode){return false}var e=Control.HandleItem.control;var g=Control.HandleItem.control.selectedList,f,b=0;var j=false,a=false;for(f in g){var h=g[f];if(e.isTarget(h)){j=true}else{a=true}b++}var d=false;if(b==1){if(!h.hasChilds){d=true}}return{caption:getLabel("js-"+c[0]),icon:j?"i-search-section":"i-search-section disabled",visible:true,disabled:d,execute:function(){var k=Control.HandleItem.control;k.setTargetItems(j?{}:k.selectedList);return false}}};ContextMenu.itemHandlers.activeItem=function(f){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}if(Control.HandleItem.control.flatMode||Control.HandleItem.control.objectTypesMode){return false}var a=Control.HandleItem.control.selectedList,c;var d=false,b=false;for(c in a){if(a[c].isActive){d=true}else{b=true}}var e=(d&&!b);return{caption:getLabel("js-"+f[0]),icon:e?"i-vision":"i-hidden",visible:true,execute:function(){var j=Control.HandleItem.control,g,h=[];for(g in a){h.push(g)}j.dataSet.execute("tree_set_activity",{element:h,selected_items:a,active:(e?0:1)});return false}}};ContextMenu.itemHandlers.activeObjectItem=function(g){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}if(!Control.HandleItem.control.flatMode){return false}var a=Control.HandleItem.control.selectedList,c;var d=false,b=false;for(c in a){var f=a[c];if(f.getValue("is_activated")||f.getValue("is_active")||f.getValue("activated")){d=true}else{b=true}}var e=(d&&!b);return{caption:getLabel("js-"+g[0]),icon:e?"i-vision":"i-hidden",visible:true,execute:function(){var k=Control.HandleItem.control,h,j=[];for(h in a){j.push(h)}k.dataSet.execute("tree_set_activity",{element:Control.HandleItem.id,object:j,handle_item:Control.HandleItem,selected_items:a,viewMode:"full",active:(e?0:1)});return false}}};ContextMenu.itemHandlers.deleteItem=function(c){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var a=Control.HandleItem.control.selectedList;var b=Object.keys(a);if(b.length<1){return false}return{caption:getLabel("js-"+c[0]),icon:"i-remove",visible:true,execute:function(){var k=Control.HandleItem.control,g,f,h=[];var d=k.selectedList;if(d instanceof Array){for(var f=0;f<d.length;f++){var j=d[f];if(j.lockedBy){alert(getLabel("js-page-is-locked")+"\n"+getLabel("js-steal-lock-question"));ContextMenu.getInstance().terminate();return false}h.push(j)}}if(d instanceof Object){for(var e in d){h.push(e)}}k.dataSet.execute("tree_delete_element",{element:h,selected_items:d});return false}}};ContextMenu.itemHandlers.templatesItem=function(e){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}if(Control.HandleItem.control.flatMode||Control.HandleItem.control.objectTypesMode){return false}var k=Control.HandleItem.control.selectedList;var g,j=false,a=false,c=false,h=false;for(g in k){var q=k[g];if(!j||!a){j=q.langId;a=q.domainId}if(c&&h){if(c!=q.templateId){c=false}}if(!c&&!h){c=q.templateId;h=true}}var f=TemplatesDataSet.getInstance();var m={},o=f.getTemplatesList(a,j);var d=function(r){return function(){if(!Control.HandleItem){return false}var u=Control.HandleItem.control,s,t=[];for(s in k){t.push(s)}u.dataSet.execute("change_template",{element:t,selected_items:k,"template-id":r,templates:1,childs:1,permissions:1,virtuals:1,links:1});return false}};for(g in o){var p=o[g];var b=p.id,l=p.title,n=false;if(!b){continue}if(c&&c==b){n=true}m[b]={icon:n?"checked":"undefined",caption:l,execute:d(b)}}return{caption:getLabel("js-"+e[0]),icon:"i-amend",visible:true,execute:function(){return false},submenu:m}};ContextMenu.itemHandlers.storeGoodsItem=function(){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var b=Control.HandleItem.control.selectedList;var d,f,c=0;for(d in b){f=b[d];c++}if(!f){return false}var a=window.pre_lang+"/admin/eshop/store_view/"+f.id+"/";if(!a){return false}var e=(c!=1);return{title:getLabel("js-view-store-goods"),callback:function(){window.location=a;return false},disabled:e}};ContextMenu.itemHandlers.guideViewItem=function(){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var b=Control.HandleItem.control.selectedList;var d,f,c=0;for(d in b){f=b[d];c++}if(!f){return false}var a=window.pre_lang+"/admin/data/guide_items/"+f.id+"/";if(!a){return false}var e=(c>1);return{caption:getLabel("js-view-guide-items"),icon:"view",execute:function(){window.location=a;return false},disabled:e}};ContextMenu.itemHandlers.viewMessage=function(){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var b=Control.HandleItem.control.selectedList;var d,f,c=0;for(d in b){f=b[d];c++}if(!f){return false}var a=window.pre_lang+"/admin/webforms/message/"+f.id+"/";var e=(c>1);return{caption:getLabel("js-view-message"),icon:"view",execute:function(){window.location=a;return false},disabled:e}};ContextMenu.getExchangeSourceItem=function(){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}if(Control.HandleItem.control.objectTypesMode||Control.HandleItem.control.flatMode){return false}var a=Control.HandleItem.control.selectedList;var c,d,b=0;for(c in a){d=a[c];b++}if(!d.hasChilds||b!==1){return false}return d};ContextMenu.itemHandlers.csvExport=function(b){var a=ContextMenu.getExchangeSourceItem();if(!a){return false}return{caption:getLabel("js-csv-export"),icon:b[1],visible:true,execute:function(){a.exportCallback(a.id)}}};ContextMenu.itemHandlers.csvImport=function(b){var a=ContextMenu.getExchangeSourceItem();if(!a){return false}return{caption:getLabel("js-csv-import"),icon:b[1],visible:true,execute:function(){a.importCallback(a.id)}}};ContextMenu.itemHandlers.restoreItem=function(b){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}var a=Control.HandleItem.control.selectedList;if(a.length<1){return false}return{caption:getLabel("js-trash-restore"),icon:b[1],visible:true,execute:function(){var f=Control.HandleItem.control,d,e=[];var c=f.selectedList;for(d in c){e.push(d)}f.dataSet.execute("restore_element",{element:e,selected_items:c});return false}}};ContextMenu.itemHandlers.copyItemOld=function(k){if(!Control.HandleItem){return false}if(!Control.HandleItem.id){return false}if(Control.HandleItem.control.flatMode||Control.HandleItem.control.objectTypesMode){return false}var e=Control.HandleItem.control;var g=e.selectedList;var m,l,p,h=false,a=false;for(m in g){p=g[m];h=p.domainId;a=p.langId}var n=TemplatesDataSet.getInstance();var r=n.getLangsList();var b=n.getDomainsList();var s=function(d,j){return function(){var v,w=[];for(v in g){w.push(v)}e.dataSet.addEventHandler("onBeforeExecute",createConfirm(e.dataSet));e.dataSet.execute("copyElementToSite",{element:w,handle_item:$.extend(true,{},Control.HandleItem),selected_items:g,"lang-id":j,"domain-id":d,templates:1,childs:1,permissions:1,virtuals:1,links:1});return false}};var t={};for(m=0;m<b.length;m++){var q=b[m];var c=(h==q.id);var f={};for(l=0;l<r.length;l++){var u=r[l];var o=c&&(a==u.id);f[u.id]={icon:o?"checked":"undefined",caption:u.nodeValue,execute:s(q.id,u.id)}}t[q.id]={icon:c?"checked":"undefined",caption:q.host,execute:function(){return false},submenu:f}}return{caption:getLabel("js-"+k[0]),icon:"i-copy-other",visible:true,execute:function(){return false},submenu:t}};ContextMenu.itemHandlers.typeRemove=function(){};ContextMenu.itemHandlers.typeEdit=function(){};ContextMenu.allowControlEnable=true;
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
(function(a9,H){var bg=a9,bi=bg.document,P=bg.navigator,B=bg.setTimeout,q=bg.clearTimeout,Y=bg.setInterval,e=bg.clearInterval,aP=bg.getComputedStyle,a1=bg.encodeURIComponent,aw=bg.ActiveXObject,ay=bg.Error,ap=bg.Number.parseInt||bg.parseInt,V=bg.Number.parseFloat||bg.parseFloat,aa=bg.Number.isNaN||bg.isNaN,W=bg.Date.now,ao=bg.Object.keys,aO=bg.Object.defineProperty,aH=bg.Object.prototype.hasOwnProperty,k=bg.Array.prototype.slice,aX=function(){var bm=function(bn){return bn};if(typeof bg.wrap==="function"&&typeof bg.unwrap==="function"){try{var bl=bi.createElement("div");var bj=bg.unwrap(bl);if(bl.nodeType===1&&bj&&bj.nodeType===1){bm=bg.unwrap}}catch(bk){}}return bm}();var aR=function(bj){return k.call(bj,0)};var aN=function(){var bm,bk,bj,bq,bo,bp,bl=aR(arguments),bn=bl[0]||{};for(bm=1,bk=bl.length;bm<bk;bm++){if((bj=bl[bm])!=null){for(bq in bj){if(aH.call(bj,bq)){bo=bn[bq];bp=bj[bq];if(bn!==bp&&bp!==H){bn[bq]=bp}}}}}return bn};var L=function(bl){var bn,bk,bj,bm;if(typeof bl!=="object"||bl==null||typeof bl.nodeType==="number"){bn=bl}else{if(typeof bl.length==="number"){bn=[];for(bk=0,bj=bl.length;bk<bj;bk++){if(aH.call(bl,bk)){bn[bk]=L(bl[bk])}}}else{bn={};for(bm in bl){if(aH.call(bl,bm)){bn[bm]=L(bl[bm])}}}}return bn};var t=function(bn,bm){var bk={};for(var bl=0,bj=bm.length;bl<bj;bl++){if(bm[bl] in bn){bk[bm[bl]]=bn[bm[bl]]}}return bk};var be=function(bl,bk){var bj={};for(var bm in bl){if(bk.indexOf(bm)===-1){bj[bm]=bl[bm]}}return bj};var aq=function(bj){if(bj){for(var bk in bj){if(aH.call(bj,bk)){delete bj[bk]}}}return bj};var aQ=function(bj,bk){if(bj&&bj.nodeType===1&&bj.ownerDocument&&bk&&(bk.nodeType===1&&bk.ownerDocument&&bk.ownerDocument===bj.ownerDocument||bk.nodeType===9&&!bk.ownerDocument&&bk===bj.ownerDocument)){do{if(bj===bk){return true}bj=bj.parentNode}while(bj)}return false};var N=function(bk){var bj;if(typeof bk==="string"&&bk){bj=bk.split("#")[0].split("?")[0];bj=bk.slice(0,bk.lastIndexOf("/")+1)}return bj};var S=function(bj){var bk,bl;if(typeof bj==="string"&&bj){bl=bj.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);if(bl&&bl[1]){bk=bl[1]}else{bl=bj.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);if(bl&&bl[1]){bk=bl[1]}}}return bk};var az=function(){var bj,bk;try{throw new ay()}catch(bl){bk=bl}if(bk){bj=bk.sourceURL||bk.fileName||S(bk.stack)}return bj};var aM=function(){var bl,bj,bk;if(bi.currentScript&&(bl=bi.currentScript.src)){return bl}bj=bi.getElementsByTagName("script");if(bj.length===1){return bj[0].src||H}if("readyState" in bj[0]){for(bk=bj.length;bk--;){if(bj[bk].readyState==="interactive"&&(bl=bj[bk].src)){return bl}}}if(bi.readyState==="loading"&&(bl=bj[bj.length-1].src)){return bl}if(bl=az()){return bl}return H};var C=function(){var bl,bk,bm,bj=bi.getElementsByTagName("script");for(bl=bj.length;bl--;){if(!(bm=bj[bl].src)){bk=null;break}bm=N(bm);if(bk==null){bk=bm}else{if(bk!==bm){bk=null;break}}}return bk||H};var z=function(){var bj=N(aM())||C()||"";return bj+"ZeroClipboard.swf"};var ac=function(){return a9.opener==null&&(!!a9.top&&a9!=a9.top||!!a9.parent&&a9!=a9.parent)}();var o={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null};var ar="11.0.0";var a6;var av={};var aj;var s;var u={};var ax=null;var p=0;var X=0;var l={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}};var bd=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"];var aW=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"];var O=new RegExp("^flash-("+aW.map(function(bj){return bj.replace(/^flash-/,"")}).join("|")+")$");var ak=new RegExp("^flash-("+aW.slice(1).map(function(bj){return bj.replace(/^flash-/,"")}).join("|")+")$");var a3={swfPath:z(),trustedDomains:a9.location.host?[a9.location.host]:[],cacheBust:true,forceEnhancedClipboard:false,flashLoadTimeout:30000,autoActivate:true,bubbleEvents:true,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:false,title:null,zIndex:999999999};var aK=function(bj){if(typeof bj==="object"&&bj!==null){for(var bk in bj){if(aH.call(bj,bk)){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(bk)){a3[bk]=bj[bk]}else{if(o.bridge==null){if(bk==="containerId"||bk==="swfObjectId"){if(ba(bj[bk])){a3[bk]=bj[bk]}else{throw new Error("The specified `"+bk+"` value is not valid as an HTML4 Element ID")}}else{a3[bk]=bj[bk]}}}}}}if(typeof bj==="string"&&bj){if(aH.call(a3,bj)){return a3[bj]}return}return L(a3)};var aS=function(){bb();return{browser:t(P,["userAgent","platform","appName"]),flash:be(o,["bridge"]),zeroclipboard:{version:bh.version,config:bh.config()}}};var x=function(){return !!(o.disabled||o.outdated||o.sandboxed||o.unavailable||o.degraded||o.deactivated)};var ab=function(bm,bo){var bl,bj,bk,bn={};if(typeof bm==="string"&&bm){bk=bm.toLowerCase().split(/\s+/)}else{if(typeof bm==="object"&&bm&&typeof bo==="undefined"){for(bl in bm){if(aH.call(bm,bl)&&typeof bl==="string"&&bl&&typeof bm[bl]==="function"){bh.on(bl,bm[bl])}}}}if(bk&&bk.length){for(bl=0,bj=bk.length;bl<bj;bl++){bm=bk[bl].replace(/^on/,"");bn[bm]=true;if(!av[bm]){av[bm]=[]}av[bm].push(bo)}if(bn.ready&&o.ready){bh.emit({type:"ready"})}if(bn.error){for(bl=0,bj=aW.length;bl<bj;bl++){if(o[aW[bl].replace(/^flash-/,"")]===true){bh.emit({type:"error",name:aW[bl]});break}}if(a6!==H&&bh.version!==a6){bh.emit({type:"error",name:"version-mismatch",jsVersion:bh.version,swfVersion:a6})}}}return bh};var bc=function(bn,bo){var bm,bj,bp,bl,bk;if(arguments.length===0){bl=ao(av)}else{if(typeof bn==="string"&&bn){bl=bn.split(/\s+/)}else{if(typeof bn==="object"&&bn&&typeof bo==="undefined"){for(bm in bn){if(aH.call(bn,bm)&&typeof bm==="string"&&bm&&typeof bn[bm]==="function"){bh.off(bm,bn[bm])}}}}}if(bl&&bl.length){for(bm=0,bj=bl.length;bm<bj;bm++){bn=bl[bm].toLowerCase().replace(/^on/,"");bk=av[bn];if(bk&&bk.length){if(bo){bp=bk.indexOf(bo);while(bp!==-1){bk.splice(bp,1);bp=bk.indexOf(bo,bp)}}else{bk.length=0}}}}return bh};var c=function(bj){var bk;if(typeof bj==="string"&&bj){bk=L(av[bj])||null}else{bk=L(av)}return bk};var aI=function(bl){var bm,bk,bj;bl=G(bl);if(!bl){return}if(a5(bl)){return}if(bl.type==="ready"&&o.overdue===true){return bh.emit({type:"error",name:"flash-overdue"})}bm=aN({},bl);an.call(this,bm);if(bl.type==="copy"){bj=n(u);bk=bj.data;ax=bj.formatMap}return bk};var M=function(){var bj=o.sandboxed;bb();if(typeof o.ready!=="boolean"){o.ready=false}if(o.sandboxed!==bj&&o.sandboxed===true){o.ready=false;bh.emit({type:"error",name:"flash-sandboxed"})}else{if(!bh.isFlashUnusable()&&o.bridge===null){var bk=a3.flashLoadTimeout;if(typeof bk==="number"&&bk>=0){p=B(function(){if(typeof o.deactivated!=="boolean"){o.deactivated=true}if(o.deactivated===true){bh.emit({type:"error",name:"flash-deactivated"})}},bk)}o.overdue=false;aA()}}};var Z=function(){bh.clearData();bh.blur();bh.emit("destroy");f();bh.off()};var g=function(bl,bk){var bj;if(typeof bl==="object"&&bl&&typeof bk==="undefined"){bj=bl;bh.clearData()}else{if(typeof bl==="string"&&bl){bj={};bj[bl]=bk}else{return}}for(var bm in bj){if(typeof bm==="string"&&bm&&aH.call(bj,bm)&&typeof bj[bm]==="string"&&bj[bm]){u[bm]=bj[bm]}}};var r=function(bj){if(typeof bj==="undefined"){aq(u);ax=null}else{if(typeof bj==="string"&&aH.call(u,bj)){delete u[bj]}}};var D=function(bj){if(typeof bj==="undefined"){return L(u)}else{if(typeof bj==="string"&&aH.call(u,bj)){return u[bj]}}};var aT=function(bl){if(!(bl&&bl.nodeType===1)){return}if(aj){aB(aj,a3.activeClass);if(aj!==bl){aB(aj,a3.hoverClass)}}aj=bl;af(bl,a3.hoverClass);var bm=bl.getAttribute("title")||a3.title;if(typeof bm==="string"&&bm){var bk=bf(o.bridge);if(bk){bk.setAttribute("title",bm)}}var bj=a3.forceHandCursor===true||J(bl,"cursor")==="pointer";a7(bj);a8()};var aL=function(){var bj=bf(o.bridge);if(bj){bj.removeAttribute("title");bj.style.left="0px";bj.style.top="-9999px";bj.style.width="1px";bj.style.height="1px"}if(aj){aB(aj,a3.hoverClass);aB(aj,a3.activeClass);aj=null}};var ai=function(){return aj||null};var ba=function(bj){return typeof bj==="string"&&bj&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(bj)};var G=function(bk){var bj;if(typeof bk==="string"&&bk){bj=bk;bk={}}else{if(typeof bk==="object"&&bk&&typeof bk.type==="string"&&bk.type){bj=bk.type}}if(!bj){return}bj=bj.toLowerCase();if(!bk.target&&(/^(copy|aftercopy|_click)$/.test(bj)||bj==="error"&&bk.name==="clipboard-error")){bk.target=s}aN(bk,{type:bj,target:bk.target||aj||null,relatedTarget:bk.relatedTarget||null,currentTarget:o&&o.bridge||null,timeStamp:bk.timeStamp||W()||null});var bl=l[bk.type];if(bk.type==="error"&&bk.name&&bl){bl=bl[bk.name]}if(bl){bk.message=bl}if(bk.type==="ready"){aN(bk,{target:null,version:o.version})}if(bk.type==="error"){if(O.test(bk.name)){aN(bk,{target:null,minimumVersion:ar})}if(ak.test(bk.name)){aN(bk,{version:o.version})}}if(bk.type==="copy"){bk.clipboardData={setData:bh.setData,clearData:bh.clearData}}if(bk.type==="aftercopy"){bk=h(bk,ax)}if(bk.target&&!bk.relatedTarget){bk.relatedTarget=R(bk.target)}return w(bk)};var R=function(bk){var bj=bk&&bk.getAttribute&&bk.getAttribute("data-clipboard-target");return bj?bi.getElementById(bj):null};var w=function(bk){if(bk&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(bk.type)){var by=bk.target;var bx=bk.type==="_mouseover"&&bk.relatedTarget?bk.relatedTarget:H;var bs=bk.type==="_mouseout"&&bk.relatedTarget?bk.relatedTarget:H;var bz=U(by);var bv=bg.screenLeft||bg.screenX||0;var bp=bg.screenTop||bg.screenY||0;var bt=bi.body.scrollLeft+bi.documentElement.scrollLeft;var bm=bi.body.scrollTop+bi.documentElement.scrollTop;var bw=bz.left+(typeof bk._stageX==="number"?bk._stageX:0);var bu=bz.top+(typeof bk._stageY==="number"?bk._stageY:0);var bl=bw-bt;var bj=bu-bm;var br=bv+bl;var bo=bp+bj;var bq=typeof bk.movementX==="number"?bk.movementX:0;var bn=typeof bk.movementY==="number"?bk.movementY:0;delete bk._stageX;delete bk._stageY;aN(bk,{srcElement:by,fromElement:bx,toElement:bs,screenX:br,screenY:bo,pageX:bw,pageY:bu,clientX:bl,clientY:bj,x:bl,y:bj,movementX:bq,movementY:bn,offsetX:0,offsetY:0,layerX:0,layerY:0})}return bk};var ag=function(bk){var bj=bk&&typeof bk.type==="string"&&bk.type||"";return !/^(?:(?:before)?copy|destroy)$/.test(bj)};var at=function(bm,bk,bj,bl){if(bl){B(function(){bm.apply(bk,bj)},0)}else{bm.apply(bk,bj)}};var an=function(bj){if(!(typeof bj==="object"&&bj&&bj.type)){return}var bn=ag(bj);var bq=av["*"]||[];var bt=av[bj.type]||[];var bm=bq.concat(bt);if(bm&&bm.length){var bo,br,bl,bk,bp,bs=this;for(bo=0,br=bm.length;bo<br;bo++){bl=bm[bo];bk=bs;if(typeof bl==="string"&&typeof bg[bl]==="function"){bl=bg[bl]}if(typeof bl==="object"&&bl&&typeof bl.handleEvent==="function"){bk=bl;bl=bl.handleEvent}if(typeof bl==="function"){bp=aN({},bj);at(bl,bk,[bp],bn)}}}return this};var T=function(bj){var bk=null;if(ac===false||bj&&bj.type==="error"&&bj.name&&bd.indexOf(bj.name)!==-1){bk=false}return bk};var a5=function(bm){var bk=bm.target||aj||null;var bn=bm._source==="swf";delete bm._source;switch(bm.type){case"error":var bq=bm.name==="flash-sandboxed"||T(bm);if(typeof bq==="boolean"){o.sandboxed=bq}if(aW.indexOf(bm.name)!==-1){aN(o,{disabled:bm.name==="flash-disabled",outdated:bm.name==="flash-outdated",unavailable:bm.name==="flash-unavailable",degraded:bm.name==="flash-degraded",deactivated:bm.name==="flash-deactivated",overdue:bm.name==="flash-overdue",ready:false})}else{if(bm.name==="version-mismatch"){a6=bm.swfVersion;aN(o,{disabled:false,outdated:false,unavailable:false,degraded:false,deactivated:false,overdue:false,ready:false})}}aJ();break;case"ready":a6=bm.swfVersion;var bj=o.deactivated===true;aN(o,{disabled:false,outdated:false,sandboxed:false,unavailable:false,degraded:false,deactivated:false,overdue:bj,ready:!bj});aJ();break;case"beforecopy":s=bk;break;case"copy":var bl,bp,bo=bm.relatedTarget;if(!(u["text/html"]||u["text/plain"])&&bo&&(bp=bo.value||bo.outerHTML||bo.innerHTML)&&(bl=bo.value||bo.textContent||bo.innerText)){bm.clipboardData.clearData();bm.clipboardData.setData("text/plain",bl);if(bp!==bl){bm.clipboardData.setData("text/html",bp)}}else{if(!u["text/plain"]&&bm.target&&(bl=bm.target.getAttribute("data-clipboard-text"))){bm.clipboardData.clearData();bm.clipboardData.setData("text/plain",bl)}}break;case"aftercopy":aC(bm);bh.clearData();if(bk&&bk!==aG()&&bk.focus){bk.focus()}break;case"_mouseover":bh.focus(bk);if(a3.bubbleEvents===true&&bn){if(bk&&bk!==bm.relatedTarget&&!aQ(bm.relatedTarget,bk)){b(aN({},bm,{type:"mouseenter",bubbles:false,cancelable:false}))}b(aN({},bm,{type:"mouseover"}))}break;case"_mouseout":bh.blur();if(a3.bubbleEvents===true&&bn){if(bk&&bk!==bm.relatedTarget&&!aQ(bm.relatedTarget,bk)){b(aN({},bm,{type:"mouseleave",bubbles:false,cancelable:false}))}b(aN({},bm,{type:"mouseout"}))}break;case"_mousedown":af(bk,a3.activeClass);if(a3.bubbleEvents===true&&bn){b(aN({},bm,{type:bm.type.slice(1)}))}break;case"_mouseup":aB(bk,a3.activeClass);if(a3.bubbleEvents===true&&bn){b(aN({},bm,{type:bm.type.slice(1)}))}break;case"_click":s=null;if(a3.bubbleEvents===true&&bn){b(aN({},bm,{type:bm.type.slice(1)}))}break;case"_mousemove":if(a3.bubbleEvents===true&&bn){b(aN({},bm,{type:bm.type.slice(1)}))}break}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(bm.type)){return true}};var aC=function(bj){if(bj.errors&&bj.errors.length>0){var bk=L(bj);aN(bk,{type:"error",name:"clipboard-error"});delete bk.success;B(function(){bh.emit(bk)},0)}};var b=function(bk){if(!(bk&&typeof bk.type==="string"&&bk)){return}var bo,bn=bk.target||null,bm=bn&&bn.ownerDocument||bi,bl={view:bm.defaultView||bg,canBubble:true,cancelable:true,detail:bk.type==="click"?1:0,button:typeof bk.which==="number"?bk.which-1:typeof bk.button==="number"?bk.button:bm.createEvent?0:1},bj=aN(bl,bk);if(!bn){return}if(bm.createEvent&&bn.dispatchEvent){bj=[bj.type,bj.canBubble,bj.cancelable,bj.view,bj.detail,bj.screenX,bj.screenY,bj.clientX,bj.clientY,bj.ctrlKey,bj.altKey,bj.shiftKey,bj.metaKey,bj.button,bj.relatedTarget];bo=bm.createEvent("MouseEvents");if(bo.initMouseEvent){bo.initMouseEvent.apply(bo,bj);bo._source="js";bn.dispatchEvent(bo)}}};var a2=function(){var bk=a3.flashLoadTimeout;if(typeof bk==="number"&&bk>=0){var bl=Math.min(1000,bk/10);var bj=a3.swfObjectId+"_fallbackContent";X=Y(function(){var bm=bi.getElementById(bj);if(A(bm)){aJ();o.deactivated=null;bh.emit({type:"error",name:"swf-not-found"})}},bl)}};var a=function(){var bj=bi.createElement("div");bj.id=a3.containerId;bj.className=a3.containerClass;bj.style.position="absolute";bj.style.left="0px";bj.style.top="-9999px";bj.style.width="1px";bj.style.height="1px";bj.style.zIndex=""+aE(a3.zIndex);return bj};var bf=function(bk){var bj=bk&&bk.parentNode;while(bj&&bj.nodeName==="OBJECT"&&bj.parentNode){bj=bj.parentNode}return bj||null};var aA=function(){var bp,br=o.bridge,bj=bf(br);if(!br){var bm=aV(bg.location.host,a3);var bk=bm==="never"?"none":"all";var bl=d(aN({jsVersion:bh.version},a3));var bn=a3.swfPath+y(a3.swfPath,a3);bj=a();var bq=bi.createElement("div");bj.appendChild(bq);bi.body.appendChild(bj);var bs=bi.createElement("div");var bo=o.pluginType==="activex";bs.innerHTML='<object id="'+a3.swfObjectId+'" name="'+a3.swfObjectId+'" width="100%" height="100%" '+(bo?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+bn+'"')+">"+(bo?'<param name="movie" value="'+bn+'"/>':"")+'<param name="allowScriptAccess" value="'+bm+'"/><param name="allowNetworking" value="'+bk+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+bl+'"/><div id="'+a3.swfObjectId+'_fallbackContent">&nbsp;</div></object>';br=bs.firstChild;bs=null;aX(br).ZeroClipboard=bh;bj.replaceChild(br,bq);a2()}if(!br){br=bi[a3.swfObjectId];if(br&&(bp=br.length)){br=br[bp-1]}if(!br&&bj){br=bj.firstChild}}o.bridge=br||null;return br};var f=function(){var bk=o.bridge;if(bk){var bj=bf(bk);if(bj){if(o.pluginType==="activex"&&"readyState" in bk){bk.style.display="none";(function bl(){if(bk.readyState===4){for(var bm in bk){if(typeof bk[bm]==="function"){bk[bm]=null}}if(bk.parentNode){bk.parentNode.removeChild(bk)}if(bj.parentNode){bj.parentNode.removeChild(bj)}}else{B(bl,10)}})()}else{if(bk.parentNode){bk.parentNode.removeChild(bk)}if(bj.parentNode){bj.parentNode.removeChild(bj)}}}aJ();o.ready=null;o.bridge=null;o.deactivated=null;a6=H}};var n=function(bl){var bk={},bj={};if(!(typeof bl==="object"&&bl)){return}for(var bm in bl){if(bm&&aH.call(bl,bm)&&typeof bl[bm]==="string"&&bl[bm]){switch(bm.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":bk.text=bl[bm];bj.text=bm;break;case"text/html":case"html":case"air:html":case"flash:html":bk.html=bl[bm];bj.html=bm;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":bk.rtf=bl[bm];bj.rtf=bm;break;default:break}}}return{data:bk,formatMap:bj}};var h=function(bn,bk){if(!(typeof bn==="object"&&bn&&typeof bk==="object"&&bk)){return bn}var bq={};for(var bp in bn){if(aH.call(bn,bp)){if(bp==="errors"){bq[bp]=bn[bp]?bn[bp].slice():[];for(var bl=0,bj=bq[bp].length;bl<bj;bl++){bq[bp][bl].format=bk[bq[bp][bl].format]}}else{if(bp!=="success"&&bp!=="data"){bq[bp]=bn[bp]}else{bq[bp]={};var bm=bn[bp];for(var bo in bm){if(bo&&aH.call(bm,bo)&&aH.call(bk,bo)){bq[bp][bk[bo]]=bm[bo]}}}}}}return bq};var y=function(bl,bj){var bk=bj==null||bj&&bj.cacheBust===true;if(bk){return(bl.indexOf("?")===-1?"?":"&")+"noCache="+W()}else{return""}};var d=function(bl){var bm,bk,bn,bj,bo="",bp=[];if(bl.trustedDomains){if(typeof bl.trustedDomains==="string"){bj=[bl.trustedDomains]}else{if(typeof bl.trustedDomains==="object"&&"length" in bl.trustedDomains){bj=bl.trustedDomains}}}if(bj&&bj.length){for(bm=0,bk=bj.length;bm<bk;bm++){if(aH.call(bj,bm)&&bj[bm]&&typeof bj[bm]==="string"){bn=au(bj[bm]);if(!bn){continue}if(bn==="*"){bp.length=0;bp.push(bn);break}bp.push.apply(bp,[bn,"//"+bn,bg.location.protocol+"//"+bn])}}}if(bp.length){bo+="trustedOrigins="+a1(bp.join(","))}if(bl.forceEnhancedClipboard===true){bo+=(bo?"&":"")+"forceEnhancedClipboard=true"}if(typeof bl.swfObjectId==="string"&&bl.swfObjectId){bo+=(bo?"&":"")+"swfObjectId="+a1(bl.swfObjectId)}if(typeof bl.jsVersion==="string"&&bl.jsVersion){bo+=(bo?"&":"")+"jsVersion="+a1(bl.jsVersion)}return bo};var au=function(bk){if(bk==null||bk===""){return null}bk=bk.replace(/^\s+|\s+$/g,"");if(bk===""){return null}var bl=bk.indexOf("//");bk=bl===-1?bk:bk.slice(bl+2);var bj=bk.indexOf("/");bk=bj===-1?bk:bl===-1||bj===0?null:bk.slice(0,bj);if(bk&&bk.slice(-4).toLowerCase()===".swf"){return null}return bk||null};var aV=function(){var bj=function(bo){var bm,bk,bl,bn=[];if(typeof bo==="string"){bo=[bo]}if(!(typeof bo==="object"&&bo&&typeof bo.length==="number")){return bn}for(bm=0,bk=bo.length;bm<bk;bm++){if(aH.call(bo,bm)&&(bl=au(bo[bm]))){if(bl==="*"){bn.length=0;bn.push("*");break}if(bn.indexOf(bl)===-1){bn.push(bl)}}}return bn};return function(bo,bl){var bn=au(bl.swfPath);if(bn===null){bn=bo}var bm=bj(bl.trustedDomains);var bk=bm.length;if(bk>0){if(bk===1&&bm[0]==="*"){return"always"}if(bm.indexOf(bo)!==-1){if(bk===1&&bo===bn){return"sameDomain"}return"always"}}return"never"}}();var aG=function(){try{return bi.activeElement}catch(bj){return null}};var af=function(bk,bm){var bo,bj,bl,bn=[];if(typeof bm==="string"&&bm){bn=bm.split(/\s+/)}if(bk&&bk.nodeType===1&&bn.length>0){if(bk.classList){for(bo=0,bj=bn.length;bo<bj;bo++){bk.classList.add(bn[bo])}}else{if(bk.hasOwnProperty("className")){bl=" "+bk.className+" ";for(bo=0,bj=bn.length;bo<bj;bo++){if(bl.indexOf(" "+bn[bo]+" ")===-1){bl+=bn[bo]+" "}}bk.className=bl.replace(/^\s+|\s+$/g,"")}}}return bk};var aB=function(bk,bm){var bo,bj,bl,bn=[];if(typeof bm==="string"&&bm){bn=bm.split(/\s+/)}if(bk&&bk.nodeType===1&&bn.length>0){if(bk.classList&&bk.classList.length>0){for(bo=0,bj=bn.length;bo<bj;bo++){bk.classList.remove(bn[bo])}}else{if(bk.className){bl=(" "+bk.className+" ").replace(/[\r\n\t]/g," ");for(bo=0,bj=bn.length;bo<bj;bo++){bl=bl.replace(" "+bn[bo]+" "," ")}bk.className=bl.replace(/^\s+|\s+$/g,"")}}}return bk};var J=function(bj,bl){var bk=aP(bj,null).getPropertyValue(bl);if(bl==="cursor"){if(!bk||bk==="auto"){if(bj.nodeName==="A"){return"pointer"}}}return bk};var U=function(bj){var bq={left:0,top:0,width:0,height:0};if(bj.getBoundingClientRect){var bp=bj.getBoundingClientRect();var bl=bg.pageXOffset;var bs=bg.pageYOffset;var bo=bi.documentElement.clientLeft||0;var bm=bi.documentElement.clientTop||0;var bt=0;var bn=0;if(J(bi.body,"position")==="relative"){var br=bi.body.getBoundingClientRect();var bk=bi.documentElement.getBoundingClientRect();bt=br.left-bk.left||0;bn=br.top-bk.top||0}bq.left=bp.left+bl-bo-bt;bq.top=bp.top+bs-bm-bn;bq.width="width" in bp?bp.width:bp.right-bp.left;bq.height="height" in bp?bp.height:bp.bottom-bp.top}return bq};var A=function(bj){if(!bj){return false}var br=aP(bj,null);var bp=V(br.height)>0;var bq=V(br.width)>0;var bk=V(br.top)>=0;var bl=V(br.left)>=0;var bm=bp&&bq&&bk&&bl;var bo=bm?null:U(bj);var bn=br.display!=="none"&&br.visibility!=="collapse"&&(bm||!!bo&&(bp||bo.height>0)&&(bq||bo.width>0)&&(bk||bo.top>=0)&&(bl||bo.left>=0));return bn};var aJ=function(){q(p);p=0;e(X);X=0};var a8=function(){var bj;if(aj&&(bj=bf(o.bridge))){var bk=U(aj);aN(bj.style,{width:bk.width+"px",height:bk.height+"px",top:bk.top+"px",left:bk.left+"px",zIndex:""+aE(a3.zIndex)})}};var a7=function(bj){if(o.ready===true){if(o.bridge&&typeof o.bridge.setHandCursor==="function"){o.bridge.setHandCursor(bj)}else{o.ready=false}}};var aE=function(bj){if(/^(?:auto|inherit)$/.test(bj)){return bj}var bk;if(typeof bj==="number"&&!aa(bj)){bk=bj}else{if(typeof bj==="string"){bk=aE(ap(bj,10))}}return typeof bk==="number"?bk:"auto"};var bb=function(bp){var bk,bm,bo,bj=o.sandboxed,bn=null;bp=bp===true;if(ac===false){bn=false}else{try{bm=a9.frameElement||null}catch(bl){bo={name:bl.name,message:bl.message}}if(bm&&bm.nodeType===1&&bm.nodeName==="IFRAME"){try{bn=bm.hasAttribute("sandbox")}catch(bl){bn=null}}else{try{bk=document.domain||null}catch(bl){bk=null}if(bk===null||bo&&bo.name==="SecurityError"&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(bo.message.toLowerCase())){bn=true}}}o.sandboxed=bn;if(bj!==bn&&!bp){am(aw)}return bn};var am=function(bn){var br,bj,bk,bt=false,bv=false,bq=false,bl="";function bp(by){var bx=by.match(/[\d]+/g);bx.length=3;return bx.join(".")}function bm(bx){return !!bx&&(bx=bx.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(bx)||bx.slice(-13)==="chrome.plugin")}function bo(bx){if(bx){bt=true;if(bx.version){bl=bp(bx.version)}if(!bl&&bx.description){bl=bp(bx.description)}if(bx.filename){bq=bm(bx.filename)}}}if(P.plugins&&P.plugins.length){br=P.plugins["Shockwave Flash"];bo(br);if(P.plugins["Shockwave Flash 2.0"]){bt=true;bl="2.0.0.11"}}else{if(P.mimeTypes&&P.mimeTypes.length){bk=P.mimeTypes["application/x-shockwave-flash"];br=bk&&bk.enabledPlugin;bo(br)}else{if(typeof bn!=="undefined"){bv=true;try{bj=new bn("ShockwaveFlash.ShockwaveFlash.7");bt=true;bl=bp(bj.GetVariable("$version"))}catch(bw){try{bj=new bn("ShockwaveFlash.ShockwaveFlash.6");bt=true;bl="6.0.21"}catch(bu){try{bj=new bn("ShockwaveFlash.ShockwaveFlash");bt=true;bl=bp(bj.GetVariable("$version"))}catch(bs){bv=false}}}}}}o.disabled=bt!==true;o.outdated=bl&&V(bl)<V(ar);o.version=bl||"0.0.0";o.pluginType=bq?"pepper":bv?"activex":bt?"netscape":"unknown"};am(aw);bb(true);var bh=function(){if(!(this instanceof bh)){return new bh()}if(typeof bh._createClient==="function"){bh._createClient.apply(this,aR(arguments))}};aO(bh,"version",{value:"2.2.0",writable:false,configurable:true,enumerable:true});bh.config=function(){return aK.apply(this,aR(arguments))};bh.state=function(){return aS.apply(this,aR(arguments))};bh.isFlashUnusable=function(){return x.apply(this,aR(arguments))};bh.on=function(){return ab.apply(this,aR(arguments))};bh.off=function(){return bc.apply(this,aR(arguments))};bh.handlers=function(){return c.apply(this,aR(arguments))};bh.emit=function(){return aI.apply(this,aR(arguments))};bh.create=function(){return M.apply(this,aR(arguments))};bh.destroy=function(){return Z.apply(this,aR(arguments))};bh.setData=function(){return g.apply(this,aR(arguments))};bh.clearData=function(){return r.apply(this,aR(arguments))};bh.getData=function(){return D.apply(this,aR(arguments))};bh.focus=bh.activate=function(){return aT.apply(this,aR(arguments))};bh.blur=bh.deactivate=function(){return aL.apply(this,aR(arguments))};bh.activeElement=function(){return ai.apply(this,aR(arguments))};var ah=0;var F={};var j=0;var aF={};var K={};aN(a3,{autoActivate:true});var aZ=function(bk){var bj=this;bj.id=""+ah++;F[bj.id]={instance:bj,elements:[],handlers:{}};if(bk){bj.clip(bk)}bh.on("*",function(bl){return bj.emit(bl)});bh.on("destroy",function(){bj.destroy()});bh.create()};var aD=function(bn,bp){var bm,bj,bl,bo={},bq=F[this.id],bk=bq&&bq.handlers;if(!bq){throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance")}if(typeof bn==="string"&&bn){bl=bn.toLowerCase().split(/\s+/)}else{if(typeof bn==="object"&&bn&&typeof bp==="undefined"){for(bm in bn){if(aH.call(bn,bm)&&typeof bm==="string"&&bm&&typeof bn[bm]==="function"){this.on(bm,bn[bm])}}}}if(bl&&bl.length){for(bm=0,bj=bl.length;bm<bj;bm++){bn=bl[bm].replace(/^on/,"");bo[bn]=true;if(!bk[bn]){bk[bn]=[]}bk[bn].push(bp)}if(bo.ready&&o.ready){this.emit({type:"ready",client:this})}if(bo.error){for(bm=0,bj=aW.length;bm<bj;bm++){if(o[aW[bm].replace(/^flash-/,"")]){this.emit({type:"error",name:aW[bm],client:this});break}}if(a6!==H&&bh.version!==a6){this.emit({type:"error",name:"version-mismatch",jsVersion:bh.version,swfVersion:a6})}}}return this};var aU=function(bj,bk){var bm,bn,bp,br,bo,bq=F[this.id],bl=bq&&bq.handlers;if(!bl){return this}if(arguments.length===0){br=ao(bl)}else{if(typeof bj==="string"&&bj){br=bj.split(/\s+/)}else{if(typeof bj==="object"&&bj&&typeof bk==="undefined"){for(bm in bj){if(aH.call(bj,bm)&&typeof bm==="string"&&bm&&typeof bj[bm]==="function"){this.off(bm,bj[bm])}}}}}if(br&&br.length){for(bm=0,bn=br.length;bm<bn;bm++){bj=br[bm].toLowerCase().replace(/^on/,"");bo=bl[bj];if(bo&&bo.length){if(bk){bp=bo.indexOf(bk);while(bp!==-1){bo.splice(bp,1);bp=bo.indexOf(bk,bp)}}else{bo.length=0}}}}return this};var aY=function(bk){var bl=null,bj=F[this.id]&&F[this.id].handlers;if(bj){if(typeof bk==="string"&&bk){bl=bj[bk]?bj[bk].slice(0):[]}else{bl=L(bj)}}return bl};var ae=function(bj){if(al.call(this,bj)){if(typeof bj==="object"&&bj&&typeof bj.type==="string"&&bj.type){bj=aN({},bj)}var bk=aN({},G(bj),{client:this});m.call(this,bk)}return this};var ad=function(bl){if(!F[this.id]){throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance")}bl=a0(bl);for(var bk=0;bk<bl.length;bk++){if(aH.call(bl,bk)&&bl[bk]&&bl[bk].nodeType===1){if(!bl[bk].zcClippingId){bl[bk].zcClippingId="zcClippingId_"+j++;aF[bl[bk].zcClippingId]=[this.id];if(a3.autoActivate===true){I(bl[bk])}}else{if(aF[bl[bk].zcClippingId].indexOf(this.id)===-1){aF[bl[bk].zcClippingId].push(this.id)}}var bj=F[this.id]&&F[this.id].elements;if(bj.indexOf(bl[bk])===-1){bj.push(bl[bk])}}}return this};var E=function(bn){var bo=F[this.id];if(!bo){return this}var bk=bo.elements;var bj;if(typeof bn==="undefined"){bn=bk.slice(0)}else{bn=a0(bn)}for(var bl=bn.length;bl--;){if(aH.call(bn,bl)&&bn[bl]&&bn[bl].nodeType===1){bj=0;while((bj=bk.indexOf(bn[bl],bj))!==-1){bk.splice(bj,1)}var bm=aF[bn[bl].zcClippingId];if(bm){bj=0;while((bj=bm.indexOf(this.id,bj))!==-1){bm.splice(bj,1)}if(bm.length===0){if(a3.autoActivate===true){a4(bn[bl])}delete bn[bl].zcClippingId}}}}return this};var v=function(){var bj=F[this.id];return bj&&bj.elements?bj.elements.slice(0):[]};var Q=function(){if(!F[this.id]){return}this.unclip();this.off();delete F[this.id]};var al=function(bn){if(!(bn&&bn.type)){return false}if(bn.client&&bn.client!==this){return false}var bp=F[this.id];var bo=bp&&bp.elements;var bj=!!bo&&bo.length>0;var bk=!bn.target||bj&&bo.indexOf(bn.target)!==-1;var bl=bn.relatedTarget&&bj&&bo.indexOf(bn.relatedTarget)!==-1;var bm=bn.client&&bn.client===this;if(!bp||!(bk||bl||bm)){return false}return true};var m=function(bj){var bu=F[this.id];if(!(typeof bj==="object"&&bj&&bj.type&&bu)){return}var bn=ag(bj);var bq=bu&&bu.handlers["*"]||[];var bt=bu&&bu.handlers[bj.type]||[];var bm=bq.concat(bt);if(bm&&bm.length){var bo,br,bl,bk,bp,bs=this;for(bo=0,br=bm.length;bo<br;bo++){bl=bm[bo];bk=bs;if(typeof bl==="string"&&typeof bg[bl]==="function"){bl=bg[bl]}if(typeof bl==="object"&&bl&&typeof bl.handleEvent==="function"){bk=bl;bl=bl.handleEvent}if(typeof bl==="function"){bp=aN({},bj);at(bl,bk,[bp],bn)}}}};var a0=function(bj){if(typeof bj==="string"){bj=[]}return typeof bj.length!=="number"?[bj]:bj};var I=function(bk){if(!(bk&&bk.nodeType===1)){return}var bj=function(bm){if(!(bm||(bm=bg.event))){return}if(bm._source!=="js"){bm.stopImmediatePropagation();bm.preventDefault()}delete bm._source};var bl=function(bm){if(!(bm||(bm=bg.event))){return}bj(bm);bh.focus(bk)};bk.addEventListener("mouseover",bl,false);bk.addEventListener("mouseout",bj,false);bk.addEventListener("mouseenter",bj,false);bk.addEventListener("mouseleave",bj,false);bk.addEventListener("mousemove",bj,false);K[bk.zcClippingId]={mouseover:bl,mouseout:bj,mouseenter:bj,mouseleave:bj,mousemove:bj}};var a4=function(bo){if(!(bo&&bo.nodeType===1)){return}var bk=K[bo.zcClippingId];if(!(typeof bk==="object"&&bk)){return}var bn,bp,bl=["move","leave","enter","out","over"];for(var bm=0,bj=bl.length;bm<bj;bm++){bn="mouse"+bl[bm];bp=bk[bn];if(typeof bp==="function"){bo.removeEventListener(bn,bp,false)}}delete K[bo.zcClippingId]};bh._createClient=function(){aZ.apply(this,aR(arguments))};bh.prototype.on=function(){return aD.apply(this,aR(arguments))};bh.prototype.off=function(){return aU.apply(this,aR(arguments))};bh.prototype.handlers=function(){return aY.apply(this,aR(arguments))};bh.prototype.emit=function(){return ae.apply(this,aR(arguments))};bh.prototype.clip=function(){return ad.apply(this,aR(arguments))};bh.prototype.unclip=function(){return E.apply(this,aR(arguments))};bh.prototype.elements=function(){return v.apply(this,aR(arguments))};bh.prototype.destroy=function(){return Q.apply(this,aR(arguments))};bh.prototype.setText=function(bj){if(!F[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}bh.setData("text/plain",bj);return this};bh.prototype.setHtml=function(bj){if(!F[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}bh.setData("text/html",bj);return this};bh.prototype.setRichText=function(bj){if(!F[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}bh.setData("application/rtf",bj);return this};bh.prototype.setData=function(){if(!F[this.id]){throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance")}bh.setData.apply(this,aR(arguments));return this};bh.prototype.clearData=function(){if(!F[this.id]){throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance")}bh.clearData.apply(this,aR(arguments));return this};bh.prototype.getData=function(){if(!F[this.id]){throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance")}return bh.getData.apply(this,aR(arguments))};if(typeof define==="function"&&define.amd){define(function(){return bh})}else{if(typeof module==="object"&&module&&typeof module.exports==="object"&&module.exports){module.exports=bh}else{a9.ZeroClipboard=bh}}})(function(){return this||window}());var TTCustomizer={buttons:{},menu:[],extendDefault:false,extend:function(a){if(_.keys(a).length>0){_.extend(this.buttons,a);return true}else{return false}}};